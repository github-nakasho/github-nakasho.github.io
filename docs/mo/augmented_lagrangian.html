<!DOCTYPE html> <html lang="en-US"> <head> <meta charset="UTF-8"> <meta http-equiv="X-UA-Compatible" content="IE=Edge"> <title>拡張ラグランジュ関数法 - 宇宙物理メモ</title> <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon"> <link rel="stylesheet" href="/assets/css/just-the-docs-default.css"> <script async src="https://www.googletagmanager.com/gtag/js?id=G-C550SVR5KQ"></script> <script> window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-C550SVR5KQ', { 'anonymize_ip': true }); </script> <script type="text/javascript" src="/assets/js/vendor/lunr.min.js"></script> <script type="text/javascript" src="/assets/js/just-the-docs.js"></script> <meta name="viewport" content="width=device-width, initial-scale=1"> <!-- Begin Jekyll SEO tag v2.7.1 --> <title>拡張ラグランジュ関数法 | 宇宙物理メモ</title> <meta name="generator" content="Jekyll v4.2.1" /> <meta property="og:title" content="拡張ラグランジュ関数法" /> <meta property="og:locale" content="en_US" /> <meta name="description" content="An astrophysics and physics memo." /> <meta property="og:description" content="An astrophysics and physics memo." /> <link rel="canonical" href="http://localhost:4000/mo/augmented_lagrangian" /> <meta property="og:url" content="http://localhost:4000/mo/augmented_lagrangian" /> <meta property="og:site_name" content="宇宙物理メモ" /> <meta name="twitter:card" content="summary" /> <meta property="twitter:title" content="拡張ラグランジュ関数法" /> <script type="application/ld+json"> {"publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"http://localhost:4000/assets/images/logo.png"}},"url":"http://localhost:4000/mo/augmented_lagrangian","@type":"WebPage","headline":"拡張ラグランジュ関数法","description":"An astrophysics and physics memo.","@context":"https://schema.org"}</script> <!-- End Jekyll SEO tag --> <script> MathJax = { tex: { tags: 'ams', packages: {'[+]': ['textmacros']}, }, loader: { load: ['[tex]/textmacros'] } }; </script> <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script type="text/javascript" id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"> </script> </head> <body> <svg xmlns="http://www.w3.org/2000/svg" style="display: none;"> <symbol id="svg-link" viewBox="0 0 24 24"> <title>Link</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link"> <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path> </svg> </symbol> <symbol id="svg-search" viewBox="0 0 24 24"> <title>Search</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search"> <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line> </svg> </symbol> <symbol id="svg-menu" viewBox="0 0 24 24"> <title>Menu</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"> <line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line> </svg> </symbol> <symbol id="svg-arrow-right" viewBox="0 0 24 24"> <title>Expand</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"> <polyline points="9 18 15 12 9 6"></polyline> </svg> </symbol> <symbol id="svg-doc" viewBox="0 0 24 24"> <title>Document</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file"> <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline> </svg> </symbol> </svg> <div class="side-bar"> <div class="site-header"> <a href="http://localhost:4000/" class="site-title lh-tight"> <div class="site-logo"></div> </a> <a href="#" id="menu-button" class="site-button"> <svg viewBox="0 0 24 24" class="icon"><use xlink:href="#svg-menu"></use></svg> </a> </div> <nav role="navigation" aria-label="Main" id="site-nav" class="site-nav"> <ul class="nav-list"><li class="nav-list-item"><a href="http://localhost:4000/" class="nav-list-link">ホーム</a></li><li class="nav-list-item"><a href="http://localhost:4000/astromap" class="nav-list-link">宇宙物理学Map</a></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="http://localhost:4000/astroph" class="nav-list-link">astroph</a><ul class="nav-list "><li class="nav-list-item "><a href="http://localhost:4000/astroph/2020" class="nav-list-link">2020年振り返り</a></li><li class="nav-list-item "><a href="http://localhost:4000/astroph/2021" class="nav-list-link">2021年振り返り</a></li><li class="nav-list-item "><a href="http://localhost:4000/astroph/gn_z11_flash" class="nav-list-link">GN-z11-flashまとめ</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="http://localhost:4000/quantph" class="nav-list-link">quantph</a><ul class="nav-list "><li class="nav-list-item "><a href="http://localhost:4000/quantph/2021" class="nav-list-link">2021年振り返り</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="http://localhost:4000/mhd" class="nav-list-link">宇宙磁気流体力学</a><ul class="nav-list "><li class="nav-list-item "><a href="http://localhost:4000/mhd/euler_lagrange" class="nav-list-link">ラグランジュ微分とオイラー微分</a></li><li class="nav-list-item "><a href="http://localhost:4000/mhd/continuity" class="nav-list-link">連続の式</a></li><li class="nav-list-item "><a href="http://localhost:4000/mhd/momentum" class="nav-list-link">運動量保存則</a></li><li class="nav-list-item "><a href="http://localhost:4000/mhd/ohm" class="nav-list-link">一般化されたオームの法則</a></li><li class="nav-list-item "><a href="http://localhost:4000/mhd/induction" class="nav-list-link">誘導方程式</a></li><li class="nav-list-item "><a href="http://localhost:4000/mhd/energy" class="nav-list-link">エネルギー保存則</a></li><li class="nav-list-item "><a href="http://localhost:4000/mhd/mri" class="nav-list-link">磁気回転不安定性</a></li><li class="nav-list-item "><a href="http://localhost:4000/mhd/rayleigh_criterion" class="nav-list-link">レイリーの基準</a></li><li class="nav-list-item "><a href="http://localhost:4000/mhd/parker" class="nav-list-link">パーカー不安定性</a></li><li class="nav-list-item "><a href="http://localhost:4000/mhd/sw" class="nav-list-link">スウィート・パーカーの磁気リコネクション</a></li><li class="nav-list-item "><a href="http://localhost:4000/mhd/petschek" class="nav-list-link">ぺチェックの磁気リコネクション</a></li><li class="nav-list-item "><a href="http://localhost:4000/mhd/gravity" class="nav-list-link">内部重力波</a></li><li class="nav-list-item "><a href="http://localhost:4000/mhd/alfven_wave" class="nav-list-link">アルヴェーン波</a></li><li class="nav-list-item "><a href="http://localhost:4000/mhd/acoustic_gravity" class="nav-list-link">音響重力波</a></li><li class="nav-list-item "><a href="http://localhost:4000/mhd/inertial" class="nav-list-link">慣性波</a></li><li class="nav-list-item "><a href="http://localhost:4000/mhd/magneto_acoustic" class="nav-list-link">磁気音波</a></li><li class="nav-list-item "><a href="http://localhost:4000/mhd/sound_wave" class="nav-list-link">音波</a></li><li class="nav-list-item "><a href="http://localhost:4000/mhd/shock" class="nav-list-link">衝撃波</a></li><li class="nav-list-item "><a href="http://localhost:4000/mhd/magneto_inertial" class="nav-list-link">磁気流体慣性波</a></li><li class="nav-list-item "><a href="http://localhost:4000/mhd/torsional_alfven" class="nav-list-link">ねじれアルヴェーン波</a></li><li class="nav-list-item "><a href="http://localhost:4000/mhd/sedov" class="nav-list-link">セドフ・テイラー解</a></li><li class="nav-list-item "><a href="http://localhost:4000/mhd/jeans" class="nav-list-link">ジーンズ不安定性</a></li><li class="nav-list-item "><a href="http://localhost:4000/mhd/rotate_jeans" class="nav-list-link">回転する平板での自己重力不安定性</a></li><li class="nav-list-item "><a href="http://localhost:4000/mhd/momentum_cyl" class="nav-list-link">円筒座標系での運動量保存</a></li><li class="nav-list-item "><a href="http://localhost:4000/mhd/momentum_sph" class="nav-list-link">3次元極座標系での運動量保存</a></li><li class="nav-list-item "><a href="http://localhost:4000/mhd/induction_cyl_sph" class="nav-list-link">円筒座標系・3次元極座標での誘導方程式</a></li><li class="nav-list-item "><a href="http://localhost:4000/mhd/mhd_shock_perp" class="nav-list-link">磁気流体での垂直衝撃波</a></li><li class="nav-list-item "><a href="http://localhost:4000/mhd/mhd_shock_oblique" class="nav-list-link">磁気流体での斜め衝撃波</a></li><li class="nav-list-item "><a href="http://localhost:4000/mhd/interchange" class="nav-list-link">磁気流体における交換型不安定性</a></li><li class="nav-list-item "><a href="http://localhost:4000/mhd/rti_khi" class="nav-list-link">レイリー・テイラー、ケルビン・ヘルムホルツ不安定性</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="http://localhost:4000/astroelec" class="nav-list-link">宇宙電磁気学</a><ul class="nav-list "><li class="nav-list-item "><a href="http://localhost:4000/astroelec/coherent_time" class="nav-list-link">観測の不確定性と可干渉時間</a></li><li class="nav-list-item "><a href="http://localhost:4000/astroelec/dalembert" class="nav-list-link">ダランベール方程式の球面波解とその性質</a></li><li class="nav-list-item "><a href="http://localhost:4000/astroelec/em_energy_momentum" class="nav-list-link">電磁場のエネルギーと運動量</a></li><li class="nav-list-item "><a href="http://localhost:4000/astroelec/retarded_green" class="nav-list-link">遅延グリーン関数</a></li><li class="nav-list-item "><a href="http://localhost:4000/astroelec/potential_gauge" class="nav-list-link">電磁ポテンシャルとゲージ変換</a></li><li class="nav-list-item "><a href="http://localhost:4000/astroelec/lienard_wiechart" class="nav-list-link">リエナー・ブィーヒェルトポテンシャル</a></li><li class="nav-list-item "><a href="http://localhost:4000/astroelec/lienard_wiechart_em" class="nav-list-link">LWからの電磁場導出</a></li><li class="nav-list-item "><a href="http://localhost:4000/astroelec/vel_rad" class="nav-list-link">速度場と輻射場の性質</a></li><li class="nav-list-item "><a href="http://localhost:4000/astroelec/lienard_larmor" class="nav-list-link">リエナーの式とラーモアの式</a></li><li class="nav-list-item "><a href="http://localhost:4000/astroelec/rad_fourier" class="nav-list-link">輻射場のフーリエスペクトル</a></li><li class="nav-list-item "><a href="http://localhost:4000/astroelec/emtensor" class="nav-list-link">電磁場テンソル</a></li><li class="nav-list-item "><a href="http://localhost:4000/astroelec/uniform_mag" class="nav-list-link">一様磁場中での荷電粒子の運動</a></li><li class="nav-list-item "><a href="http://localhost:4000/astroelec/uniform_mag_rel" class="nav-list-link">一様磁場中で相対論的な運動をする電子</a></li><li class="nav-list-item "><a href="http://localhost:4000/astroelec/rel_beaming" class="nav-list-link">相対論的ビーミング効果</a></li><li class="nav-list-item "><a href="http://localhost:4000/astroelec/rel_beaming_spectrum" class="nav-list-link">相対論的ビーミング効果により観測される放射スペクトルの変化</a></li><li class="nav-list-item "><a href="http://localhost:4000/astroelec/sync_spectrum" class="nav-list-link">シンクロトロン放射</a></li><li class="nav-list-item "><a href="http://localhost:4000/astroelec/sync_energy_min" class="nav-list-link">Synchrotron energy minimum</a></li><li class="nav-list-item "><a href="http://localhost:4000/astroelec/polarization" class="nav-list-link">偏光</a></li><li class="nav-list-item "><a href="http://localhost:4000/astroelec/stokes" class="nav-list-link">ストークスパラメータ</a></li><li class="nav-list-item "><a href="http://localhost:4000/astroelec/sync_pol" class="nav-list-link">シンクロトロン放射偏光度の厳密な導出</a></li><li class="nav-list-item "><a href="http://localhost:4000/astroelec/thomson" class="nav-list-link">トムソン散乱</a></li><li class="nav-list-item "><a href="http://localhost:4000/astroelec/compton" class="nav-list-link">コンプトン散乱</a></li><li class="nav-list-item "><a href="http://localhost:4000/astroelec/inv_compton" class="nav-list-link">逆コンプトン散乱</a></li><li class="nav-list-item "><a href="http://localhost:4000/astroelec/inv_compton_intensity" class="nav-list-link">逆コンプトン放射強度</a></li><li class="nav-list-item "><a href="http://localhost:4000/astroelec/sz" class="nav-list-link">スニヤエフ・ゼルドヴィッチ効果</a></li><li class="nav-list-item "><a href="http://localhost:4000/astroelec/gcm" class="nav-list-link">RMによる銀河団磁場の推定</a></li><li class="nav-list-item "><a href="http://localhost:4000/astroelec/slmotion" class="nav-list-link">超光速運動</a></li><li class="nav-list-item "><a href="http://localhost:4000/astroelec/cherenkov" class="nav-list-link">チェレンコフ放射</a></li><li class="nav-list-item "><a href="http://localhost:4000/astroelec/transition" class="nav-list-link">遷移放射</a></li><li class="nav-list-item "><a href="http://localhost:4000/astroelec/ssa" class="nav-list-link">Synchrotron Self-Absorption</a></li><li class="nav-list-item "><a href="http://localhost:4000/astroelec/ssc" class="nav-list-link">Synchrotron Self-Comption</a></li><li class="nav-list-item "><a href="http://localhost:4000/astroelec/sc_catastroph" class="nav-list-link">Synchrotron-Compton Catastroph</a></li><li class="nav-list-item "><a href="http://localhost:4000/astroelec/isc_spectrum" class="nav-list-link">逆コンプトン散乱の放射強度スペクトル</a></li><li class="nav-list-item "><a href="http://localhost:4000/astroelec/e_mode_b_mode" class="nav-list-link">Eモード、Bモード</a></li><li class="nav-list-item "><a href="http://localhost:4000/astroelec/interferometer" class="nav-list-link">電波干渉計の基礎</a></li><li class="nav-list-item "><a href="http://localhost:4000/astroelec/rutherford" class="nav-list-link">ラザフォード散乱</a></li><li class="nav-list-item "><a href="http://localhost:4000/astroelec/cooling" class="nav-list-link">放射冷却率</a></li><li class="nav-list-item "><a href="http://localhost:4000/astroelec/spitzer_thermal" class="nav-list-link">スピッツァー熱伝導率</a></li><li class="nav-list-item "><a href="http://localhost:4000/astroelec/heaviside_feynman_jefimenko" class="nav-list-link">電磁場のヘヴィサイド・ファインマン表現とジェフィメンコ方程式</a></li><li class="nav-list-item "><a href="http://localhost:4000/astroelec/multipole_expansion" class="nav-list-link">多重極放射</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="http://localhost:4000/gr" class="nav-list-link">一般相対性理論</a><ul class="nav-list "><li class="nav-list-item "><a href="http://localhost:4000/gr/equivalence_general" class="nav-list-link">等価原理</a></li><li class="nav-list-item "><a href="http://localhost:4000/gr/riemann" class="nav-list-link">Riemann幾何学</a></li><li class="nav-list-item "><a href="http://localhost:4000/gr/metric" class="nav-list-link">メトリックテンソル</a></li><li class="nav-list-item "><a href="http://localhost:4000/gr/vector" class="nav-list-link">反変ベクトルと共変ベクトル</a></li><li class="nav-list-item "><a href="http://localhost:4000/gr/inverse" class="nav-list-link">メトリックの逆行列</a></li><li class="nav-list-item "><a href="http://localhost:4000/gr/volume" class="nav-list-link">固有体積要素</a></li><li class="nav-list-item "><a href="http://localhost:4000/gr/derivative" class="nav-list-link">共変微分</a></li><li class="nav-list-item "><a href="http://localhost:4000/gr/christoffel" class="nav-list-link">Christoffel記号</a></li><li class="nav-list-item "><a href="http://localhost:4000/gr/tensor" class="nav-list-link">テンソルの共変微分</a></li><li class="nav-list-item "><a href="http://localhost:4000/gr/riemann_tensor" class="nav-list-link">Riemannテンソル</a></li><li class="nav-list-item "><a href="http://localhost:4000/gr/bianchi" class="nav-list-link">Bianchiの恒等式</a></li><li class="nav-list-item "><a href="http://localhost:4000/gr/energy_momentum" class="nav-list-link">エネルギー・運動量テンソル</a></li><li class="nav-list-item "><a href="http://localhost:4000/gr/einstein_tensor" class="nav-list-link">Einsteinテンソル</a></li><li class="nav-list-item "><a href="http://localhost:4000/gr/einstein_eq" class="nav-list-link">Einstein方程式</a></li><li class="nav-list-item "><a href="http://localhost:4000/gr/geodesic" class="nav-list-link">測地線方程式</a></li><li class="nav-list-item "><a href="http://localhost:4000/gr/weakfield" class="nav-list-link">弱重力場極限</a></li><li class="nav-list-item "><a href="http://localhost:4000/gr/gw" class="nav-list-link">重力波</a></li><li class="nav-list-item "><a href="http://localhost:4000/gr/quadro" class="nav-list-link">重力波の振幅(四重極公式)</a></li><li class="nav-list-item "><a href="http://localhost:4000/gr/kagra" class="nav-list-link">KAGRA</a></li><li class="nav-list-item "><a href="http://localhost:4000/gr/massless" class="nav-list-link">質量のない粒子の測地線方程式</a></li><li class="nav-list-item "><a href="http://localhost:4000/gr/redshift" class="nav-list-link">重力赤方偏移</a></li><li class="nav-list-item "><a href="http://localhost:4000/gr/lensing" class="nav-list-link">重力レンズ</a></li><li class="nav-list-item "><a href="http://localhost:4000/gr/isco" class="nav-list-link">ISCO</a></li><li class="nav-list-item "><a href="http://localhost:4000/gr/bh_shadow" class="nav-list-link">BH shadow</a></li><li class="nav-list-item "><a href="http://localhost:4000/gr/tov" class="nav-list-link">TOV方程式</a></li><li class="nav-list-item "><a href="http://localhost:4000/gr/schwarzschild" class="nav-list-link">Schwarzschildの外部解</a></li><li class="nav-list-item "><a href="http://localhost:4000/gr/collapse" class="nav-list-link">重力崩壊</a></li><li class="nav-list-item "><a href="http://localhost:4000/gr/schwarzschild_interior" class="nav-list-link">Schwarzschildの内部解</a></li><li class="nav-list-item "><a href="http://localhost:4000/gr/conservation" class="nav-list-link">エネルギー運動量保存則</a></li><li class="nav-list-item "><a href="http://localhost:4000/gr/mw_smbh" class="nav-list-link">天の川銀河中心の超巨大質量コンパクトオブジェクトの発見</a></li><li class="nav-list-item "><a href="http://localhost:4000/gr/kerr" class="nav-list-link">カー・ブラックホール</a></li><li class="nav-list-item "><a href="http://localhost:4000/gr/feature_kerr" class="nav-list-link">カー・ブラックホールの特徴</a></li><li class="nav-list-item "><a href="http://localhost:4000/gr/linear_einstein" class="nav-list-link">線形近似されたEinstein方程式</a></li><li class="nav-list-item "><a href="http://localhost:4000/gr/spinning_weak_gravity" class="nav-list-link">ゆっくり自転する低質量星が作る時空</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="http://localhost:4000/cosmo" class="nav-list-link">宇宙論</a><ul class="nav-list "><li class="nav-list-item "><a href="http://localhost:4000/cosmo/rw" class="nav-list-link">Robertson-Walker計量</a></li><li class="nav-list-item "><a href="http://localhost:4000/cosmo/hubble" class="nav-list-link">Hubbleパラメータ</a></li><li class="nav-list-item "><a href="http://localhost:4000/cosmo/redshift" class="nav-list-link">赤方偏移</a></li><li class="nav-list-item "><a href="http://localhost:4000/cosmo/friedmann" class="nav-list-link">Friedmann方程式</a></li><li class="nav-list-item "><a href="http://localhost:4000/cosmo/density" class="nav-list-link">密度パラメータなど</a></li><li class="nav-list-item "><a href="http://localhost:4000/cosmo/const" class="nav-list-link">宇宙項</a></li><li class="nav-list-item "><a href="http://localhost:4000/cosmo/eos" class="nav-list-link">状態方程式</a></li><li class="nav-list-item "><a href="http://localhost:4000/cosmo/energy_cons" class="nav-list-link">エネルギー保存</a></li><li class="nav-list-item "><a href="http://localhost:4000/cosmo/energy_eq" class="nav-list-link">Energy equipartition</a></li><li class="nav-list-item "><a href="http://localhost:4000/cosmo/solve_friedmann" class="nav-list-link">Friedmann方程式を解く</a></li><li class="nav-list-item "><a href="http://localhost:4000/cosmo/flatness" class="nav-list-link">Flatness problem</a></li><li class="nav-list-item "><a href="http://localhost:4000/cosmo/proper_d" class="nav-list-link">固有距離</a></li><li class="nav-list-item "><a href="http://localhost:4000/cosmo/proper_v" class="nav-list-link">固有体積要素と数密度</a></li><li class="nav-list-item "><a href="http://localhost:4000/cosmo/luminosity_d" class="nav-list-link">光度距離</a></li><li class="nav-list-item "><a href="http://localhost:4000/cosmo/angular_d" class="nav-list-link">角径距離</a></li><li class="nav-list-item "><a href="http://localhost:4000/cosmo/age" class="nav-list-link">宇宙年齢</a></li><li class="nav-list-item "><a href="http://localhost:4000/cosmo/tolman" class="nav-list-link">Tolman効果</a></li><li class="nav-list-item "><a href="http://localhost:4000/cosmo/horizon" class="nav-list-link">地平線</a></li><li class="nav-list-item "><a href="http://localhost:4000/cosmo/planck_scale" class="nav-list-link">Planckスケール</a></li><li class="nav-list-item "><a href="http://localhost:4000/cosmo/gp" class="nav-list-link">Gunn-Peterson test</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="http://localhost:4000/compact" class="nav-list-link">コンパクト天体</a><ul class="nav-list "><li class="nav-list-item "><a href="http://localhost:4000/compact/spin_down" class="nav-list-link">スピンダウンによる中性子星の年齢推定</a></li><li class="nav-list-item "><a href="http://localhost:4000/compact/landau_level" class="nav-list-link">ランダウ準位と中性子星磁場の観測</a></li><li class="nav-list-item "><a href="http://localhost:4000/compact/pseudo_newton" class="nav-list-link">擬ニュートンポテンシャル</a></li><li class="nav-list-item "><a href="http://localhost:4000/compact/torus_phi" class="nav-list-link">力学平衡な磁気流体回転トーラス</a></li><li class="nav-list-item "><a href="http://localhost:4000/compact/mri_parker" class="nav-list-link">磁気回転不安定性とパーカー不安定性の釣り合い</a></li><li class="nav-list-item "><a href="http://localhost:4000/compact/standard_disk" class="nav-list-link">標準降着円盤</a></li><li class="nav-list-item "><a href="http://localhost:4000/compact/standard_disk_spectrum" class="nav-list-link">標準降着円盤からのエネルギー放出とそのスペクトル</a></li><li class="nav-list-item "><a href="http://localhost:4000/compact/roche" class="nav-list-link">ロッシュローブ</a></li><li class="nav-list-item "><a href="http://localhost:4000/compact/chandrasekhar_limit" class="nav-list-link">電子の縮退とチャンドラセカール限界質量</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="http://localhost:4000/atmos" class="nav-list-link">恒星大気の物理学</a><ul class="nav-list "><li class="nav-list-item "><a href="http://localhost:4000/atmos/intensity_flux" class="nav-list-link">光のIntensityとflux</a></li><li class="nav-list-item "><a href="http://localhost:4000/atmos/magnitude_color" class="nav-list-link">恒星の等級と色</a></li><li class="nav-list-item "><a href="http://localhost:4000/atmos/spectrum" class="nav-list-link">恒星のスペクトル</a></li><li class="nav-list-item "><a href="http://localhost:4000/atmos/luminosity_class" class="nav-list-link">Luminosity class</a></li><li class="nav-list-item "><a href="http://localhost:4000/atmos/radiative_transfer" class="nav-list-link">Radiative transferの式</a></li><li class="nav-list-item "><a href="http://localhost:4000/atmos/formal_absorption_emission" class="nav-list-link">Radiative transfer eq.の形式的な解</a></li><li class="nav-list-item "><a href="http://localhost:4000/atmos/infinite_plane_parallel" class="nav-list-link">深さ無限大のplane-parallel大気</a></li><li class="nav-list-item "><a href="http://localhost:4000/atmos/eddington_barbier" class="nav-list-link">Eddington-Barbier relation</a></li><li class="nav-list-item "><a href="http://localhost:4000/atmos/moment" class="nav-list-link">Radiative transfer eq.のモーメント</a></li><li class="nav-list-item "><a href="http://localhost:4000/atmos/schwarzschild_milne" class="nav-list-link">Schwarzschild-Milne equations</a></li><li class="nav-list-item "><a href="http://localhost:4000/atmos/diffusion" class="nav-list-link">Diffusion Approximation</a></li><li class="nav-list-item "><a href="http://localhost:4000/atmos/gray" class="nav-list-link">Gray atmosphere</a></li><li class="nav-list-item "><a href="http://localhost:4000/atmos/eddington_app" class="nav-list-link">Eddington approximation</a></li><li class="nav-list-item "><a href="http://localhost:4000/atmos/state_of_gas" class="nav-list-link">ガスの状態と光の吸収・発光係数</a></li><li class="nav-list-item "><a href="http://localhost:4000/atmos/transition_prob" class="nav-list-link">遷移確率</a></li><li class="nav-list-item "><a href="http://localhost:4000/atmos/continuum_einstein_milne" class="nav-list-link">連続光に対するEinstein-Milne relation</a></li><li class="nav-list-item "><a href="http://localhost:4000/atmos/hydrogen_atom" class="nav-list-link">水素原子</a></li><li class="nav-list-item "><a href="http://localhost:4000/atmos/lte" class="nav-list-link">LTE</a></li><li class="nav-list-item "><a href="http://localhost:4000/atmos/hydrostatic_equilibrium" class="nav-list-link">静水圧平衡</a></li><li class="nav-list-item "><a href="http://localhost:4000/atmos/radiative_equilibrium" class="nav-list-link">放射平衡</a></li><li class="nav-list-item "><a href="http://localhost:4000/atmos/scattering_dominated" class="nav-list-link">優勢な散乱によって生じる問題</a></li><li class="nav-list-item "><a href="http://localhost:4000/atmos/temperature_compensation" class="nav-list-link">理論的大気モデル計算法の概要</a></li><li class="nav-list-item "><a href="http://localhost:4000/atmos/temperature_distribution" class="nav-list-link">温度分布</a></li><li class="nav-list-item "><a href="http://localhost:4000/atmos/continuous_spectrum" class="nav-list-link">連続スペクトル</a></li><li class="nav-list-item "><a href="http://localhost:4000/atmos/bolometric_correction" class="nav-list-link">全輻射補正</a></li><li class="nav-list-item "><a href="http://localhost:4000/atmos/expanded_atmos" class="nav-list-link">広がった大気</a></li><li class="nav-list-item "><a href="http://localhost:4000/atmos/spherical_gray" class="nav-list-link">Sperical gray atmosphere</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="http://localhost:4000/stellar" class="nav-list-link">恒星物理学</a><ul class="nav-list "></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="http://localhost:4000/nucl" class="nav-list-link">原子核物理学</a><ul class="nav-list "><li class="nav-list-item "><a href="http://localhost:4000/nucl/wu" class="nav-list-link">Wuの実験</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="http://localhost:4000/math" class="nav-list-link">数学</a><ul class="nav-list "><li class="nav-list-item "><a href="http://localhost:4000/math/sinc" class="nav-list-link">sinc関数の積分</a></li><li class="nav-list-item "><a href="http://localhost:4000/math/sinc2" class="nav-list-link">sinc関数の2乗の積分</a></li><li class="nav-list-item "><a href="http://localhost:4000/math/sin_n_cos_n" class="nav-list-link">sin^n, cos^nの積分</a></li><li class="nav-list-item "><a href="http://localhost:4000/math/fresnel" class="nav-list-link">フレネル積分</a></li><li class="nav-list-item "><a href="http://localhost:4000/math/laplacian" class="nav-list-link">3次元極座標でのラプラシアン</a></li><li class="nav-list-item "><a href="http://localhost:4000/math/gamma" class="nav-list-link">ガンマ関数</a></li><li class="nav-list-item "><a href="http://localhost:4000/math/beta" class="nav-list-link">ベータ関数</a></li><li class="nav-list-item "><a href="http://localhost:4000/math/zeta" class="nav-list-link">ゼータ関数</a></li><li class="nav-list-item "><a href="http://localhost:4000/math/generating" class="nav-list-link">母関数</a></li><li class="nav-list-item "><a href="http://localhost:4000/math/laguerre" class="nav-list-link">ラゲール多項式</a></li><li class="nav-list-item "><a href="http://localhost:4000/math/bessel" class="nav-list-link">ベッセル関数</a></li><li class="nav-list-item "><a href="http://localhost:4000/math/half_bessel" class="nav-list-link">半整数次のベッセル関数</a></li><li class="nav-list-item "><a href="http://localhost:4000/math/modified_bessel_airy" class="nav-list-link">修正ベッセル関数とエアリー関数</a></li><li class="nav-list-item "><a href="http://localhost:4000/math/sph_bessel" class="nav-list-link">球ベッセル関数と球ノイマン関数</a></li><li class="nav-list-item "><a href="http://localhost:4000/math/legendre" class="nav-list-link">ルジャンドル多項式</a></li><li class="nav-list-item "><a href="http://localhost:4000/math/associated_legendre" class="nav-list-link">ルジャンドル陪関数</a></li><li class="nav-list-item "><a href="http://localhost:4000/math/spherical" class="nav-list-link">球面調和関数</a></li><li class="nav-list-item "><a href="http://localhost:4000/math/chebyshev" class="nav-list-link">チェビシェフ多項式</a></li><li class="nav-list-item "><a href="http://localhost:4000/math/rayleigh_expansion" class="nav-list-link">レイリーの公式</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="http://localhost:4000/ml" class="nav-list-link">機械学習</a><ul class="nav-list "><li class="nav-list-item "><a href="http://localhost:4000/ml/universal_approximation" class="nav-list-link">万能近似定理</a></li></ul></li><li class="nav-list-item active"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="http://localhost:4000/mo" class="nav-list-link">数理最適化</a><ul class="nav-list "><li class="nav-list-item "><a href="http://localhost:4000/mo/first" class="nav-list-link">最適性の1次の必要条件</a></li><li class="nav-list-item "><a href="http://localhost:4000/mo/second" class="nav-list-link">最適性の2次の十分条件</a></li><li class="nav-list-item "><a href="http://localhost:4000/mo/tts" class="nav-list-link">Time-to-solution</a></li><li class="nav-list-item active"><a href="http://localhost:4000/mo/augmented_lagrangian" class="nav-list-link active">拡張ラグランジュ関数法</a></li><li class="nav-list-item "><a href="http://localhost:4000/mo/ohzeki" class="nav-list-link">大関法</a></li><li class="nav-list-item "><a href="http://localhost:4000/mo/clique_cover" class="nav-list-link">クリーク被覆問題</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="http://localhost:4000/qc" class="nav-list-link">量子回路</a><ul class="nav-list "><li class="nav-list-item "><a href="http://localhost:4000/qc/qnd0" class="nav-list-link">Quantum Native Dojo, 0</a></li><li class="nav-list-item "><a href="http://localhost:4000/qc/qnd1" class="nav-list-link">Quantum Native Dojo, 1</a></li><li class="nav-list-item "><a href="http://localhost:4000/qc/qnd2" class="nav-list-link">Quantum Native Dojo, 2</a></li><li class="nav-list-item "><a href="http://localhost:4000/qc/qnd4" class="nav-list-link">Quantum Native Dojo, 4</a></li><li class="nav-list-item "><a href="http://localhost:4000/qc/qnd8" class="nav-list-link">Quantum Native Dojo, 8</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="http://localhost:4000/qa" class="nav-list-link">量子アニーリング</a><ul class="nav-list "><li class="nav-list-item "><a href="http://localhost:4000/qa/qa4u1" class="nav-list-link">Quantum annealing for you, 1</a></li><li class="nav-list-item "><a href="http://localhost:4000/qa/qa4u2" class="nav-list-link">Quantum annealing for you, 2</a></li><li class="nav-list-item "><a href="http://localhost:4000/qa/qa4u3" class="nav-list-link">Quantum annealing for you, 3</a></li><li class="nav-list-item "><a href="http://localhost:4000/qa/qa4u4" class="nav-list-link">Quantum annealing for you, 4</a></li><li class="nav-list-item "><a href="http://localhost:4000/qa/qa4u5" class="nav-list-link">Quantum annealing for you, 5</a></li><li class="nav-list-item "><a href="http://localhost:4000/qa/qa4ug" class="nav-list-link">Quantum annealing for you, group</a></li><li class="nav-list-item "><a href="http://localhost:4000/qa/quantum_and_classical_annealing_with_multi_local_minima" class="nav-list-link">多数の局所解があるような連続ポテンシャルでの量子・古典アニーリング</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="http://localhost:4000/infostat" class="nav-list-link">情報統計力学</a><ul class="nav-list "><li class="nav-list-item "><a href="http://localhost:4000/infostat/statistical_mechanics" class="nav-list-link">統計力学の復習</a></li><li class="nav-list-item "><a href="http://localhost:4000/infostat/random_spin_system" class="nav-list-link">ランダムスピン系</a></li><li class="nav-list-item "><a href="http://localhost:4000/infostat/random_matrix" class="nav-list-link">ランダム行列</a></li><li class="nav-list-item "><a href="http://localhost:4000/infostat/ml" class="nav-list-link">機械学習</a></li><li class="nav-list-item "><a href="http://localhost:4000/infostat/report" class="nav-list-link">レポート問題</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="http://localhost:4000/pro" class="nav-list-link">プログラミング</a><ul class="nav-list "><li class="nav-list-item "><a href="http://localhost:4000/pro/python" class="nav-list-link">Python</a></li><li class="nav-list-item "><a href="http://localhost:4000/pro/amplify" class="nav-list-link">Amplify</a></li><li class="nav-list-item "><a href="http://localhost:4000/pro/gitbook" class="nav-list-link">GitBook</a></li><li class="nav-list-item "><a href="http://localhost:4000/pro/git" class="nav-list-link">Git</a></li><li class="nav-list-item "><a href="http://localhost:4000/pro/jekyll" class="nav-list-link">Jekyll</a></li><li class="nav-list-item "><a href="http://localhost:4000/pro/triple_display" class="nav-list-link">M1 Macで3画面</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="http://localhost:4000/tips" class="nav-list-link">Tips</a><ul class="nav-list "><li class="nav-list-item "><a href="http://localhost:4000/tips/physical_const" class="nav-list-link">物理定数</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="http://localhost:4000/eng" class="nav-list-link">英語</a><ul class="nav-list "><li class="nav-list-item "><a href="http://localhost:4000/eng/20220123" class="nav-list-link">英会話レッスン20220123</a></li><li class="nav-list-item "><a href="http://localhost:4000/eng/20220213" class="nav-list-link">英会話レッスン20220213</a></li><li class="nav-list-item "><a href="http://localhost:4000/eng/20220220" class="nav-list-link">英会話レッスン20220220</a></li><li class="nav-list-item "><a href="http://localhost:4000/eng/20220306" class="nav-list-link">英会話レッスン20220306</a></li><li class="nav-list-item "><a href="http://localhost:4000/eng/20220327" class="nav-list-link">英会話レッスン20220327</a></li><li class="nav-list-item "><a href="http://localhost:4000/eng/20220402" class="nav-list-link">英会話レッスン20220402</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="http://localhost:4000/poem" class="nav-list-link">ポエム</a><ul class="nav-list "><li class="nav-list-item "><a href="http://localhost:4000/poem/research_in_graduate" class="nav-list-link">大学院での研究生活</a></li><li class="nav-list-item "><a href="http://localhost:4000/poem/ans" class="nav-list-link">研究の意味とは？</a></li></ul></li></ul> </nav> <footer class="site-footer"> This site uses <a href="https://github.com/pmarsceill/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll. </footer> </div> <div class="main" id="top"> <div id="main-header" class="main-header"> <div class="search"> <div class="search-input-wrap"> <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search 宇宙物理メモ" aria-label="Search 宇宙物理メモ" autocomplete="off"> <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label> </div> <div id="search-results" class="search-results"></div> </div> </div> <div id="main-content-wrap" class="main-content-wrap"> <nav aria-label="Breadcrumb" class="breadcrumb-nav"> <ol class="breadcrumb-nav-list"> <li class="breadcrumb-nav-list-item"><a href="http://localhost:4000/mo">数理最適化</a></li> <li class="breadcrumb-nav-list-item"><span>拡張ラグランジュ関数法</span></li> </ol> </nav> <div id="main-content" class="main-content" role="main"> <details open=""> <summary class="text-delta"> Table of contents </summary> <ol id="markdown-toc"> <li><a href="#拡張ラグランジュ関数法" id="markdown-toc-拡張ラグランジュ関数法">拡張ラグランジュ関数法</a> <ol> <li><a href="#拡張ラグランジュ関数" id="markdown-toc-拡張ラグランジュ関数">拡張ラグランジュ関数</a></li> <li><a href="#アルゴリズム" id="markdown-toc-アルゴリズム">アルゴリズム</a></li> <li><a href="#拡張ラグランジュ関数法が適用できない例" id="markdown-toc-拡張ラグランジュ関数法が適用できない例">拡張ラグランジュ関数法が適用できない例</a></li> <li><a href="#tspによる検証" id="markdown-toc-tspによる検証">TSPによる検証</a> <ol> <li><a href="#tspの復習" id="markdown-toc-tspの復習">TSPの復習</a></li> <li><a href="#従来のqubo" id="markdown-toc-従来のqubo">従来のQUBO</a></li> <li><a href="#拡張ラグランジュ関数法に合わせたqubo" id="markdown-toc-拡張ラグランジュ関数法に合わせたqubo">拡張ラグランジュ関数法に合わせたQUBO</a></li> <li><a href="#数値実験結果" id="markdown-toc-数値実験結果">数値実験結果</a></li> </ol> </li> </ol> </li> <li><a href="#補題-未定乗数更新についての証明" id="markdown-toc-補題-未定乗数更新についての証明">補題: 未定乗数更新についての証明</a></li> <li><a href="#参考文献" id="markdown-toc-参考文献">参考文献</a></li> </ol> </details> <script async="" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-9131160172347693" crossorigin="anonymous"></script> <!-- for_jekyll --> <p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-9131160172347693" data-ad-slot="3528582902" data-ad-format="auto" data-full-width-responsive="true"></ins> <script> (adsbygoogle = window.adsbygoogle || []).push({}); </script></p> <h1 id="拡張ラグランジュ関数法"> <a href="#拡張ラグランジュ関数法" class="anchor-heading" aria-labelledby="拡張ラグランジュ関数法"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 拡張ラグランジュ関数法 </h1> <p>ペナルティ関数法では、ペナルティ関数の重みを表すパラメータ\(\lambda_i\)の値が増加しすぎると、変形して得られた制約なし問題を解くことが数値的に困難になります。<br /> 拡張ラグランジュ法(augmented Lagrangian method)では、ラグランジュ関数とペナルティ関数を足し合わせた拡張ラグランジュ関数を用いて、制約つき最適化問題を制約なし最適化問題に変形します。これにより、上述の問題を克服できます。</p> <h2 id="拡張ラグランジュ関数"> <a href="#拡張ラグランジュ関数" class="anchor-heading" aria-labelledby="拡張ラグランジュ関数"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 拡張ラグランジュ関数 </h2> <p>ラグランジュ関数\(L(\mathbf{x}, \boldsymbol{\lambda}) = \mathrm{obj}(\mathbf{x}) + \sum_i \lambda_i g_i (\mathbf{x})\)に、等式制約\(g_i(\mathbf{x})=0\)に対するペナルティ関数\(g_i(\mathbf{x})^2\)を足し合わせた</p> \[L_\rho(\mathbf{x}, \boldsymbol{\lambda}) = \mathrm{obj}(\mathbf{x}) + \sum_{i=0}^{N-1} \lambda_i g_i (\mathbf{x}) + \frac{\rho}{2} \sum_{i=0}^{N-1} g_i (\mathbf{x})^2 \tag{1}\] <p>を\(\mathbf{x}\)について最小化する制約なし最適化問題を解きます。ここで\(\rho&gt;0\)はペナルティ関数の重みを表すパラメータです。</p> <h2 id="アルゴリズム"> <a href="#アルゴリズム" class="anchor-heading" aria-labelledby="アルゴリズム"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> アルゴリズム </h2> <p>拡張ラグランジュ関数を用いて未定乗数更新を行う方法を以下にまとめます。</p> <p>step 1: パラメータ初期値\(\lambda_i^0, \rho^0\)を設定します。<br /> step 2: (量子)アニーリングにより\(L_{\rho^k} (\mathbf{x}, \boldsymbol{\lambda}^k)\)を最小化するような\(\mathbf{x}\)を求めます。これを\(\mathbf{x}^{\ast (k)}\)と置きます。<br /> step 3: \(\rho^k g(\mathbf{x}^{\ast (k)})\)が0ならば終了します。<br /> step 4: \(\lambda_i^{k+1} = \lambda_i^k + \rho^k g_i (\mathbf{x}^{\ast (k)}), \rho^{k+1} &gt; \rho^k\)を満たすパラメータの値を決定します。\(k \leftarrow k+1\)としてstep 2に戻ります。</p> <h2 id="拡張ラグランジュ関数法が適用できない例"> <a href="#拡張ラグランジュ関数法が適用できない例" class="anchor-heading" aria-labelledby="拡張ラグランジュ関数法が適用できない例"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 拡張ラグランジュ関数法が適用できない例 </h2> <p>拡張ラグランジュ関数法はQUBO制約が線形な形をしている場合にしか使えません。例えばグラフ彩色問題を考えましょう。この問題には「隣り合う頂点の色が同じ色になってはならない」という制約があります。この制約をバイナリ変数を使って表現すると以下のようになります。</p> \[g(\mathbf{x}) = \sum_{(uv) \in E} \sum_{i=0}^{n-1} x_{u, i} x_{v, i}\] <p>ここで\(x_{u, i}\)は頂点\(u\)を色\(i\)で塗るとき1, そうでないとき0となるような変数です。さらに\(n\)はグラフ頂点の総数、\(E\)はグラフに存在する頂点の集合です。</p> <p>この制約から\(g(\mathbf{x})^2\)を計算すると、これは\(x_{u, i}\)の4次式となります。QUBOはその名前の通り、Quadratic Unconstrained Binary Optimization (制約なし2次形式2値変数最適化)であるため、この制約式を拡張ラグランジュ関数法には適用できません。</p> <h2 id="tspによる検証"> <a href="#tspによる検証" class="anchor-heading" aria-labelledby="tspによる検証"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> TSPによる検証 </h2> <p>GitHubにスクリプトをアップロードしています。</p> <p><a href="https://github.com/github-nakasho/augmented_lagrangian_method">github-nakasho/augmented_lagrangian_method</a></p> <h3 id="tspの復習"> <a href="#tspの復習" class="anchor-heading" aria-labelledby="tspの復習"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> TSPの復習 </h3> <p>TSP(巡回セールスマン問題)の目的関数は以下のような数理モデルで定式化されます。</p> \[\min \quad \sum_t \sum_{i, j} d_{ij} x_{t, i} x_{t+1, j} \quad (0\leq t, i, j \leq N-1)\] <p>\(x_{t, i}\)は\(t\)番目に\(i\)の都市を訪れるとき1, そうでないとき0となるようなバイナリ変数です。\(d_{ij}\)は都市\(i\)と都市\(j\)との距離です。\(N\)は訪れる必要がある都市の総数です。この式は\(t\)番目に訪れる都市\(i\)、その次の\(t+1\)番目に訪れる都市\(j\)との距離を計算し、それを全ての時刻で足し合わせたときに最小になるような組み合わせを求めなさいという問題を表現しています。ただし\(x_{N, i} = x_{0, i}\)として、最後の時刻には最初に出発した都市に戻ってくるものとします。<br /> 都市を訪れるにあたり、制約が存在します。1つ目は各時刻において、訪れることができる都市の数は1つに限定されることです。</p> \[\sum_i x_{t, i} = 1 \quad (\forall t) \tag{TSP1}\] <p>2つ目は、各都市は1回だけしか訪れることができないことです。</p> \[\sum_t x_{t, i} = 1 \quad (\forall i) \tag{TSP2}\] <h3 id="従来のqubo"> <a href="#従来のqubo" class="anchor-heading" aria-labelledby="従来のqubo"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 従来のQUBO </h3> <p>これまで考えられてきたQUBO化は以下のようなものでした。</p> \[H = \sum_t \sum_{i, j} d_{ij}x_{t, i} x_{t+1, j} + \lambda_1 \sum_t \left(\sum_i x_{t, i} -1\right)^2 + \lambda_2 \sum_i \left( \sum_t x_{t, i}-1\right)^2 \tag{2}\] <p>右辺の第1項は目的関数、第2項は(TSP1)式の制約、そして第3項は(TSP2)式の制約を表したものです。もし\(\sum_i x_{t, i} \neq 1\)ならば、第2項が正の値を持ちます。</p> <h3 id="拡張ラグランジュ関数法に合わせたqubo"> <a href="#拡張ラグランジュ関数法に合わせたqubo" class="anchor-heading" aria-labelledby="拡張ラグランジュ関数法に合わせたqubo"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 拡張ラグランジュ関数法に合わせたQUBO </h3> <p>(1)式に合わせてQUBOを考えましょう。(TSP1), (TSP2)は以下のような等式制約と考えます。</p> \[\begin{align} L_\rho (\mathbf{x}, \boldsymbol{\lambda}) &amp;= \sum_t \sum_{i, j} d_{ij}x_{t, i} x_{t+1, j} + \sum_t \lambda_t \left(\sum_i x_{t, i} -1\right) + \sum_i \lambda_i \left( \sum_t x_{t, i} -1\right) \notag \\ &amp;\quad + \frac{\rho}{2} \left\{ \sum_t\left(\sum_i x_{t,i}-1 \right)^2 + \sum_i\left(\sum_t x_{t,i}-1 \right)^2 \right\} \tag{3} \end{align}\] <p>もし\(g_i (\mathbf{x}) = (\sum_t x_{t, i} -1 )^2\)のようにしてしまうと、\(g_i(\mathbf{x})^2\)から、\(L_\rho(\mathbf{x}, \boldsymbol{\lambda})\)が\(x_{t, i}\)の4次式となります。<br /> (2)式では1つの制約に対して1つの制約項を考えました。(3)式ではその式の形から、1つの制約に対して\(N\)個の制約を考えます。もし\(\lambda_1 \sum_t (\sum_i x_{t, i}-1)\)のようにしてしまうと、例えば\(\sum_i x_{t, i} = 2, \sum_i x_{t+1, i} = 0\)のようなものも許されることになり、注意が必要です。</p> <h3 id="数値実験結果"> <a href="#数値実験結果" class="anchor-heading" aria-labelledby="数値実験結果"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 数値実験結果 </h3> <p>以下に示すのは20都市のTSPを解いたときに現れる、\(\sum_t x_{t, 2} = 1\)の未定乗数と\(\sum_i x_{2, i}=1\)の未定乗数空間の移動の様子です。青がスタート地点(未定乗数の初期値)、赤がゴール地点(最適解が求まったときの未定乗数の値)を表しています。</p> <p><img src="/assets/images/mo/augmented_tsp.png" alt="未定乗数更新の様子。" /></p> <h1 id="補題-未定乗数更新についての証明"> <a href="#補題-未定乗数更新についての証明" class="anchor-heading" aria-labelledby="補題-未定乗数更新についての証明"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 補題: 未定乗数更新についての証明 </h1> <p>\((\mathbf{x}^\ast, \boldsymbol{\lambda}^\ast)\)を等式制約つき最適化問題の<a href="/mo/second">最適性の2次の十分条件</a>を満たす点としましょう。このとき(1)式の\(\mathbf{x}\)の勾配を考えると</p> \[\nabla_{\mathbf{x}} L_\rho (\mathbf{x}^\ast, \boldsymbol{\lambda}^\ast) = \nabla \mathrm{obj}(\mathbf{x}^\ast) + \sum_{i=0}^{N-1} \lambda_i^\ast \nabla g_i (\mathbf{x}^\ast) + \rho \sum_{i=0}^{N-1} \underbrace{g_i (\mathbf{x}^\ast)}_{=0} \nabla g_i (\mathbf{x}^\ast) =\nabla_{\mathbf{x}} H (\mathbf{x}^\ast, \boldsymbol{\lambda}^\ast) = \mathbf{0}\] <p>が成り立ちます。途中、\(\mathbf{x}^\ast\)は最適解であることから\(g_i(\mathbf{x}^\ast)=0\)を用いました。したがって、点\(\mathbf{x}^\ast\)は\(\mathbf{x}\)について拡張ラグランジュ関数\(L_\rho(\mathbf{x}, \boldsymbol{\lambda}^\ast)\)を最小化させる制約なし最適化問題の停留点となります。<br /> 次に(1)式のヘッセ行列を考えます。</p> \[\begin{aligned} \nabla_{\mathbf{x}\mathbf{x}}^2 L_\rho (\mathbf{x}^\ast, \boldsymbol{\lambda}^\ast) &amp;= \nabla^2 \mathrm{obj}(\mathbf{x}^\ast) + \sum_{i=0}^{N-1} \lambda_i^\ast \nabla^2 g_i(\mathbf{x}^\ast) + \rho \sum_{i=0}^{N-1} \left\{ g_i(\mathbf{x}^\ast) \nabla^2 g_i (\mathbf{x}^\ast) + \nabla g_i (\mathbf{x}^\ast) (\nabla g_i (\mathbf{x}^\ast))^\top \right\} \\ &amp;= \nabla^2 \mathrm{obj} (\mathbf{x}^\ast) + \sum_{i=0}^{N-1} (\lambda_i^\ast + \rho \underbrace{g_i (\mathbf{x}^\ast)}_{=0}) \nabla^2 g_i (\mathbf{x}^\ast) + \rho \sum_{i=0}^{N-1} \nabla g_i (\mathbf{x}^\ast) (\nabla g_i (\mathbf{x}^\ast))^\top \\ &amp;= \nabla^2 H (\mathbf{x}^\ast, \boldsymbol{\lambda}^\ast) + \rho \sum_{i=0}^{N-1} \nabla g_i (\mathbf{x}^\ast) (\nabla g_i (\mathbf{x}^\ast))^\top \end{aligned}\] <p>このとき、\((\nabla g_i (\mathbf{x}^\ast))^\top \mathbf{d} = 0\)を満たす任意の微小ベクトル\(\mathbf{d}\)に対して</p> \[\mathbf{d}^\top \nabla_{\mathbf{x}\mathbf{x}} L_\rho(\mathbf{x}, \boldsymbol{\lambda}) \mathbf{d} = \mathbf{d}^\top \nabla^2 H (\mathbf{x}^\ast, \boldsymbol{\lambda}^\ast) \mathbf{d} \geq 0\] <p>が成り立ちます。それ以外の任意の微小ベクトルについても、パラメータ\(\rho\)を十分大きくとれば\(\mathbf{d}^\top \nabla_{\mathbf{x}\mathbf{x}} L_\rho (\mathbf{x}^\ast, \boldsymbol{\lambda}^\ast) \mathbf{d} \geq 0\)が成り立ちます。</p> <p>よって点\(\mathbf{x}^\ast\)は\(\mathbf{x}\)について\(L_\rho (\mathbf{x}, \boldsymbol{\lambda}^\ast)\)を最小化する、制約なし最適化問題の<a href="/mo/second.md">最適性の2次の十分条件</a>を満たす局所最適解になっていることがわかります。これから、\(L_\rho (\mathbf{x}, \boldsymbol{\lambda})\)を最小化する最適化問題を解けば、\(H(\mathbf{x}, \boldsymbol{\lambda})\)の局所最適解\(\mathbf{x}^\ast\)の精度の高い近似解を得ることができます。<br /> 拡張ラグランジュ関数法では\(\mathbf{x}\)について\(L_\rho (\mathbf{x}, \boldsymbol{\lambda})\)を最小化した後、\(\boldsymbol{\lambda}\)を更新します。そのために、まず\(\mathbf{x}\)について\(L_\rho (\mathbf{x}, \boldsymbol{\lambda}^{(k)})\)を最小化します。この最適化問題の停留点を\(\mathbf{x}^{\ast (k+1)}\)とします。</p> <p>注意: \(\mathbf{x}^{(0)}, \boldsymbol{\lambda}^{(0)}\)を出発点に\(\mathbf{x}^{(1)}\)を求める操作を行うので、\(\boldsymbol{\lambda}\)の肩と\(\mathbf{x}\)の肩の値が1つズレていることに注意しましょう。</p> <p><a href="/mo/first">最適性の1次の必要条件</a>より</p> \[\nabla_\mathbf{x} L_\rho (\mathbf{x}^{\ast (k+1)}, \boldsymbol{\lambda}^{(k)}) = \nabla \mathrm{obj}(\mathbf{x}^{\ast (k+1)}) + \sum \lambda_i^{(k)} \nabla g_i (\mathbf{x}^{\ast (k+1)}) + \rho \sum g_i (\mathbf{x}^{\ast (k+1)}) \nabla g_i (\mathbf{x}^{\ast (k+1)}) = \mathbf{0}\] <p>ここで\(\boldsymbol{\lambda}^{(k+1)} = \boldsymbol{\lambda}^{(k)} + \rho \mathbf{g} (\mathbf{x}^{\ast (k+1)})\)と更新を行うと</p> \[\begin{aligned} \nabla_\mathbf{x} H(\mathbf{x}^{\ast (k+1)}, \boldsymbol{\lambda}^{(k+1)}) &amp;= \nabla \mathrm{obj} (\mathbf{x}^{\ast (k+1)}) + \sum \lambda_i^{(k+1)} \nabla g_i (\mathbf{x}^{\ast (k+1)}) \\ &amp;= \nabla \mathrm{obj} (\mathbf{x}^{\ast (k+1)}) + \sum (\lambda_i^{(k)} + \rho g_i (\mathbf{x}^{\ast (k+1)})) \nabla g_i (\mathbf{x}^{\ast (k+1)}) \\ &amp;= \nabla \mathrm{obj} (\mathbf{x}^{\ast (k+1)}) + \sum \lambda_i^{(k)} \nabla g_i (\mathbf{x}^{\ast (k+1)}) + \rho \sum g_i(\mathbf{x}^{\ast (k+1)}) \nabla g_i (\mathbf{x}^{\ast (k+1)}) \\ &amp;= \nabla_\mathbf{x} L_\rho (\mathbf{x}^{\ast (k+1)}, \boldsymbol{\lambda}^{(k)}) = \mathbf{0} \end{aligned}\] <p>となります。このように、拡張ラグランジュ関数法は等式制約つき最適化問題の最適性の1次の必要条件のうち</p> \[\nabla_\mathbf{x} H (\mathbf{x}^{\ast (k)}, \boldsymbol{\lambda}^{(k)}) = \nabla \mathrm{obj} (\mathbf{x}^{\ast (k)}) + \sum \lambda_i^{(k)} \nabla g_i (\mathbf{x}^{\ast (k)}) = \mathbf{0}\] <p>を満たしつつ、最終的に</p> \[\nabla_\boldsymbol{\lambda} H(\mathbf{x}^{\ast (k)}, \boldsymbol{\lambda}^{(k)}) = \mathbf{g} (\mathbf{x}^{\ast (k)}) = \mathbf{0}\] <p>を満たす\((\mathbf{x}^{\ast (k)}, \boldsymbol{\lambda}^{(k)})\)を求める手法です。</p> <h1 id="参考文献"> <a href="#参考文献" class="anchor-heading" aria-labelledby="参考文献"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 参考文献 </h1> <ul> <li>[1] 梅谷俊治, しっかり学ぶ数理最適化 モデルからアルゴリズムまで</li> <li>[2] <a href="http://yuki-koyama.hatenablog.com/entry/2017/11/09/200000">等式制約あり最適化問題と拡張ラグランジュ乗数法</a></li> <li>[3] <a href="http://www-optima.amp.i.kyoto-u.ac.jp/~nobuo/Ryukoku/2002/course3.pdf">山下信雄, 数理計画法 第3回目: 最適性の条件1</a></li> </ul> <script async="" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-9131160172347693" crossorigin="anonymous"></script> <!-- for_jekyll --> <p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-9131160172347693" data-ad-slot="3528582902" data-ad-format="auto" data-full-width-responsive="true"></ins> <script> (adsbygoogle = window.adsbygoogle || []).push({}); </script></p> <hr> <footer> <p class="text-small text-grey-dk-100 mb-0">Copyright &copy; Sho NAKAMURA</p> <div class="d-flex mt-2"> </div> </footer> </div> </div> <div class="search-overlay"></div> </div> </body> </html>
