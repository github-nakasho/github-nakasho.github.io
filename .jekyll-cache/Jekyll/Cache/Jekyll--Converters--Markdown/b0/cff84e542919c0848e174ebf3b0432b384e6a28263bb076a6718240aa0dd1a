I"Ò:
<details open="">
  <summary class="text-delta">
    Table of contents
  </summary>
<ol id="markdown-toc">
  <li><a href="#å¤§é–¢æ³•" id="markdown-toc-å¤§é–¢æ³•">å¤§é–¢æ³•</a>    <ol>
      <li><a href="#æ¦‚è¦" id="markdown-toc-æ¦‚è¦">æ¦‚è¦</a></li>
      <li><a href="#ç­‰å¼åˆ¶ç´„ã®è¡¨ç¾" id="markdown-toc-ç­‰å¼åˆ¶ç´„ã®è¡¨ç¾">ç­‰å¼åˆ¶ç´„ã®è¡¨ç¾</a></li>
      <li><a href="#å•é¡Œã®å¤‰æ›" id="markdown-toc-å•é¡Œã®å¤‰æ›">å•é¡Œã®å¤‰æ›</a>        <ol>
          <li><a href="#hubbard-stratonovichå¤‰æ›" id="markdown-toc-hubbard-stratonovichå¤‰æ›">Hubbard-Stratonovichå¤‰æ›</a></li>
          <li><a href="#éç‚¹æ³•" id="markdown-toc-éç‚¹æ³•">éç‚¹æ³•</a></li>
          <li><a href="#kullback-leibleræƒ…å ±é‡ã¨gibbsã®è‡ªç”±ã‚¨ãƒãƒ«ã‚®ãƒ¼ã‹ã‚‰ã®å°å‡º" id="markdown-toc-kullback-leibleræƒ…å ±é‡ã¨gibbsã®è‡ªç”±ã‚¨ãƒãƒ«ã‚®ãƒ¼ã‹ã‚‰ã®å°å‡º">Kullback-Leibleræƒ…å ±é‡ã¨Gibbsã®è‡ªç”±ã‚¨ãƒãƒ«ã‚®ãƒ¼ã‹ã‚‰ã®å°å‡º</a></li>
        </ol>
      </li>
      <li><a href="#æœ€é©åŒ–å•é¡Œã‚’è§£ããŸã‚ã®ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ " id="markdown-toc-æœ€é©åŒ–å•é¡Œã‚’è§£ããŸã‚ã®ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ">æœ€é©åŒ–å•é¡Œã‚’è§£ããŸã‚ã®ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ </a></li>
      <li><a href="#æ•°å€¤å®Ÿé¨“" id="markdown-toc-æ•°å€¤å®Ÿé¨“">æ•°å€¤å®Ÿé¨“</a>        <ol>
          <li><a href="#k-minimum-set-of-the-random-values" id="markdown-toc-k-minimum-set-of-the-random-values">K-minimum set of the random values</a></li>
          <li><a href="#pythonã‚¹ã‚¯ãƒªãƒ—ãƒˆ" id="markdown-toc-pythonã‚¹ã‚¯ãƒªãƒ—ãƒˆ">Pythonã‚¹ã‚¯ãƒªãƒ—ãƒˆ</a></li>
          <li><a href="#æ•°å€¤å®Ÿé¨“çµæœ" id="markdown-toc-æ•°å€¤å®Ÿé¨“çµæœ">æ•°å€¤å®Ÿé¨“çµæœ</a></li>
          <li><a href="#boldsymbolnuã®æ›´æ–°ã«ç”¨ã„ã‚‹etaã«ã¤ã„ã¦" id="markdown-toc-boldsymbolnuã®æ›´æ–°ã«ç”¨ã„ã‚‹etaã«ã¤ã„ã¦">\(\boldsymbol{\nu}\)ã®æ›´æ–°ã«ç”¨ã„ã‚‹\(\eta\)ã«ã¤ã„ã¦</a></li>
        </ol>
      </li>
    </ol>
  </li>
  <li><a href="#å‚è€ƒæ–‡çŒ®" id="markdown-toc-å‚è€ƒæ–‡çŒ®">å‚è€ƒæ–‡çŒ®</a></li>
</ol>

</details>

<script async="" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-9131160172347693" crossorigin="anonymous"></script>

<!-- for_jekyll -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-9131160172347693" data-ad-slot="3528582902" data-ad-format="auto" data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script></p>

<h1 id="å¤§é–¢æ³•">å¤§é–¢æ³•</h1>

<h2 id="æ¦‚è¦">æ¦‚è¦</h2>

<p><a href="https://www.nature.com/articles/s41598-020-60022-5">M. Ohzeki, 2020, â€œBreaking limitation of quantum annealer in solving optimization problems under constraintsâ€</a>ã‚’èª­ã‚“ã ã®ã§ã€ãã®å†…å®¹ã®ç†è§£ã‚’æ·±ã‚ã‚‹ãŸã‚ã«ä½œæˆã•ã‚ŒãŸã‚‚ã®ã§ã™ã€‚</p>

<h2 id="ç­‰å¼åˆ¶ç´„ã®è¡¨ç¾">ç­‰å¼åˆ¶ç´„ã®è¡¨ç¾</h2>

<p>\(F_j(\mathbf{x}) = C_j \ (\forall j)\)ã®ã‚ˆã†ãªç­‰å¼åˆ¶ç´„ãŒã‚ã‚‹æœ€é©åŒ–å•é¡Œã‚’æ•°å¼ã§è¡¨ç¾ã™ã‚‹ã“ã¨ã‚’è€ƒãˆã‚‹ã¨ã€ãã®Hamiltonianã¯</p>

\[H_\mathrm{target} (\mathbf{x}) 
= H_0 (\mathbf{x}) + \sum_j \frac{\lambda_j}{2} (F_j (\mathbf{x}) - C_j)^2 \tag{1}\]

<p>ã®ã‚ˆã†ã«æ›¸ã‹ã‚Œã¾ã™ã€‚ã“ã“ã§\(H_0\)ã¯ç­‰å¼åˆ¶ç´„ä»¥å¤–ã®é …ã€ãã—ã¦ç¬¬2é …ã®\(\frac{1}{2}\)ã¯å¾Œã®å¤‰æ›ã‚’ç°¡æ½”ã«è¡¨ã™ãŸã‚ã®ä¿‚æ•°ã§ã™ã€‚</p>

<h2 id="å•é¡Œã®å¤‰æ›">å•é¡Œã®å¤‰æ›</h2>

<h3 id="hubbard-stratonovichå¤‰æ›">Hubbard-Stratonovichå¤‰æ›</h3>

<p>2ä¹—ã®é …ã‚’ç·šå½¢ã®å½¢ã«å¤‰æ›ã™ã‚‹æ–¹æ³•ã¨ã—ã¦ã€Hubbard-Stratonovichå¤‰æ›ãŒã‚ã‚Šã¾ã™ã€‚ã“ã‚Œã‚’é©ç”¨ã™ã‚‹ãŸã‚ã«\(H_\mathrm{target}\)ãŒä½œã‚‹ã‚«ãƒãƒ‹ã‚«ãƒ«åˆ†å¸ƒã®åˆ†å¸ƒé–¢æ•°</p>

\[Z = \sum_\mathbf{x} e^{-\beta H_\mathrm{target} (\mathbf{x})} \tag{2}\]

<p>ã‚’ç”¨ã„ã¾ã™ã€‚ã“ã“ã§\(\beta\)ã¯é€†æ¸©åº¦(\(=1/T\))ã§ã™ã€‚ã“ã‚Œã«Hubbard-Stratonovichå¤‰æ›ã‚’æ–½ã—ã¾ã™ã€‚</p>

\[\begin{aligned}
Z 
&amp;= \sum_\mathbf{x} e^{-\beta H_0(\mathbf{x})} \exp \left\{ -\beta \sum_j \frac{\lambda_j}{2} (F_j (\mathbf{x}) - C_j)^2 \right\} \\
&amp;= \sum_\mathbf{x} e^{-\beta H_0 (\mathbf{x})}\prod_j \exp \left\{ -\beta \frac{\lambda_j}{2} (F_j (\mathbf{x}) - C_j)^2 \right\} \\
&amp;= \sum_\mathbf{x} e^{-\beta H_0 (\mathbf{x})}\prod_j \int_{-\infty}^\infty \frac{dz_j}{\sqrt{2\pi}} e^{-\frac{z_j^2}{2}} \exp \{ i z_j \sqrt{\beta \lambda_j} (F_j (\mathbf{x})-C_j)\}
\end{aligned}\]

<p>ã“ã“ã§\(z_j = -i \sqrt{\frac{\beta}{\lambda_j}} \nu_j\)ã¨å¤‰æ•°å¤‰æ›ã‚’ã™ã‚‹ã¨</p>

\[\begin{align}
Z 
&amp;\propto \sum_\mathbf{x} e^{-\beta H_0 (\mathbf{x})} \prod_j \int_{-\infty}^\infty d\nu_j \exp \left\{ \frac{\beta}{2\lambda_j} \nu_j^2+ \beta \nu_j (F_j (\mathbf{x})-C_j)\right\} \notag \\
&amp;= \sum_\mathbf{x} e^{-\beta H_0 (\mathbf{x})} \left( \int_{-\infty}^\infty d\nu_0 \int_{-\infty}^\infty d\nu_1 \cdots \right) \exp \left\{ \frac{\beta}{2\lambda_0} \nu_0^2 + \beta \nu_0 (F_0 (\mathbf{x})-C_0)\right\} \exp \left\{ \frac{\beta}{2\lambda_1} \nu_1^2+ \beta \nu_1 (F_1 (\mathbf{x})-C_1)\right\}\cdots \notag \\
&amp;= \sum_\mathbf{x} \prod_i \int_{-\infty}^\infty d\nu_i \exp \left\{ -\beta \left( - \sum_j\frac{\nu_j^2}{2\lambda_j} -\sum_j \nu_j (F_j (\mathbf{x})-C_j)+H_0 (\mathbf{x}) \right)\right\} \tag{3}
\end{align}\]

<p>ã¨ãªã‚Šã¾ã™ã€‚ã‚ˆã£ã¦</p>

\[H_\mathrm{eff} (\mathbf{x}, \boldsymbol{\nu}) \equiv - \sum_j\frac{\nu_j^2}{2\lambda_j} -\sum_j \nu_j (F_j (\mathbf{x})-C_j)+H_0 (\mathbf{x}) \tag{4}\]

<p>ã®ã‚ˆã†ã«effective Hamiltonianã‚’ç”¨ã„ã¦ã€ã“ã®åˆ†å¸ƒé–¢æ•°ã‚’è¡¨ç¾ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚</p>

<p>(1)å¼ã®ã¾ã¾ã§ã¯\(\lambda_j\)ã‚’é©åˆ‡ã«ã¨ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã—ãŸãŒã€(4)å¼ã§ã¯\(\lambda_j \rightarrow \infty\)ã¨ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ã‚ˆã£ã¦å®Ÿéš›ã®å®Ÿè£…ã§ã¯ç¬¬2é …ãƒ»ç¬¬3é …ã®ã¿ã‚’è€ƒãˆã‚Œã°è‰¯ã„ã“ã¨ãŒã‚ã‹ã‚Šã¾ã™ã€‚<br />
å¾Œã®ãŸã‚ã«ã•ã‚‰ã«ã“ã‚Œã‚’å¤‰å½¢ã—ã¦ãŠãã¾ã—ã‚‡ã†ã€‚ãƒœãƒ«ãƒ„ãƒãƒ³å› å­ã¯</p>

\[e^{-\beta H_\mathrm{eff}(\mathbf{x}, \boldsymbol{\nu})} 
= e^{\beta \sum_j \frac{\nu_j^2}{2\lambda_j}} e^{-\beta \sum_j \nu_j C_j} \exp \left\{ -\beta H_0 (\mathbf{x}) + \beta \sum_j \nu_j F_j (\mathbf{x}) \right\} \tag{5}\]

<p>ã®ã‚ˆã†ã«æ›¸ãæ›ãˆã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚(3), (5)å¼ã‚ˆã‚Š</p>

\[Z 
\propto \prod_i \int_{-\infty}^\infty d\nu_i e^{\beta \sum_j \frac{\nu_j^2}{2\lambda_j}} e^{-\beta \sum_j \nu_j C_j} \sum_\mathbf{x} \exp \left\{ -\beta H_0 (\mathbf{x}) + \beta \sum_j \nu_j F_j (\mathbf{x}) \right\}\]

<p>ã“ã‚Œã‹ã‚‰\(\boldsymbol{\nu}\)ã«ãŠã‘ã‚‹effective partition functionã‚’</p>

\[Z_\mathrm{eff}(\boldsymbol{\nu}) 
\equiv \sum_\mathbf{x} \exp \left\{ -\beta H_0 (\mathbf{x}) + \beta \sum_j \nu_j F_j (\mathbf{x}) \right\} \tag{6}\]

<p>ã®ã‚ˆã†ã«æ›¸ãã“ã¨ãŒã§ãã¾ã™ã€‚ã“ã‚Œã‚’ç”¨ã„ã¦åˆ†å¸ƒé–¢æ•°ã¯</p>

\[\begin{aligned}
Z 
&amp;\propto \prod_i \int_{-\infty}^\infty d\nu_i e^{\beta \sum_j \frac{\nu_j^2}{2\lambda_j}} e^{-\beta \sum_j \nu_j C_j} e^{\log Z_\mathrm{eff}(\boldsymbol{\nu})} \\
&amp;= \prod_i \int_{-\infty}^\infty d\nu_i \exp \left\{-\beta \left( - \sum_j \frac{\nu_j^2}{2\lambda_j} + \sum_j \nu_j C_j - \frac{1}{\beta} \log Z_\mathrm{eff}(\boldsymbol{\nu}) \right) \right\}
\end{aligned}\]

<p>ã¨å¤‰å½¢ã§ãã¾ã™ã€‚ã“ã“ã‹ã‚‰ã€\(\boldsymbol{\nu}\)ã«ãŠã‘ã‚‹effective Hamiltonianã‚’</p>

\[H_\mathrm{eff}(\boldsymbol{\nu}) 
\equiv - \sum_j \frac{\nu_j^2}{2\lambda_j} + \sum_j \nu_j C_j - \frac{1}{\beta} \log Z_\mathrm{eff}(\boldsymbol{\nu}) \tag{7}\]

<p>ã®ã‚ˆã†ã«å®šç¾©ã™ã‚‹ã“ã¨ã‚‚ã§ãã¾ã™ã€‚</p>

<h3 id="éç‚¹æ³•">éç‚¹æ³•</h3>

<p>(3)å¼ã«ãŠã„ã¦\(\beta \rightarrow \infty\)ã®æ¥µé™ã‚’ã¨ã‚‹ã¨ã€\(\int d \nu_i\)ã®ç©åˆ†ã«å¯„ä¸ã™ã‚‹ã®ã¯\(H_\mathrm{eff} (\mathbf{x}, \boldsymbol{\nu})\)ã®æœ€å°å€¤éƒ¨åˆ†ã®ã¿ã§ã™ã€‚(4)å¼ã‚’å¤‰å½¢ã—ã¦ãã®æœ€å°å€¤ã‚’è¨ˆç®—ã—ã¾ã—ã‚‡ã†ã€‚</p>

\[H_\mathrm{eff} (\mathbf{x}, \boldsymbol{\nu}) 
= -\sum_j \frac{1}{2\lambda_j} (\nu_j + \lambda_j (F_j(\mathbf{x})-C_j))^2 + \sum_j \frac{\lambda_j}{2} (F_j(\mathbf{x})-C_j)^2 + H_0 (\mathbf{x})\]

<p>ç¬¬1é …ã¯å¿…ãšãƒã‚¤ãƒŠã‚¹ã®å€¤ã¨ãªã‚‹ã®ã§ã€ç¬¬2é …ãŒ0ã¨ãªã‚‹ã‚ˆã†ãªå ´æ‰€ãŒæœ€å°å€¤ã§ã™ã€‚ã‚ˆã£ã¦</p>

\[F_j (\mathbf{x}) 
= C_j \quad (\forall j)\]

<p>ã¨ã„ã†ç­‰å¼åˆ¶ç´„ãŒæˆã‚Šç«‹ã¡ã¾ã™ã€‚ã“ã“ã‹ã‚‰(4)å¼ã‚’æœ€å°åŒ–ã™ã‚‹ã“ã¨ã¯ã€(1)å¼ã®\(H_\mathrm{target}\)ã‚’æœ€å°åŒ–ã™ã‚‹ã“ã¨ã«ç­‰ã—ã„ã“ã¨ãŒã‚ã‹ã‚Šã¾ã™ã€‚</p>

<h3 id="kullback-leibleræƒ…å ±é‡ã¨gibbsã®è‡ªç”±ã‚¨ãƒãƒ«ã‚®ãƒ¼ã‹ã‚‰ã®å°å‡º">Kullback-Leibleræƒ…å ±é‡ã¨Gibbsã®è‡ªç”±ã‚¨ãƒãƒ«ã‚®ãƒ¼ã‹ã‚‰ã®å°å‡º</h3>

<p>ã“ã“ã§ã¯Hubbard-Stratonovichå¤‰æ›ã‚’ç”¨ã„ãªã„å°å‡ºæ–¹æ³•ã‚’ã”ç´¹ä»‹ã—ã¾ã™ã€‚åˆ†å¸ƒ\(P\)ã¨åˆ†å¸ƒ\(Q\)ã«ãŠã‘ã‚‹Kullback-Leibleræƒ…å ±é‡(KL)ã¯</p>

\[\mathrm{KL}(P|Q) 
= \sum_\mathbf{x} Q(\mathbf{x}) \log \left( \frac{Q(\mathbf{x})}{P(\mathbf{x})}\right)\]

<p>ã§ã™ã€‚ã“ã“ã§åˆ†å¸ƒ\(P\)ã¯</p>

\[P(\mathbf{x}) 
= \frac{1}{Z} e^{-\beta H_0 (\mathbf{x})}\]

<p>ã®ã‚ˆã†ã«\(F_j(\mathbf{x})=C_j\)ã®åˆ¶ç´„ãŒãªã„å ´åˆã®Hamiltonianã«ã‚ˆã‚‹ãƒœãƒ«ãƒ„ãƒãƒ³åˆ†å¸ƒã¨ã—ã¾ã™ã€‚ãã—ã¦åˆ†å¸ƒ\(Q\)ã¯\(F_j(\mathbf{x}) =C_j\)ã®åˆ¶ç´„ã‚’æº€ãŸã—ã€KLãŒæœ€å°ã¨ãªã‚‹ã‚ˆã†ãªåˆ†å¸ƒã§ã™ã€‚ã“ã®æ¡ä»¶ã‹ã‚‰ã€Gibbsã®è‡ªç”±ã‚¨ãƒãƒ«ã‚®ãƒ¼ãŒ</p>

\[G(\mathbf{C}) 
= \min_Q \left( E-\frac{S}{\beta} \right)\]

<p>ã®ã‚ˆã†ã«æ±‚ã¾ã‚Šã¾ã™ã€‚ã“ã“ã§\(E = \sum_\mathbf{x} Q(\mathbf{x}) H_0(\mathbf{x})\)ã¯ã‚¨ãƒãƒ«ã‚®ãƒ¼ã€ãã—ã¦\(S= -\sum_\mathbf{x} Q(\mathbf{x}) \log Q(\mathbf{x})\)ã¯ã‚¨ãƒ³ãƒˆãƒ­ãƒ”ãƒ¼ã§ã™ã€‚</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>KLã‹ã‚‰Gã‚’å°ãã“ã¨ãŒã§ããªã„...ã©ãªãŸã‹è¨¼æ˜ã®è©³ç´°ã‚’ã”æ•™ç¤ºã„ãŸã ã‘ã‚‹ã¨åŠ©ã‹ã‚Šã¾ã™m(-_-)m
</code></pre></div></div>

<p>\(Q\)ã®å½¢ã¨ã—ã¦ã€ãƒ©ã‚°ãƒ©ãƒ³ã‚¸ãƒ¥æœªå®šä¹—æ•°ã¨(6)å¼ã®\(Z_\mathrm{eff}\)ã‚’ç”¨ã„ã¦</p>

\[Q (\mathbf{x}) 
= \frac{1}{Z_\mathrm{eff}} \exp \left\{ -\beta \left(H_0 (\mathbf{x}) - \sum_j \nu_j F_j(\mathbf{x})\right)\right\}\]

<p>ã¨ã—ã¾ã—ã‚‡ã†ã€‚ã“ã®\(Q\)ã®å½¢ã®ä¸­ã§\(\boldsymbol{\nu}\)ã‚’ã©ã®ã‚ˆã†ã«é¸ã¹ã°\(G(\mathbf{C})\)ã‚’æœ€å°ã«ã§ãã‚‹ã‹ã‚’è€ƒãˆã¾ã™ã€‚</p>

\[\begin{aligned}
G(\mathbf{C}) 
&amp;= \min_Q \left[ \sum_\mathbf{x} Q (\mathbf{x})\left( H_0 (\mathbf{x}) + \frac{1}{\beta} \log Q(\mathbf{x})\right) \right] \\
&amp;= \min_Q \left[ \sum_\mathbf{x} Q (\mathbf{x})\left( H_0 (\mathbf{x}) + \frac{1}{\beta} \log \frac{1}{Z_\mathrm{eff}} -H_0 (\mathbf{x}) + \sum_j \nu_j F_j(\mathbf{x})\right) \right] \\
&amp;= \min_Q \left[ \sum_\mathbf{x} Q(\mathbf{x}) \left(\sum_j \nu_j F_j (\mathbf{x})-\frac{1}{\beta} \log Z_\mathrm{eff} \right)\right]
\end{aligned}\]

<p>\(F_j=C_j\)ã®åˆ¶ç´„ã‚’æº€ãŸã™ã“ã¨ã¨åˆã‚ã›ã¦</p>

\[G(\mathbf{C}) 
= \min_{\boldsymbol{\nu}} \left[ \sum_j \nu_j C_j - \frac{1}{\beta} \log Z_\mathrm{eff}\right]\]

<p>ã“ã‚Œã¯(7)å¼ã‚’æœ€å°åŒ–ã™ã‚‹ã“ã¨ã‚’æ„å‘³ã—ã¦ã„ã¾ã™ã€‚ã“ã®ã“ã¨ã‹ã‚‰ã€ã“ã®ã‚ˆã†ã«KLã¨Gibbsè‡ªç”±ã‚¨ãƒãƒ«ã‚®ãƒ¼ã‚’ç”¨ã„ãŸå°å‡ºã‚‚åŒã˜çµæœã¨ãªã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚</p>

<h2 id="æœ€é©åŒ–å•é¡Œã‚’è§£ããŸã‚ã®ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ">æœ€é©åŒ–å•é¡Œã‚’è§£ããŸã‚ã®ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ </h2>

<p>ä»¥ä¸‹ã«ã€ã“ã®æ‰‹æ³•ã‚’ç”¨ã„ã¦æœ€é©åŒ–å•é¡Œã‚’è§£ãã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã‚’ç¤ºã—ã¾ã™ã€‚</p>

<ul>
  <li>step 1: åˆæœŸæœªå®šä¹—æ•°\(\boldsymbol{\nu}^{t=0}\)ã‚’æ±ºå®šã—ã¾ã™ã€‚</li>
  <li>step 2: (é‡å­)ã‚¢ãƒ‹ãƒ¼ãƒªãƒ³ã‚°ãªã©ã‚’ç”¨ã„ã¦ã€ã“ã®å¤‰æ›ã§2ä¹—ã®é …ã‚’ç·šå½¢ã«ã—ãŸãƒãƒŸãƒ«ãƒˆãƒ‹ã‚¢ãƒ³ã‚’æœ€å°åŒ–ã—ã¾ã™ã€‚</li>
  <li>step 3: åˆ¶ç´„ãŒæº€ãŸã•ã‚ŒãŸ\((F_j(\mathbf{x})=C_j \ \forall j)\)ãªã‚‰ã°ã€çµ‚äº†ã—ã¾ã™ã€‚</li>
  <li>step 4: \(\nu_j^{t+1} = \nu_j^t + \eta (C_j - F_j(\mathbf{x}))\)ã¨ã—ã¦ã€æ¬¡ã®åå¾©ã§ã®\(\boldsymbol{\nu}^{t+1}\)ã‚’è¨ˆç®—ã—ã¾ã™ã€‚\(t \leftarrow t+1\)ã¨ã—ã¦ã€step 2ã«æˆ»ã‚Šã¾ã™ã€‚</li>
</ul>

<h2 id="æ•°å€¤å®Ÿé¨“">æ•°å€¤å®Ÿé¨“</h2>

<h3 id="k-minimum-set-of-the-random-values">K-minimum set of the random values</h3>

<p>ä»Šå›ã®æ•°å€¤å®Ÿé¨“ã¯K-minimum setå•é¡Œã§ã™ã€‚ã„ãã¤ã‹ã®ä¹±æ•°ã®ä¸­ã‹ã‚‰\(K\)å€‹ã ã‘é¸ã³å‡ºã—ã€ãã®æ•°ã®ç·å’ŒãŒæœ€å°ã«ãªã‚‹çµ„ã¿åˆã‚ã›ã‚’æ¢ç´¢ã—ã¾ã™ã€‚ã“ã®ã¨ãã€æ™®é€šã®å®Ÿè£…ã§ã¯</p>

\[H_\mathrm{target}(\mathbf{x}) = \sum_{i=0}^{N-1} h_i x_i + \frac{\lambda}{2} \left(\sum_{i=0}^{N-1} x_i -K\right)^2\]

<p>ã¨ãªã‚Šã¾ã™ã€‚ã“ã“ã§\(N\)ã¯\([0, 1]\)ã®ç¯„å›²ã®ä¹±æ•°ã®ç·æ•°ã€\(h_i \ (i = 0, \dots, N-1)\)ã¯ä¹±æ•°åˆ—ã€\(x_i\)ã¯\(i\)ç•ªç›®ã®ä¹±æ•°ã‚’é¸ã¶ã¨ã1, ãã†ã§ãªã„ã¨ã0ã¨ãªã‚‹ãƒã‚¤ãƒŠãƒªå¤‰æ•°ã§ã™ã€‚<br />
ã“ã‚Œã‚’(4)å¼ã®effective Hamiltonianã«å½“ã¦ã¯ã‚ã‚‹ã¨</p>

\[H_\mathrm{eff}(\mathbf{x}, \nu) 
= -\nu \left( \sum_{i=0}^{N-1} x_i -K\right) + \sum_{i=0}^{N-1} h_i x_i\]

<p>ã¨ãªã‚Šã¾ã™ã€‚ã“ã‚Œã‚’å®Ÿè£…ã—ã¾ã™ã€‚</p>

<h3 id="pythonã‚¹ã‚¯ãƒªãƒ—ãƒˆ">Pythonã‚¹ã‚¯ãƒªãƒ—ãƒˆ</h3>

<p>ä»¥ä¸‹ã«ã€ä»Šå›å®Ÿè£…ã—ãŸPythonã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã—ã¾ã—ãŸã€‚</p>

<p><a href="https://github.com/github-nakasho/ohzeki_method" class="btn btn-purple">Link button</a></p>

<h3 id="æ•°å€¤å®Ÿé¨“çµæœ">æ•°å€¤å®Ÿé¨“çµæœ</h3>

<p>num_reads=1, \(\eta=0.0001\)ã€ãã—ã¦ä¹±æ•°ã®ç·æ•°\(N=2000\)ã§ã‚¢ãƒ‹ãƒ¼ãƒªãƒ³ã‚°ã‚’è¡Œã£ãŸçµæœã‚’ä»¥ä¸‹ã«ç¤ºã—ã¾ã™ã€‚ã“ã‚Œã¯æ¨ªè»¸ã«æœªå®šä¹—æ•°æ›´æ–°stepæ•°ã€ç¸¦è»¸ã«ã¯æœ€é©è§£ã«ãŠã‘ã‚‹ç›®çš„é–¢æ•°ã‹ã‚‰ã®å€¤ã®ã‚ºãƒ¬ã®å¤§ãã•ã‚’æç”»ã—ã¦ã„ã¾ã™ã€‚</p>

<p><img src="/assets/images/mo/ohzeki_01.png" alt="æœ€é©è§£ã‹ã‚‰ã®ã‚ºãƒ¬" /></p>

<p>æ•°å›å®Ÿè¡Œã—ãŸã¨ã“ã‚ã€5~20stepç¨‹åº¦ã§æœ€é©è§£ã‚’ç™ºè¦‹ã§ãã¦ã„ã¾ã—ãŸã€‚ã•ã‚‰ã«ä»¥ä¸‹ã®å›³ã¯æ¨ªè»¸ã«æœªå®šä¹—æ•°æ›´æ–°stepæ•°ã€ç¸¦è»¸ã«æœªå®šä¹—æ•°\(\nu\)ã®å€¤ã‚’æç”»ã—ãŸã‚‚ã®ã§ã™ã€‚</p>

<p><img src="/assets/images/mo/ohzeki_02.png" alt="æœªå®šä¹—æ•°ã®æ›´æ–°" /></p>

<h3 id="boldsymbolnuã®æ›´æ–°ã«ç”¨ã„ã‚‹etaã«ã¤ã„ã¦">\(\boldsymbol{\nu}\)ã®æ›´æ–°ã«ç”¨ã„ã‚‹\(\eta\)ã«ã¤ã„ã¦</h3>

<p>\(\eta\)ã®å€¤ã‚’é©åˆ‡ã«å–ã‚‰ãªã„ã¨ã€æœ€é©è§£å‘¨è¾ºã§æŒ¯å‹•ã™ã‚‹ã‚ˆã†ãªæŒ¯ã‚‹èˆã„ãŒè¦‹ã‚‰ã‚Œã¾ã™ã€‚ä»¥ä¸‹ã¯\(\eta=0.001\)ã®å ´åˆã®æœ€é©è§£ã«ãŠã‘ã‚‹ç›®çš„é–¢æ•°ã‹ã‚‰ã®å€¤ã®ã‚ºãƒ¬ã®å¤§ãã•ã‚’æç”»ã—ãŸã‚‚ã®ã§ã™ã€‚</p>

<p><img src="/assets/images/mo/ohzeki_03.png" alt="ç›®çš„é–¢æ•°ã®æŒ¯å‹•ã™ã‚‹æŒ¯ã‚‹èˆã„" /></p>

<p>ã“ã®å•é¡Œã®å ´åˆã€\(\eta=1/N\)ç¨‹åº¦ãŒã¡ã‚‡ã†ã©è‰¯ã„ã‚ˆã†ã§ã™ã€‚</p>

<h1 id="å‚è€ƒæ–‡çŒ®">å‚è€ƒæ–‡çŒ®</h1>

<ul>
  <li><a href="https://www.nature.com/articles/s41598-020-60022-5">M. Ohzeki, 2020, â€œBreaking limitation of quantum annealer in solving optimization problems under constraintsâ€</a></li>
  <li><a href="/infostat/random_spin_system">æƒ…å ±çµ±è¨ˆç‰©ç†å­¦ ãƒ©ãƒ³ãƒ€ãƒ ã‚¹ãƒ”ãƒ³ç³»</a></li>
</ul>

<script async="" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-9131160172347693" crossorigin="anonymous"></script>

<!-- for_jekyll -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-9131160172347693" data-ad-slot="3528582902" data-ad-format="auto" data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script></p>

:ET