I"ÿô
<details open="">
  <summary class="text-delta">
    Table of contents
  </summary>
<ol id="markdown-toc">
  <li><a href="#hlldæ³•" id="markdown-toc-hlldæ³•">HLLDæ³•</a>    <ol>
      <li><a href="#ç£æ°—æµä½“æ–¹ç¨‹å¼ç¾¤" id="markdown-toc-ç£æ°—æµä½“æ–¹ç¨‹å¼ç¾¤">ç£æ°—æµä½“æ–¹ç¨‹å¼ç¾¤</a></li>
      <li><a href="#æµæŸè¨ˆç®—" id="markdown-toc-æµæŸè¨ˆç®—">æµæŸè¨ˆç®—</a></li>
      <li><a href="#æ•°å€¤è¨ˆç®—ã«ç”¨ã„ã‚‹" id="markdown-toc-æ•°å€¤è¨ˆç®—ã«ç”¨ã„ã‚‹">æ•°å€¤è¨ˆç®—ã«ç”¨ã„ã‚‹</a></li>
      <li><a href="#hlldæµæŸã®è¨ˆç®—ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«-å·¥äº‹ä¸­" id="markdown-toc-hlldæµæŸã®è¨ˆç®—ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«-å·¥äº‹ä¸­">HLLDæµæŸã®è¨ˆç®—ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ« (å·¥äº‹ä¸­)</a></li>
    </ol>
  </li>
  <li><a href="#å‚è€ƒæ–‡çŒ®" id="markdown-toc-å‚è€ƒæ–‡çŒ®">å‚è€ƒæ–‡çŒ®</a></li>
</ol>

</details>

<script async="" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-9131160172347693" crossorigin="anonymous"></script>

<!-- for_jekyll -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-9131160172347693" data-ad-slot="3528582902" data-ad-format="auto" data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script></p>

<h1 id="hlldæ³•">HLLDæ³•</h1>

<p>ã“ã“ã§ã¯(ç£æ°—)æµä½“åŠ›å­¦ã®è¨ˆç®—æ‰‹æ³•ã§ã‚ã‚‹HLLDæ³•ã«ã¤ã„ã¦ã®å‹‰å¼·ãƒ¡ãƒ¢ã‚’è¨˜è¿°ã—ã¦ã„ã¾ã™ã€‚</p>

<h2 id="ç£æ°—æµä½“æ–¹ç¨‹å¼ç¾¤">ç£æ°—æµä½“æ–¹ç¨‹å¼ç¾¤</h2>

<p>ç”¨ã„ã‚‹æ–¹ç¨‹å¼ã¯<a href="/simulation/hll">HLLæ³•</a>, <a href="/simulation/hllc">HLLCæ³•</a>ã§è€ƒãˆãŸã‚‚ã®ã¨åŒã˜ã§ã™ã€‚</p>

\[\frac{\partial}{\partial t} \left( \begin{array}{c}
\rho \\
\rho v_x \\
\rho v_y \\
\rho v_z \\
E \\
B_x \\
B_y \\
B_z
\end{array} \right) + \frac{\partial}{\partial x} \left( \begin{array}{c} 
\rho v_x \\
\rho v_x v_x + P_\mathrm{tot} - B_x^2 \\
\rho v_y v_x - B_y B_x\\
\rho v_z v_x - B_z B_x\\
(E + P_\mathrm{tot}) v_x - (\mathbf{B} \cdot \mathbf{v}) B_x \\
0 \\
B_y v_x - v_y B_x \\
B_z v_x - v_z B_x 
\end{array}\right) 
= \frac{\partial \mathbf{U}}{\partial t} + \frac{\partial \mathbf{F}}{\partial x} 
= \mathbf{0} \tag{1}\]

<h2 id="æµæŸè¨ˆç®—">æµæŸè¨ˆç®—</h2>

<p><a href="/simulation/hll">HLLæ³•</a>ã§ã¯ä¸­é–“çŠ¶æ…‹ã‚’1ã¤ã€<a href="/simulation/hllc">HLLCæ³•</a>ã§ã¯ä¸­é–“çŠ¶æ…‹ã‚’2ã¤ç”¨æ„ã—ã¾ã—ãŸã€‚
ä»Šå›è€ƒãˆã‚‹HLLDæ³•ã§ã¯ã€ç£å ´ã«ã‚ˆã‚Šç™ºç”Ÿã™ã‚‹<a href="/mhd/alfven_wave">ã‚¢ãƒ«ãƒ´ã‚§ãƒ¼ãƒ³æ³¢</a>ã®ä¼æ’­ã‚‚è€ƒãˆã¾ã™ã€‚ã‚ˆã£ã¦ä¸‹å›³ã®ã‚ˆã†ã«4ã¤ã®ä¸­é–“çŠ¶æ…‹ã‚’è€ƒãˆã¾ã™ã€‚</p>

<p><img src="/assets/images/simulation/hlld_01.png" alt="" /></p>

<p>ã“ã®ã¨ãã€\(v_x\)ã®ä¸­é–“çŠ¶æ…‹ã§ã‚ã‚‹\(v_{x, L}^\ast, v_{x, L}^{\ast \ast}, v_{x, R}^{\ast \ast}, v_{x, R}^\ast\)ã¯å…¨ã¦ç­‰ã—ã„(ä¸Šå›³ã§ãƒªãƒ¼ãƒãƒ³ãƒ•ã‚¡ãƒ³ã¨å‘¼ã°ã‚Œã‚‹è‰²ã®ã¤ã„ãŸ4ã¤ã®éƒ¨åˆ†ã§å€¤ãŒä¸€å®šã§ã‚ã‚‹)ã¨ä»®å®šã—ã¾ã™ã€‚</p>

\[v_{x, L}^\ast = v_{x, L}^{\ast \ast} = v_{x, R}^{\ast \ast} = v_{x, R}^\ast = S_M \tag{2}\]

<p>ã“ã“ã§\(S_M\)ã¯<a href="/simulation/hllc">HLLCæ³•</a>ã¨åŒæ§˜ã«ã€<a href="/simulation/hll">HLLä¸­é–“çŠ¶æ…‹</a>ã‹ã‚‰æ±‚ã‚ã¾ã™ã€‚ã™ãªã‚ã¡</p>

\[\mathbf{U}_\mathrm{HLL}^\ast 
= \frac{S_R \mathbf{U}_R - S_L \mathbf{U}_L - \mathbf{F}_R + \mathbf{F}_L}{S_R - S_L} \tag{3}\]

<p>ã‹ã‚‰</p>

\[\rho_\mathrm{HLL}^\ast 
= \frac{S_R \rho_R - S_L \rho_L - \rho_R v_{x, R} + \rho_L v_{x, L}}{S_R - S_L} \tag{4}\]

\[\begin{align}
(\rho v_x)_\mathrm{HLL}^\ast 
&amp;= \frac{S_R \rho_R v_{x, R} - S_L \rho_L v_{x, L} - (\rho_R v_{x, R} v_{x, R} + P_{\mathrm{tot}, R} - B_x^2) + (\rho_L v_{x, L} v_{x, L} + P_{\mathrm{tot}, L} - B_x^2)}{S_R - S_L} \notag \\
&amp;= \frac{S_R \rho_R v_{x, R} - S_L \rho_L v_{x, L} - (\rho_R v_{x, R} v_{x, R} + P_{\mathrm{tot}, R}) + (\rho_L v_{x, L} v_{x, L} + P_{\mathrm{tot}, L})}{S_R - S_L} \tag{5}
\end{align}\]

<p>ã‚’æ±‚ã‚ã¦ãŠã„ã¦</p>

\[S_M 
= \frac{(\rho v_x)_\mathrm{HLL}^\ast}{\rho_\mathrm{HLL}^\ast} 
= \frac{(S_R - v_{x, R}) \rho_R v_{x, R} - (S_L - v_{x, L}) \rho_L v_{x, L} - P_{\mathrm{tot}, R} + P_{\mathrm{tot}, L}}{(S_R - v_{x, R})\rho_R -(S_L-v_{x, L}) \rho_L} \tag{6}\]

<p>ã®ã‚ˆã†ã«è¨ˆç®—ã—ã¾ã™ã€‚ã•ã‚‰ã«å…¨åœ§åŠ›ã‚‚ä¸€å®šã§ã‚ã‚‹ã¨ã—ã¾ã™ã€‚</p>

\[P_{\mathrm{tot}, L}^\ast 
= P_{\mathrm{tot}, L}^{\ast \ast} 
= P_{\mathrm{tot}, R}^{\ast \ast}
= P_{\mathrm{tot}, R}^\ast 
= P_\mathrm{tot}^\ast \tag{7}\]

<p><a href="/simulation/hll">HLLCæ³•ã®(16)å¼</a>ã‚ˆã‚Š</p>

\[P_\mathrm{tot}^\ast 
= P_{\mathrm{tot}, R} + \rho_R (S_R - v_{x, R}) (S_M - v_{x, R}) \tag{8}\]

<p>ã¨è¨ˆç®—ã•ã‚Œã¾ã™ãŒã€ã“ã‚Œã‚’ã•ã‚‰ã«å¼å¤‰å½¢ã—ã¾ã—ã‚‡ã†ã€‚(6)å¼ã‚ˆã‚Š</p>

\[\begin{align}
S_M - v_{x, R} 
&amp;= \frac{(S_R - v_{x, R}) \rho_R v_{x, R} - (S_L - v_{x, L}) \rho_L v_{x, L} - P_{\mathrm{tot}, R} + P_{\mathrm{tot}, L} - (S_R - v_{x, R}) \rho_R v_{x, R} + (S_L - v_{x, L}) \rho_L v_{x, R}}{(S_R - v_{x, R})\rho_R -(S_L-v_{x, L}) \rho_L} \notag \\
&amp;= \frac{(S_L - v_{x, L}) \rho_L (v_{x, R} - v_{x, L}) - P_{\mathrm{tot}, R} + P_{\mathrm{tot}, L}}{(S_R - v_{x, R})\rho_R -(S_L-v_{x, L}) \rho_L} \tag{9}
\end{align}\]

<p>ã®ã‚ˆã†ã«è¨ˆç®—ã§ãã‚‹ã®ã§</p>

\[\begin{align}
P_\mathrm{tot}^\ast 
&amp;= P_{\mathrm{tot}, R} + \frac{\rho_R (S_R - v_{x, R}) (S_L - v_{x, L}) \rho_L (v_{x, R} - v_{x, L}) - \rho_R (S_R - v_{x, R}) P_{\mathrm{tot}, R} + \rho_R (S_R - v_{x, R}) P_{\mathrm{tot}, L}}{(S_R - v_{x, R}) \rho_R - (S_L - v_{x, L}) \rho_L} \notag \\
&amp;= \frac{\rho_R (S_R - v_{x, R}) (S_L - v_{x, L}) \rho_L (v_{x, R} - v_{x, L}) + \rho_R (S_R - v_{x, R}) P_{\mathrm{tot}, L} - (S_L - v_{x, L}) \rho_L P_{\mathrm{tot}, R}}{(S_R - v_{x, R}) \rho_R - (S_L - v_{x, L}) \rho_L} \tag{10}
\end{align}\]

<p>å…ˆç¨‹(7)å¼ã§ä»®å®šã—ãŸ\(P_{\mathrm{tot}, L}^{\ast \ast} = P_{\mathrm{tot}, R}^{\ast \ast} = P_{\mathrm{tot}}^{\ast}\)ã¯è‡ªå‹•ã§æº€ãŸã•ã‚Œã¾ã™(ã“ã‚Œã«ã¤ã„ã¦ã¯å¾Œè¿°)ã€‚ã¾ãŸã“ã®ä»®å®šã‚’ãŠã„ã¦ã‚‚ã€æ¥è§¦ä¸é€£ç¶šé¢ãƒ»æ¥æˆ¦ä¸é€£ç¶šé¢ãƒ»å›è»¢ä¸é€£ç¶šé¢ã¯æ­£ã—ãè¨ˆç®—ã•ã‚Œã¾ã™ã€‚<br />
\(S_M, P_\mathrm{tot}^\ast\)ãŒè¨ˆç®—ã§ããŸã®ã§ã€ã“ã‚Œã‚‰ã‚’ç”¨ã„ã¦\(S_\alpha\)ã§ã®ã‚¸ãƒ£ãƒ³ãƒ—æ¡ä»¶ã‹ã‚‰æ§˜ã€…ãªå€¤ã‚’æ±‚ã‚ã¾ã—ã‚‡ã†ã€‚</p>

\[S_\alpha \left( \begin{array}{c}
\rho_\alpha^\ast \\
\rho_\alpha^\ast S_M \\
\rho_\alpha^\ast v_{y, \alpha}^\ast \\
\rho_\alpha^\ast v_{z, \alpha}^\ast \\
E_\alpha^\ast \\
B_{y, \alpha}^\ast \\
B_{z, \alpha}^\ast
\end{array} \right) - \left( \begin{array}{c} 
\rho_\alpha^\ast S_M \\
\rho_\alpha^\ast S_M S_M + P_\mathrm{tot}^\ast - B_x^2 \\
\rho_\alpha^\ast v_{y, \alpha}^\ast S_M - B_{y, \alpha}^\ast B_x \\
\rho_\alpha^\ast v_{z, \alpha}^\ast S_M - B_{z, \alpha}^\ast B_x \\
(E_\alpha^\ast + P_\mathrm{tot}^\ast) S_M - (\mathbf{v}_\alpha^\ast \cdot \mathbf{B}_\alpha^\ast) B_x \\
B_{y, \alpha}^\ast S_M - v_{y, \alpha}^\ast B_x \\
B_{z, \alpha}^\ast S_M - v_{z, \alpha}^\ast B_x  
\end{array} \right) 
= S_\alpha \left( \begin{array}{c}
\rho_\alpha \\
\rho_\alpha S_M \\
\rho_\alpha v_{y, \alpha} \\
\rho_\alpha v_{z, \alpha} \\
E_\alpha \\
B_{y, \alpha} \\
B_{z, \alpha}
\end{array} \right) - \left( \begin{array}{c} 
\rho_\alpha v_{x, \alpha} \\
\rho_\alpha v_{x, \alpha} v_{x, \alpha} + P_\mathrm{tot} - B_x^2 \\
\rho_\alpha v_{y, \alpha} v_{x, \alpha} - B_{y, \alpha} B_x \\
\rho_\alpha v_{z, \alpha} v_{x, \alpha} - B_{z, \alpha} B_x \\
(E_\alpha + P_\mathrm{tot}) v_{x, \alpha} - (\mathbf{v}_\alpha \cdot \mathbf{B}_\alpha) B_x \\
B_{y, \alpha} v_{x, \alpha} - v_{y, \alpha} B_x \\
B_{z, \alpha} v_{x, \alpha} - v_{z, \alpha} B_x  
\end{array} \right) \tag{11}\]

<p>(11)å¼ã®ç¬¬ä¸€å¼ã‚ˆã‚Š</p>

\[(S_\alpha - S_M) \rho_\alpha^\ast 
= (S_\alpha - v_{x, \alpha}) \rho_\alpha \ \Longrightarrow \ 
\rho_\alpha^\ast 
= \frac{S_\alpha - v_{x, \alpha}}{S_\alpha - S_M} \rho_\alpha \tag{12}\]

<p>ã“ã‚Œã¯<a href="/simulation/hllc">HLLCæ³•</a>ã®ã¨ãã¨åŒã˜ã§ã™ã€‚ç¬¬å…­å¼ã‚ˆã‚Š</p>

\[S_\alpha B_{y, \alpha}^\ast - B_{y, \alpha}^\ast S_M + v_{y, \alpha}^\ast B_x 
= S_\alpha B_{y, \alpha} - B_{y, \alpha} v_{x, \alpha} + v_{y, \alpha} B_x \ \Longrightarrow \ 
B_{y, \alpha}^\ast 
= \frac{S_\alpha - v_{x, \alpha}}{S_\alpha - S_M} B_{y, \alpha} + \frac{v_{y, \alpha} - v_{y, \alpha}^\ast}{S_\alpha - S_M} B_x \tag{13}\]

<p>ã“ã‚Œã¨ç¬¬ä¸‰å¼ã‚ˆã‚Š</p>

\[\begin{aligned}
&amp;S_\alpha \rho_\alpha^\ast v_{y, \alpha}^\ast - \rho_\alpha^\ast v_{y, \alpha}^\ast S_M + B_{y, \alpha}^\ast B_x 
= S_\alpha \rho_\alpha v_{y, \alpha} - \rho_\alpha v_{y, \alpha} v_{x, \alpha} + B_{y, \alpha} B_x \\
&amp;\Longrightarrow \ 
(S_\alpha - S_M) \underbrace{\rho_\alpha^\ast}_{(12)} v_{y, \alpha}^\ast + \frac{S_\alpha - v_{x, \alpha}}{S_\alpha - S_M} B_{y, \alpha} B_x + \frac{v_{y, \alpha} - v_{y, \alpha}^\ast}{S_\alpha - S_M} B_x^2 
= (S_\alpha - v_{x, \alpha}) \rho_\alpha v_{y, \alpha} + B_{y, \alpha} B_x \\
&amp;\Longrightarrow \ 
(S_\alpha - v_{x, \alpha}) \rho_\alpha v_{x, \alpha}^\ast 
= (S_\alpha - v_{x, \alpha}) \rho_\alpha v_{y, \alpha} + \frac{v_{x, \alpha} - S_M}{S_\alpha - S_M} B_{y, \alpha} B_x - \frac{B_x^2}{S_\alpha - S_M} v_{y, \alpha} + \frac{B_x^2}{S_\alpha - S_M} v_{y, \alpha}^\ast \\
&amp;\Longrightarrow \ 
\frac{(S_\alpha - v_{x, \alpha}) (S_\alpha - S_M) \rho_\alpha - B_x^2}{S_\alpha - S_M} v_{y, \alpha}^\ast 
= \frac{(S_\alpha - v_{x, \alpha}) (S_\alpha - S_M) \rho_\alpha - B_x^2}{S_\alpha - S_M} v_{y, \alpha} + \frac{v_{x, \alpha} - S_M}{S_\alpha - S_M} B_{y, \alpha} B_x
\end{aligned}\]

<p>ä»¥ä¸Šã‚ˆã‚Š</p>

\[v_{y, \alpha}^\ast 
= v_{y, \alpha} - \frac{S_M - v_{x, \alpha}}{(S_\alpha - v_{x, \alpha}) (S_\alpha - S_M) \rho_\alpha - B_x^2} B_{y, \alpha} B_x \tag{14}\]

<p>ã‚’å¾—ã¾ã™ã€‚(14)å¼ã‚’å…ˆç¨‹ã®ç¬¬å…­å¼ã®é–¢ä¿‚ã«ç”¨ã„ã‚‹ã¨</p>

\[\begin{align}
&amp;(S_\alpha - S_M) B_{y, \alpha}^\ast + B_x v_{y, \alpha} - \frac{S_M - v_{x, \alpha}}{(S_\alpha - v_{x, \alpha}) (S_\alpha - S_M) \rho_\alpha - B_x^2} B_{y, \alpha} B_x^2 
= (S_\alpha - v_{x, \alpha}) B_{y, \alpha} + v_{y, \alpha} B_x \notag \\
&amp;\Longrightarrow \ 
(S_\alpha - S_M) B_{y, \alpha}^\ast 
= \frac{B_{y, \alpha} B_x^2 (S_M - v_{x, \alpha}) + (S_\alpha - v_{x, \alpha}) B_{y, \alpha} \{ (S_\alpha - v_{x, \alpha}) (S_\alpha - S_M) \rho_\alpha - B_x^2\}}{(S_\alpha - v_{x, \alpha}) (S_\alpha - S_M) \rho_\alpha - B_x^2} \notag \\
&amp; \qquad \qquad \qquad = B_{y, \alpha} \frac{(S_\alpha - v_{x, \alpha})^2 (S_\alpha - S_M) \rho_\alpha - B_x^2 (S_\alpha- S_M)}{(S_\alpha - v_{x, \alpha}) (S_\alpha - S_M) - B_x^2} \notag \\
&amp;\Longrightarrow \ 
B_{y, \alpha}^\ast 
= B_{y, \alpha} \frac{\rho_\alpha (S_\alpha - v_{x, \alpha})^2 - B_x^2}{\rho_\alpha (S_\alpha - v_{x, \alpha}) (S_\alpha - S_M) - B_x^2} \tag{15}
\end{align}\]

<p>åŒæ§˜ã«ç¬¬å››å¼ã¨ç¬¬ä¸ƒå¼ã‹ã‚‰\(v_{z, \alpha}^\ast, B_{z, \alpha}^\ast\)ã‚’æ±‚ã‚ã¾ã—ã‚‡ã†ã€‚åŒã˜ã‚ˆã†ã«å¼å¤‰å½¢ã™ã‚Œã°ã€(14), (15)å¼ã«ãŠã„ã¦\(v_{y, \alpha} \rightarrow v_{z, \alpha}, B_{y, \alpha} \rightarrow B_{z, \alpha}\)ã¨ã—ãŸçµæœã‚’å¾—ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚</p>

\[v_{z, \alpha}^\ast 
= v_{z, \alpha} - \frac{S_M - v_{x, \alpha}}{(S_\alpha - v_{x, \alpha}) (S_\alpha - S_M) \rho_\alpha - B_x^2} B_{y, \alpha} B_x \tag{16}\]

\[B_{z, \alpha}^\ast 
= B_{z, \alpha} \frac{\rho_\alpha (S_\alpha - v_{x, \alpha})^2 - B_x^2}{\rho_\alpha (S_\alpha - v_{x, \alpha}) (S_\alpha - S_M) - B_x^2} \tag{17}\]

<p>(14)-(17)å¼ã¯ã€\(S_M = v_{x, \alpha}, S_\alpha = v_{x, \alpha} \pm c_{f, \alpha}, B_{y, \alpha} = B_{z, \alpha} = 0, B_x^2 \geq \gamma P_\alpha\)ãªã©ã‚’æº€ãŸã™å ´åˆã«ã€\(0/0\)ã®ä¸å®šå½¢ã«ãªã‚‹å ´åˆãŒã‚ã‚Šã¾ã™ã€‚
ã“ã®ã¨ãã¯ã‚·ãƒ³ãƒ—ãƒ«ã«(12)å¼ãªã©ã‹ã‚‰\(\rho_\alpha^\ast = \rho_\alpha, v_{x, \alpha}^\ast = v_{x, \alpha}, P_{\mathrm{tot}, \alpha}^\ast = P_{\mathrm{tot}, \alpha}\)ã§ã™ã€‚
ã‚ˆã£ã¦\(v_{y, \alpha}^\ast = v_{y, \alpha}, v_{z, \alpha}^\ast = v_{z, \alpha}, B_{y, \alpha}^\ast = B_{z, \alpha}^\ast = 0\)ã¨ãªã‚Šã¾ã™ã€‚
ã“ã®ã¨ãã¯\(\rho_\alpha^\ast = \rho_\alpha\)ãªã©ã‹ã‚‰ã‚ã‹ã‚‹ã‚ˆã†ã«ã€è¡æ’ƒæ³¢ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚<br />
ç¶šã‘ã¦ã‚¨ãƒãƒ«ã‚®ãƒ¼ã‚’æ±‚ã‚ã¦ã¿ã¾ã—ã‚‡ã†ã€‚(11)å¼ã®ç¬¬äº”å¼ã‚ˆã‚Š</p>

\[\begin{align}
&amp;S_\alpha E_\alpha^\ast - (E_\alpha^\ast + P_\mathrm{tot}^\ast) S_M + (\mathbf{v}_\alpha^\ast \cdot \mathbf{B}_\alpha^\ast) B_x 
= S_\alpha E_\alpha - (E_\alpha + P_{\mathrm{tot}, \alpha}) S_M + (\mathbf{v}_\alpha \cdot \mathbf{B}_\alpha) B_x \notag \\ 
&amp;\Longrightarrow \ 
E_\alpha^\ast 
= \frac{(S_\alpha - v_{x, \alpha}) E_\alpha - P_{\mathrm{tot}, \alpha} v_{x, \alpha} + P_\mathrm{tot}^\ast S_M + B_x (\mathbf{v}_\alpha \cdot \mathbf{B}_\alpha - \mathbf{v}_\alpha^\ast \cdot \mathbf{B}_\alpha^\ast)}{S_\alpha - S_M} \tag{18}
\end{align}\]

<p>ã¨æ±‚ã¾ã‚Šã¾ã™ã€‚ã“ã‚Œã§ã‚¢ã‚¹ã‚¿ãƒªã‚¹ã‚¯ãŒä¸€ã¤ä»˜ã„ãŸç‰©ç†é‡ãŒå…¨ã¦æ±‚ã¾ã‚Šã¾ã—ãŸã€‚ç¶šã„ã¦ã‚¢ã‚¹ã‚¿ãƒªã‚¹ã‚¯ãŒ2ã¤ã®ç‰©ç†é‡ã‚’æ±‚ã‚ã¦ã„ãã¾ã—ã‚‡ã†ã€‚\(v_{x, L}^{\ast} = v_{x, L}^{\ast \ast} = v_{x, R}^{\ast \ast} = v_{x, R}^\ast = S_M\)ã®ä»®å®šã‹ã‚‰ã€\(S_L &lt; S&lt; S_M\)ã¾ãŸã¯\(S_M &lt;S&lt; S_R\)ã‚’æº€ãŸã™\(S\)ã«å¯¾ã™ã‚‹<a href="/mhd/continuity">è³ªé‡ä¿å­˜å‰‡</a>ã‹ã‚‰ã‚¸ãƒ£ãƒ³ãƒ—æ¡ä»¶ã‚’å¼å¤‰å½¢ã—</p>

\[S \rho_\alpha^{\ast \ast} - \rho_\alpha^{\ast \ast} S_M 
= S \rho_\alpha^\ast - \rho_\alpha^\ast S_M \ \Longrightarrow \ 
\rho_\alpha^{\ast \ast} = \rho_\alpha^\ast \tag{19}\]

<p>ã‚’å¾—ã¾ã™ã€‚ç¶šã„ã¦\(x\)æ–¹å‘ã®<a href="/mhd/momentum">é‹å‹•é‡ä¿å­˜å‰‡</a>ã‚ˆã‚Š</p>

\[S \rho_\alpha^{\ast \ast} S_M - \rho_\alpha^{\ast \ast} S_M S_M - P_{\mathrm{tot}, \alpha}^{\ast \ast} + B_x^2 
= S \rho_\alpha^\ast S_M - \rho_\alpha^\ast S_M S_M - P_{\mathrm{tot}, \alpha}^\ast + B_x^2 \ \Longrightarrow \ 
P_{\mathrm{tot}, \alpha}^{\ast \ast} 
= P_{\mathrm{tot}, \alpha}^\ast \tag{20}\]

<p>ã“ã“ã§ã¯ã‚ãˆã¦\(P_\mathrm{tot}^\ast\)ã‚’\(P_{\mathrm{tot}, \alpha}^\ast \ (\alpha = R, L)\)ã®ã‚ˆã†ã«æ›¸ãåˆ†ã‘ã¦ã„ã¾ã™ã€‚ã—ã‹ã—\(S_M\)ã¯æ¥è§¦ä¸é€£ç¶šé¢ã§ã‚ã‚‹ãŸã‚ã€\(P_{\mathrm{tot}, L}^{\ast \ast} = P_{\mathrm{tot}, R}^{\ast \ast}\)ãŒæˆã‚Šç«‹ã¡ã¾ã™ã€‚ã“ã®ã“ã¨ã¨(20)å¼ã‹ã‚‰ã€(7)å¼ã®ä»®å®šãŒæ­£ã—ã„ã“ã¨ãŒã‚ã‹ã‚Šã¾ã™ã€‚ <br />
(19)å¼ã‹ã‚‰ã€å·¦æ–¹å‘ãƒ»å³æ–¹å‘ã«é€²ã‚€<a href="/mhd/alfven_wave">ã‚¢ãƒ«ãƒ´ã‚§ãƒ¼ãƒ³æ³¢</a>ã®é€Ÿåº¦ã¨ã—ã¦</p>

\[S_L^\ast 
= S_M - \frac{\vert B_x \vert}{\sqrt{\rho_L^\ast}}, \quad S_R^\ast 
= S_M + \frac{\vert B_x \vert}{\sqrt{\rho_R^\ast}} \tag{21}\]

<p>ãŒé©åˆ‡ã§ã‚ã‚‹ã“ã¨ãŒã‚ã‹ã‚Šã¾ã™ã€‚ãã‚Œã§ã¯ã€ã“ã®\(S_\alpha^\ast \ (\alpha = L, R)\)ã®æ³¢é¢ã§ã®ã‚¸ãƒ£ãƒ³ãƒ—æ¡ä»¶ã‚’è€ƒãˆã¾ã—ã‚‡ã†ã€‚</p>

\[S_\alpha^\ast \left( \begin{array}{c}
\rho_\alpha^{\ast \ast} v_{y, \alpha}^{\ast \ast} \\
\rho_\alpha^{\ast \ast} v_{z, \alpha}^{\ast \ast} \\
B_{y, \alpha}^{\ast \ast} \\
B_{z, \alpha}^{\ast \ast}  
\end{array}\right) - \left( \begin{array}{c}
\rho_\alpha^{\ast \ast} v_{y, \alpha}^{\ast \ast} S_M - B_{y, \alpha}^{\ast \ast} B_x \\
\rho_\alpha^{\ast \ast} v_{z, \alpha}^{\ast \ast} S_M - B_{z, \alpha}^{\ast \ast} B_x \\
B_{y, \alpha}^{\ast \ast} S_M - v_{y, \alpha}^{\ast \ast} B_x \\
B_{z, \alpha}^{\ast \ast} S_M - v_{z, \alpha}^{\ast \ast} B_x 
\end{array}\right) 
= S_\alpha^\ast \left( \begin{array}{c}
\rho_\alpha^{\ast} v_{y, \alpha}^{\ast} \\
\rho_\alpha^{\ast} v_{z, \alpha}^{\ast} \\
B_{y, \alpha}^{\ast} \\
B_{z, \alpha}^{\ast}  
\end{array}\right) - \left( \begin{array}{c}
\rho_\alpha^{\ast} v_{y, \alpha}^{\ast} S_M - B_{y, \alpha}^{\ast} B_x \\
\rho_\alpha^{\ast} v_{z, \alpha}^{\ast} S_M - B_{z, \alpha}^{\ast} B_x \\
B_{y, \alpha}^{\ast} S_M - v_{y, \alpha}^{\ast} B_x \\
B_{z, \alpha}^{\ast} S_M - v_{z, \alpha}^{\ast} B_x 
\end{array}\right) \tag{22}\]

<p>åŒæ§˜ã«\(S_M\)ã§ã®ã‚¸ãƒ£ãƒ³ãƒ—æ¡ä»¶ã‚’è€ƒãˆã¾ã™ã€‚</p>

\[S_M \left( \begin{array}{c}
\rho_L^{\ast \ast} v_{y, L}^{\ast \ast} \\
\rho_L^{\ast \ast} v_{z, L}^{\ast \ast} \\
B_{y, L}^{\ast \ast} \\
B_{z, L}^{\ast \ast}  
\end{array}\right) - \left( \begin{array}{c}
\rho_L^{\ast \ast} v_{y, L}^{\ast \ast} S_M - B_{y, L}^{\ast \ast} B_x \\
\rho_L^{\ast \ast} v_{z, L}^{\ast \ast} S_M - B_{z, L}^{\ast \ast} B_x \\
B_{y, L}^{\ast \ast} S_M - v_{y, L}^{\ast \ast} B_x \\
B_{z, L}^{\ast \ast} S_M - v_{z, L}^{\ast \ast} B_x 
\end{array}\right) 
= S_M \left( \begin{array}{c}
\rho_R^{\ast \ast} v_{y, R}^{\ast \ast} \\
\rho_R^{\ast \ast} v_{z, R}^{\ast \ast} \\
B_{y, R}^{\ast \ast} \\
B_{z, R}^{\ast \ast} 
\end{array}\right) - \left( \begin{array}{c}
\rho_R^{\ast \ast} v_{y, R}^{\ast \ast} S_M - B_{y, R}^{\ast \ast} B_x \\
\rho_R^{\ast \ast} v_{z, R}^{\ast \ast} S_M - B_{z, R}^{\ast \ast} B_x \\
B_{y, R}^{\ast \ast} S_M - v_{y, R}^{\ast \ast} B_x \\
B_{z, R}^{\ast \ast} S_M - v_{z, R}^{\ast \ast} B_x 
\end{array}\right) \tag{23}\]

<p>(23)å¼ã‚ˆã‚Š</p>

\[v_{y, L}^{\ast \ast} = v_{y, R}^{\ast \ast} = v_y^{\ast \ast}, \quad
v_{z, L}^{\ast \ast} = v_{z, R}^{\ast \ast} = v_z^{\ast \ast} \tag{24}\]

\[B_{y, L}^{\ast \ast} = B_{y, R}^{\ast \ast} = B_y^{\ast \ast}, \quad
B_{z, L}^{\ast \ast} = B_{z, R}^{\ast \ast} = B_z^{\ast \ast} \tag{25}\]

<p>ãŸã ã—ã€ã“ã‚Œã¯\(B_x \neq 0\)ã®å ´åˆã§ã™ã€‚ã‚‚ã—\(B_x = 0\)ã®å ´åˆã¯ã€ä¾‹ãˆã°(23)å¼ã®ç¬¬ä¸€å¼ã‚ˆã‚Š</p>

\[S_M \rho_L^{\ast \ast} v_{y, L}^{\ast \ast} - \rho_L^{\ast \ast} v_{y, L}^{\ast \ast} S_M 
= S_M \rho_R^{\ast \ast} v_{y, R}^{\ast \ast} - \rho_R^{\ast \ast} v_{y, R}^{\ast \ast} S_M \ \Longrightarrow \
0 = 0 \tag{*}\]

<p>ã®ã‚ˆã†ã«ãªã‚Šã€æ±‚ã‚ã‚‹ã“ã¨ãŒã§ãã¾ã›ã‚“(ã“ã‚Œã«é–¢ã—ã¦ã¯å¾Œã§è©³ç´°ã‚’è¿°ã¹ã¾ã™)ã€‚<br />
æ¬¡ã«ã€(24), (25)å¼ã§å‡ºã¦ããŸ\(v_y^{\ast \ast}, v_z^{\ast \ast}, B_y^{\ast \ast}, B_z^{\ast \ast}\)ã‚’æ±‚ã‚ã¾ã—ã‚‡ã†ã€‚
ãã®ãŸã‚ã«ã€ä»¥ä¸‹ã®ã‚ˆã†ã«ãƒªãƒ¼ãƒãƒ³ãƒ•ã‚¡ãƒ³ã®å‘¨å›²ã‚’å‘¨å›ç©åˆ†ã‚’è¡Œã„ã¾ã™ã€‚</p>

<p><img src="/assets/images/simulation/hlld_02.png" alt="" /></p>

<p>ã™ã‚‹ã¨ã€ä»¥ä¸‹ã®ä¿å­˜å‰‡ã‚’å¾—ã¾ã™ã€‚</p>

\[S_R \Delta t \mathbf{U}_R - \mathbf{F}_R \Delta t  - (S_R - S_R^\ast) \Delta t \mathbf{U}_R^\ast - (S_R^\ast - S_M) \Delta t \mathbf{U}_R^{\ast \ast} - (S_M - S_L^\ast) \Delta t \mathbf{U}_L^{\ast \ast} - (S_L^\ast - S_L) \Delta t \mathbf{U}_L^\ast + \mathbf{F}_L \Delta t - S_L \Delta t \mathbf{U}_L = \mathbf{0}\]

<p>ã“ã®å¼ã¨ã€\(S_R, S_L\)ã§ã®ä¿å­˜å‰‡</p>

\[S_R \mathbf{U}_R - \mathbf{F}_R 
= S_R \mathbf{U}_R^\ast - \mathbf{F}_R^\ast, \quad S_L \mathbf{U}_L - \mathbf{F}_L 
= S_L \mathbf{U}_L^\ast - \mathbf{F}_L^\ast\]

<p>ã‚ˆã‚Š</p>

\[\begin{align}
&amp;- \mathbf{F}_R^\ast + S_R^\ast \mathbf{U}_R^\ast - S_R^\ast \mathbf{U}_R^{\ast \ast} + S_M \mathbf{U}_R^{\ast \ast}- S_M \mathbf{U}_L^{\ast \ast} +S_L^\ast \mathbf{U}_L^{\ast \ast} - S_L^\ast \mathbf{U}_L^\ast + \mathbf{F}_L 
= \mathbf{0} \notag \\
&amp;\Longrightarrow \ 
\underbrace{(S_M - S_R^\ast)}_{(21)} \mathbf{U}_R^{\ast \ast} + \underbrace{(S_L^\ast - S_M)}_{(21)} \mathbf{U}_L^{\ast \ast} - \mathbf{F}_R^{\ast} + \underbrace{S_R^\ast}_{(21)} \mathbf{U}_R^\ast - \underbrace{S_L^\ast}_{(21)} \mathbf{U}_L^\ast + \mathbf{F}_L^\ast 
= \mathbf{0} \notag \\ 
&amp;\Longrightarrow \ 
- \frac{\vert B_x \vert}{\sqrt{\rho_R^\ast}} \mathbf{U}_R^{\ast \ast} - \frac{\vert B_x \vert}{\sqrt{\rho_L^\ast}} \mathbf{U}_L^{\ast \ast} - \mathbf{F}_R^\ast 
+ \left( S_M + \frac{\vert B_x \vert}{\sqrt{\rho_R^\ast}}\right) \mathbf{U}_R^\ast - \left( S_M - \frac{\vert B_x \vert}{\sqrt{\rho_L^\ast}}\right) \mathbf{U}_L^\ast + \mathbf{F}_L^\ast 
= \mathbf{0} \tag{26}
\end{align}\]

<p>ã“ã“ã«\(y\)æ–¹å‘ã®é‹å‹•é‡ä¿å­˜å‰‡ã‚’é©ç”¨ã—ã¾ã™ã€‚\(U = \rho v_y, F = \rho v_y v_x - B_y B_x\)ã‚ˆã‚Š</p>

\[\begin{aligned}
&amp;- \frac{\vert B_x \vert}{\sqrt{\rho_R^\ast}} \rho_R^{\ast \ast} v_{y}^{\ast \ast} - \frac{\vert B_x \vert}{\sqrt{\rho_L^\ast}} \rho_L^{\ast \ast} v_y^{\ast \ast} - (\rho_R^\ast v_{y, R}^\ast S_M - B_{y, R}^\ast B_x) + \left( S_M + \frac{\vert B_x \vert}{\sqrt{\rho_R^\ast}}\right) \rho_R^\ast v_{y, R}^\ast - \left( S_M - \frac{\vert B_x \vert}{\sqrt{\rho_L^\ast}}\right) \rho_L^\ast v_{y, L}^\ast + (\rho_L^\ast v_{y, L}^\ast S_M - B_{y, L}^\ast B_x) = 0 \\
&amp;\Longrightarrow \
- \vert B_x \vert (\sqrt{\rho_L^\ast} + \sqrt{\rho_R^\ast}) v_y^{\ast \ast} + B_{y, R}^\ast B_x + \vert B_x \vert \sqrt{\rho_L^\ast} v_{y, L}^\ast + \vert B_x \vert \sqrt{\rho_R^\ast} v_{y, R}^\ast - B_{y, L}^\ast B_x 
= 0
\end{aligned}\]

<p>ã“ã“ã§\(\mathrm{sign} (B_x) = B_x / \vert B_x \vert\)ã‚’ç”¨ã„ã‚‹ã¨</p>

\[v_y^{\ast \ast} = \frac{\sqrt{\rho_L^\ast} v_{y, L}^\ast + \sqrt{\rho_R^\ast} v_{y, R}^\ast + (B_{y, R}^\ast - B_{y, L}^\ast) \mathrm{sign} (B_x)}{\sqrt{\rho_L^\ast} + \sqrt{\rho_R^\ast}} \tag{27}\]

<p>ã‚’å¾—ã¾ã™ã€‚åŒæ§˜ã®å¼å¤‰å½¢ã‚’ã—ã¦ã‚‚è‰¯ã„ã§ã™ãŒã€(27)å¼ã«ãŠã„ã¦\(v_y \rightarrow v_z, B_y \rightarrow B_z\)ã¨ã™ã‚‹ã“ã¨ã§</p>

\[v_z^{\ast \ast} = \frac{\sqrt{\rho_L^\ast} v_{z, L}^\ast + \sqrt{\rho_R^\ast} v_{z, R}^\ast + (B_{z, R}^\ast - B_{z, L}^\ast) \mathrm{sign} (B_x)}{\sqrt{\rho_L^\ast} + \sqrt{\rho_R^\ast}} \tag{28}\]

<p>ã‚’å¾—ã¾ã™ã€‚<br />
ä»Šåº¦ã¯(26)å¼ã«èª˜å°æ–¹ç¨‹å¼ã®\(y\)æˆåˆ†ã‚’ç”¨ã„ã¾ã™ã€‚ã™ãªã‚ã¡\(U = B_y, F = B_y v_x - v_y B_x\)ã¨ã™ã‚‹ã¨</p>

\[\begin{align}
&amp;-\frac{\vert B_x \vert}{\sqrt{\rho_R^\ast}} B_y^{\ast \ast} - \frac{\vert B_y \vert}{\sqrt{\rho_L^\ast}} B_y^{\ast \ast} - (B_{y, R}^\ast S_M - v_{y, R}^\ast B_x) + \left( S_M + \frac{\vert B_x \vert}{\sqrt{\rho_R^\ast}}\right) B_{y, R}^\ast - \left( S_M - \frac{\vert B_x \vert}{\sqrt{\rho_L^\ast}}\right) B_{y, L}^\ast + (B_{y, L}^\ast S_M - v_{y, L}^\ast B_x) = 0 \notag \\
&amp;\Longrightarrow \ 
- \frac{\sqrt{\rho_L^\ast} + \sqrt{\rho_R^\ast}}{\sqrt{\rho_L^\ast \rho_R^\ast}} \vert B_x \vert B_y^{\ast \ast} + v_{y, R}^\ast B_x + \frac{\vert B_x \vert}{\sqrt{\rho_R^\ast}} B_{y, R}^\ast + \frac{\vert B_x \vert}{\sqrt{\rho_L^\ast}} B_{y, L}^\ast - v_{y, L}^\ast B_x = 0 \notag \\ 
&amp;\Longrightarrow \ 
B_y^{\ast \ast} 
= \frac{\sqrt{\rho_L^\ast} B_{y, R}^\ast + \sqrt{\rho_R^\ast} B_{y, L}^\ast + \sqrt{\rho_L^\ast \rho_R^\ast} (v_{y, R}^\ast - v_{y, L}^\ast) \mathrm{sign} (B_x) }{\sqrt{\rho_L^\ast} + \sqrt{\rho_R^\ast}} \tag{29}
\end{align}\]

<p>ã¨ãªã‚Šã¾ã™ã€‚åŒæ§˜ã®å¼å¤‰å½¢ã‚’ã—ã¦ã‚‚æ§‹ã„ã¾ã›ã‚“ãŒã€(29)å¼ã«ãŠã„ã¦\(v_y \rightarrow v_z, B_y \rightarrow B_z\)ã¨ã™ã‚‹ã“ã¨ã§</p>

\[B_z^{\ast \ast} 
= \frac{\sqrt{\rho_L^\ast} B_{z, R}^\ast + \sqrt{\rho_R^\ast} B_{z, L}^\ast + \sqrt{\rho_L^\ast \rho_R^\ast} (v_{z, R}^\ast - v_{z, L}^\ast) \mathrm{sign} (B_x) }{\sqrt{\rho_L^\ast} + \sqrt{\rho_R^\ast}} \tag{30}\]

<p>ã‚’å¾—ã¾ã™ã€‚<br />
æœ€å¾Œã«\(E_\alpha^{\ast \ast}\)ã‚’æ±‚ã‚ã¾ã—ã‚‡ã†ã€‚\(S_\alpha^\ast\)ã«å¯¾ã™ã‚‹ã‚¸ãƒ£ãƒ³ãƒ—æ¡ä»¶ã‚ˆã‚Š</p>

\[\begin{align}
&amp;S_\alpha^\ast E_\alpha^{\ast \ast} - (E_\alpha^{\ast \ast} + P_{\mathrm{tot}, \alpha}^{\ast \ast}) S_M + (\mathbf{v}_\alpha^{\ast \ast} \cdot \mathbf{B}_\alpha^{\ast \ast}) B_x 
= S_\alpha^\ast E_\alpha^\ast - (E_\alpha^\ast + P_{\mathrm{tot}, \alpha}^\ast) S_M + (\mathbf{v}_\alpha^\ast \cdot \mathbf{B}_\alpha^\ast) B_x \notag \\ 
&amp;\underbrace{\Longrightarrow}_{(7)} \ 
E_\alpha^{\ast \ast} 
= E_\alpha^\ast + (\mathbf{v}_\alpha^{\ast} \cdot \mathbf{B}_\alpha^{\ast} - \mathbf{v}_\alpha^{\ast \ast} \cdot \mathbf{B}_\alpha^{\ast \ast}) \frac{B_x}{\underbrace{S_\alpha^\ast - S_M}_{(21)}} 
= E_\alpha^\ast \mp \sqrt{\rho_\alpha^\ast} (\mathbf{v}_\alpha^{\ast} \cdot \mathbf{B}_\alpha^{\ast} - \mathbf{v}^{\ast \ast} \cdot \mathbf{B}^{\ast \ast}) \mathrm{sign} (B_x) \tag{31}
\end{align}\]

<p>ã¨ãªã‚Šã¾ã™ã€‚æœ€å¾Œã®è¤‡åˆã¯\(\alpha = L\)ã®ã¨ããƒã‚¤ãƒŠã‚¹ã€\(\alpha = R\)ã®ã¨ããƒ—ãƒ©ã‚¹ã¨ãªã‚Šã¾ã™ã€‚ã•ã‚‰ã«\(\mathbf{v}_\alpha^{\ast \ast} = (S_M, v_y^{\ast \ast}, v_z^{\ast \ast}), \mathbf{B}_\alpha^{\ast \ast} = (B_x, B_y^{\ast \ast}, B_z^{\ast \ast})\)ã§ã‚ã‚‹ã“ã¨ã‹ã‚‰ã€\(\mathbf{v}_L^{\ast \ast} = \mathbf{v}_R^{\ast \ast} = \mathbf{v}^{\ast \ast}, \mathbf{B}_L^{\ast \ast}= \mathbf{B}_R^{\ast \ast} = \mathbf{B}^{\ast \ast}\)ã§ã‚ã‚‹ã“ã¨ã‚’ç”¨ã„ã¾ã—ãŸã€‚
ã“ã‚Œã‚‰ã‚’ç”¨ã„ã‚Œã°ã€æ±‚ã‚ãŸã‹ã£ãŸ\(\mathbf{F}_L^{\ast \ast}, \mathbf{F}_R^{\ast \ast}\)ãŒè¨ˆç®—ã§ããŸã“ã¨ã«ãªã‚Šã¾ã™ã€‚<br />
æœ€å¾Œã«\(B_x \rightarrow 0\)ã®æ¥µé™ã«ã¤ã„ã¦è§¦ã‚Œã¦ãŠãã¾ã—ã‚‡ã†ã€‚ã“ã®ã¨ãã¯(21)å¼ã‚ˆã‚Š\(S_L^\ast = S_R^\ast = S_M\)ã§ã™ã€‚ã‚ˆã£ã¦ã“ã‚Œã¯<a href="/simulation/hllc">HLLCæ³•</a>ã®ã‚ˆã†ã«ã€ä¸­é–“çŠ¶æ…‹ã‚’2ã¤ã¨ã—ãŸã¨ãã®ã‚½ãƒ«ãƒãƒ¼ã«ä¸€è‡´ã—ã¾ã™ã€‚
ã“ã®ã“ã¨ã‹ã‚‰\(B_x =0\)ã§ã¯ã€ãã‚‚ãã‚‚\(\mathbf{U}_\alpha^{\ast \ast}, \mathbf{F}_\alpha^{\ast \ast}\)ã‚’è€ƒãˆã‚‹å¿…è¦ãŒãªãã€(*)å¼ã®å•é¡Œã¯ãã‚‚ãã‚‚å‡ºç¾ã—ãªã„ã“ã¨ãŒã‚ã‹ã‚Šã¾ã™ã€‚</p>

<script async="" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-9131160172347693" crossorigin="anonymous"></script>

<!-- for_jekyll -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-9131160172347693" data-ad-slot="3528582902" data-ad-format="auto" data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script></p>

<h2 id="æ•°å€¤è¨ˆç®—ã«ç”¨ã„ã‚‹">æ•°å€¤è¨ˆç®—ã«ç”¨ã„ã‚‹</h2>

<p><a href="/simulation/hll">HLLæ³•</a>, <a href="/simulation/hllc">HLLCæ³•</a>ã¨åŒæ§˜ã«ã€å®Ÿéš›ã®æ•°å€¤è¨ˆç®—ã§ã¯\(S_L, S_L^\ast, S_M, S_R^\ast, S_R\)ã®å¤§ãã•ã«ä¾å­˜ã—ã¦ã€ã©ã®æµæŸã‚’ç”¨ã„ã‚‹ã‹ã‚’æ±ºå®šã—ã¾ã™ã€‚
ä¸‹å›³ã¯å·¦ä¸Šã‹ã‚‰\(S_L &gt; 0, S_L \leq 0 &lt; S_L^\ast, S_L^\ast \leq 0 &lt; S_M, S_M \leq 0 &lt; S_R^\ast, S_R^\ast \leq 0 &lt; S_R, S_R \leq 0\)ã®å ´åˆã‚’å›³ç¤ºã—ãŸã‚‚ã®ã§ã™ã€‚</p>

<p><img src="/assets/images/simulation/hlld_03.png" alt="" /></p>

<p>ã‚ˆã£ã¦ã€æ•°å€¤è¨ˆç®—ã‚’è¡Œã†å ´åˆã«ã€ãã®æµæŸã®é¸æŠã¯</p>

\[\mathbf{F}_\mathrm{HLLD} 
= \left\{ \begin{array}{ll} 
\mathbf{F}_L &amp; \mathrm{if} \ S_L &gt; 0 \\
\mathbf{F}_L^\ast &amp; \mathrm{if} \ S_L \leq 0 &lt; S_L^\ast \\
\mathbf{F}_L^{\ast \ast} &amp; \mathrm{if} \ S_L^\ast \leq 0 &lt; S_M \\
\mathbf{F}_R^{\ast \ast} &amp; \mathrm{if} \ S_M \leq 0 &lt; S_R^\ast \\
\mathbf{F}_R^\ast &amp; \mathrm{if} \ S_R^\ast \leq 0 &lt; S_R \\
\mathbf{F}_R &amp; \mathrm{if} \ S_R \leq 0 
\end{array}\right. \tag{32}\]

<h2 id="hlldæµæŸã®è¨ˆç®—ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«-å·¥äº‹ä¸­">HLLDæµæŸã®è¨ˆç®—ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ« (å·¥äº‹ä¸­)</h2>

<p>ä»¥ä¸‹ã«HLLDæµæŸè¨ˆç®—ã‚³ãƒ¼ãƒ‰ã®Juliaå®Ÿè£…ä¾‹ã‚’ç¤ºã—ã¾ã™ã€‚</p>

<div class="language-julia highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">using</span> <span class="n">LinearAlgebra</span>    
<span class="n">include</span><span class="x">(</span><span class="s">"../convert/convert.jl"</span><span class="x">)</span>
<span class="n">include</span><span class="x">(</span><span class="s">"../const/const.jl"</span><span class="x">)</span>
<span class="k">function</span><span class="nf"> hlld!</span><span class="x">(</span><span class="n">F</span><span class="o">::</span><span class="kt">Array</span><span class="x">{</span><span class="kt">Float64</span><span class="x">,</span> <span class="mi">2</span><span class="x">},</span> <span class="n">Vl</span><span class="o">::</span><span class="kt">Array</span><span class="x">{</span><span class="kt">Float64</span><span class="x">,</span> <span class="mi">2</span><span class="x">},</span> <span class="n">Vr</span><span class="o">::</span><span class="kt">Array</span><span class="x">{</span><span class="kt">Float64</span><span class="x">,</span> <span class="mi">2</span><span class="x">},</span> <span class="n">nxmax</span><span class="o">::</span><span class="kt">Int64</span><span class="x">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="k">in</span> <span class="mi">1</span><span class="o">:</span><span class="n">nxmax</span><span class="o">-</span><span class="mi">1</span>
        <span class="c"># set primitive variables at left side</span>
        <span class="n">rol</span> <span class="o">=</span> <span class="n">Vl</span><span class="x">[</span><span class="mi">1</span><span class="x">,</span> <span class="n">i</span><span class="x">]</span>
        <span class="n">vnl</span> <span class="o">=</span> <span class="n">Vl</span><span class="x">[</span><span class="mi">2</span><span class="x">,</span> <span class="n">i</span><span class="x">]</span>
        <span class="n">vtl</span> <span class="o">=</span> <span class="n">Vl</span><span class="x">[</span><span class="mi">3</span><span class="x">,</span> <span class="n">i</span><span class="x">]</span>
        <span class="n">vul</span> <span class="o">=</span> <span class="n">Vl</span><span class="x">[</span><span class="mi">4</span><span class="x">,</span> <span class="n">i</span><span class="x">]</span>
        <span class="n">prl</span> <span class="o">=</span> <span class="n">Vl</span><span class="x">[</span><span class="mi">5</span><span class="x">,</span> <span class="n">i</span><span class="x">]</span>
        <span class="n">bnl</span> <span class="o">=</span> <span class="n">Vl</span><span class="x">[</span><span class="mi">6</span><span class="x">,</span> <span class="n">i</span><span class="x">]</span>
        <span class="n">btl</span> <span class="o">=</span> <span class="n">Vl</span><span class="x">[</span><span class="mi">7</span><span class="x">,</span> <span class="n">i</span><span class="x">]</span>
        <span class="n">bul</span> <span class="o">=</span> <span class="n">Vl</span><span class="x">[</span><span class="mi">8</span><span class="x">,</span> <span class="n">i</span><span class="x">]</span>
        <span class="c"># set primitive variables at right side</span>
        <span class="n">ror</span> <span class="o">=</span> <span class="n">Vr</span><span class="x">[</span><span class="mi">1</span><span class="x">,</span> <span class="n">i</span><span class="x">]</span>
        <span class="n">vnr</span> <span class="o">=</span> <span class="n">Vr</span><span class="x">[</span><span class="mi">2</span><span class="x">,</span> <span class="n">i</span><span class="x">]</span>
        <span class="n">vtr</span> <span class="o">=</span> <span class="n">Vr</span><span class="x">[</span><span class="mi">3</span><span class="x">,</span> <span class="n">i</span><span class="x">]</span>
        <span class="n">vur</span> <span class="o">=</span> <span class="n">Vr</span><span class="x">[</span><span class="mi">4</span><span class="x">,</span> <span class="n">i</span><span class="x">]</span>
        <span class="n">prr</span> <span class="o">=</span> <span class="n">Vr</span><span class="x">[</span><span class="mi">5</span><span class="x">,</span> <span class="n">i</span><span class="x">]</span>
        <span class="n">bnr</span> <span class="o">=</span> <span class="n">Vr</span><span class="x">[</span><span class="mi">6</span><span class="x">,</span> <span class="n">i</span><span class="x">]</span>
        <span class="n">btr</span> <span class="o">=</span> <span class="n">Vr</span><span class="x">[</span><span class="mi">7</span><span class="x">,</span> <span class="n">i</span><span class="x">]</span>
        <span class="n">bur</span> <span class="o">=</span> <span class="n">Vr</span><span class="x">[</span><span class="mi">8</span><span class="x">,</span> <span class="n">i</span><span class="x">]</span>
        <span class="c"># compute B * B at left side</span>
        <span class="n">bl2</span> <span class="o">=</span> <span class="n">dot</span><span class="x">(</span><span class="n">Vl</span><span class="x">[</span><span class="mi">6</span><span class="o">:</span><span class="mi">8</span><span class="x">,</span> <span class="n">i</span><span class="x">],</span> <span class="n">Vl</span><span class="x">[</span><span class="mi">6</span><span class="o">:</span><span class="mi">8</span><span class="x">,</span> <span class="n">i</span><span class="x">])</span>
        <span class="c"># compute fast-mode speed at left side</span>
        <span class="n">gmprl</span> <span class="o">=</span> <span class="n">gm</span> <span class="o">*</span> <span class="n">prl</span>
        <span class="n">vfl</span> <span class="o">=</span> <span class="n">sqrt</span><span class="x">(((</span><span class="n">bl2</span><span class="o">+</span><span class="n">gmprl</span><span class="x">)</span><span class="o">+</span><span class="n">sqrt</span><span class="x">((</span><span class="n">bl2</span><span class="o">+</span><span class="n">gmprl</span><span class="x">)</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="mi">4</span><span class="o">*</span><span class="n">gmprl</span><span class="o">*</span><span class="n">bnl</span><span class="o">^</span><span class="mi">2</span><span class="x">))</span><span class="o">/</span><span class="x">(</span><span class="mi">2</span><span class="o">*</span><span class="n">rol</span><span class="x">))</span>
        <span class="c"># compute B * B at right side</span>
        <span class="n">br2</span> <span class="o">=</span> <span class="n">dot</span><span class="x">(</span><span class="n">Vr</span><span class="x">[</span><span class="mi">6</span><span class="o">:</span><span class="mi">8</span><span class="x">,</span> <span class="n">i</span><span class="x">],</span> <span class="n">Vr</span><span class="x">[</span><span class="mi">6</span><span class="o">:</span><span class="mi">8</span><span class="x">,</span> <span class="n">i</span><span class="x">])</span>
        <span class="c"># compute fast-mode speed at right side</span>
        <span class="n">gmprr</span> <span class="o">=</span> <span class="n">gm</span> <span class="o">*</span> <span class="n">prr</span>
        <span class="n">vfr</span> <span class="o">=</span> <span class="n">sqrt</span><span class="x">(((</span><span class="n">br2</span><span class="o">+</span><span class="n">gmprr</span><span class="x">)</span><span class="o">+</span><span class="n">sqrt</span><span class="x">((</span><span class="n">br2</span><span class="o">+</span><span class="n">gmprr</span><span class="x">)</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="mi">4</span><span class="o">*</span><span class="n">gmprr</span><span class="o">*</span><span class="n">bnr</span><span class="o">^</span><span class="mi">2</span><span class="x">))</span><span class="o">/</span><span class="x">(</span><span class="mi">2</span><span class="o">*</span><span class="n">ror</span><span class="x">))</span>
        <span class="c"># compute sl, sr</span>
        <span class="n">sl</span> <span class="o">=</span> <span class="n">min</span><span class="x">(</span><span class="n">vnl</span><span class="x">,</span> <span class="n">vnr</span><span class="x">)</span> <span class="o">-</span> <span class="n">max</span><span class="x">(</span><span class="n">vfl</span><span class="x">,</span> <span class="n">vfr</span><span class="x">)</span>
        <span class="n">sr</span> <span class="o">=</span> <span class="n">max</span><span class="x">(</span><span class="n">vnl</span><span class="x">,</span> <span class="n">vnr</span><span class="x">)</span> <span class="o">+</span> <span class="n">max</span><span class="x">(</span><span class="n">vfl</span><span class="x">,</span> <span class="n">vfr</span><span class="x">)</span>
        <span class="c"># compute pt at left and right sides</span>
        <span class="n">ptl</span> <span class="o">=</span> <span class="n">prl</span> <span class="o">+</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">bl2</span>
        <span class="n">ptr</span> <span class="o">=</span> <span class="n">prr</span> <span class="o">+</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">br2</span>
        <span class="c"># compute sm (=vn) at Riemann fan</span>
        <span class="n">slvnl</span> <span class="o">=</span> <span class="n">sl</span> <span class="o">-</span> <span class="n">vnl</span>
        <span class="n">srvnr</span> <span class="o">=</span> <span class="n">sr</span> <span class="o">-</span> <span class="n">vnr</span>
        <span class="n">rolslvnl</span> <span class="o">=</span> <span class="n">rol</span> <span class="o">*</span> <span class="n">slvnl</span>
        <span class="n">rorsrvnr</span> <span class="o">=</span> <span class="n">ror</span> <span class="o">*</span> <span class="n">srvnr</span>
        <span class="n">sm</span> <span class="o">=</span> <span class="x">(</span><span class="n">rorsrvnr</span><span class="o">*</span><span class="n">vnr</span><span class="o">-</span><span class="n">rolslvnl</span><span class="o">*</span><span class="n">vnl</span><span class="o">-</span><span class="n">ptr</span><span class="o">+</span><span class="n">ptl</span><span class="x">)</span> <span class="o">/</span> <span class="x">(</span><span class="n">rorsrvnr</span><span class="o">-</span><span class="n">rolslvnl</span><span class="x">)</span>
        <span class="c"># compute pt at riemann fan</span>
        <span class="n">pti</span> <span class="o">=</span> <span class="x">(</span><span class="n">rorsrvnr</span><span class="o">*</span><span class="n">ptl</span><span class="o">-</span><span class="n">rolslvnl</span><span class="o">*</span><span class="n">ptr</span><span class="o">+</span><span class="n">rolslvnl</span><span class="o">*</span><span class="n">rorsrvnr</span><span class="o">*</span><span class="x">(</span><span class="n">vnr</span><span class="o">-</span><span class="n">vnl</span><span class="x">))</span> <span class="o">/</span> <span class="x">(</span><span class="n">rorsrvnr</span><span class="o">-</span><span class="n">rolslvnl</span><span class="x">)</span>
        <span class="c"># compute ro at outer sides in Riemann fan</span>
        <span class="n">slsm</span> <span class="o">=</span> <span class="n">sl</span> <span class="o">-</span> <span class="n">sm</span>
        <span class="n">roil</span> <span class="o">=</span> <span class="n">rol</span> <span class="o">*</span> <span class="n">slvnl</span> <span class="o">/</span> <span class="n">slsm</span>
        <span class="n">srsm</span> <span class="o">=</span> <span class="n">sr</span> <span class="o">-</span> <span class="n">sm</span>
        <span class="n">roir</span> <span class="o">=</span> <span class="n">ror</span> <span class="o">*</span> <span class="n">srvnr</span> <span class="o">/</span> <span class="n">srsm</span>
        <span class="c"># compute vy, vz, by, bz at left outer side in Riemann fan</span>
        <span class="n">smvnl</span> <span class="o">=</span> <span class="n">sm</span> <span class="o">-</span> <span class="n">vnl</span>
        <span class="k">if</span> <span class="n">abs</span><span class="x">(</span><span class="n">slvnl</span><span class="o">*</span><span class="n">slsm</span><span class="o">*</span><span class="n">rol</span><span class="o">-</span><span class="n">bnl</span><span class="o">^</span><span class="mi">2</span><span class="x">)</span> <span class="o">&gt;</span> <span class="mf">1.0e-10</span>
            <span class="n">denol</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="x">(</span><span class="n">slvnl</span><span class="o">*</span><span class="n">slsm</span><span class="o">*</span><span class="n">rol</span><span class="o">-</span><span class="n">bnl</span><span class="o">^</span><span class="mi">2</span><span class="x">)</span>
            <span class="n">vtil</span> <span class="o">=</span> <span class="n">vtl</span> <span class="o">-</span> <span class="n">btl</span> <span class="o">*</span> <span class="n">bnl</span> <span class="o">*</span> <span class="n">smvnl</span> <span class="o">*</span> <span class="n">denol</span>
            <span class="n">vuil</span> <span class="o">=</span> <span class="n">vul</span> <span class="o">-</span> <span class="n">bul</span> <span class="o">*</span> <span class="n">bnl</span> <span class="o">*</span> <span class="n">smvnl</span> <span class="o">*</span> <span class="n">denol</span>
            <span class="n">btil</span> <span class="o">=</span> <span class="n">btl</span> <span class="o">*</span> <span class="x">(</span><span class="n">rol</span><span class="o">*</span><span class="n">slvnl</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="n">bnl</span><span class="o">^</span><span class="mi">2</span><span class="x">)</span> <span class="o">*</span> <span class="n">denol</span>
            <span class="n">buil</span> <span class="o">=</span> <span class="n">bul</span> <span class="o">*</span> <span class="x">(</span><span class="n">rol</span><span class="o">*</span><span class="n">slvnl</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="n">bnl</span><span class="o">^</span><span class="mi">2</span><span class="x">)</span> <span class="o">*</span> <span class="n">denol</span>
        <span class="k">else</span>
            <span class="c"># if denominator == 0, substitute with vy, vz, by, bz at left state </span>
            <span class="n">vtil</span> <span class="o">=</span> <span class="n">vtl</span>
            <span class="n">vuil</span> <span class="o">=</span> <span class="n">vul</span>
            <span class="n">btil</span> <span class="o">=</span> <span class="n">btl</span>
            <span class="n">buil</span> <span class="o">=</span> <span class="n">bul</span>
        <span class="k">end</span>
        <span class="c"># compute vy, vz, by, bz at right outer side in Riemann fan</span>
        <span class="n">smvnr</span> <span class="o">=</span> <span class="n">sm</span> <span class="o">-</span> <span class="n">vnr</span>
        <span class="k">if</span> <span class="n">abs</span><span class="x">(</span><span class="n">srvnr</span><span class="o">*</span><span class="n">srsm</span><span class="o">*</span><span class="n">ror</span><span class="o">-</span><span class="n">bnr</span><span class="o">^</span><span class="mi">2</span><span class="x">)</span> <span class="o">&gt;</span> <span class="mf">1.0e-10</span>
            <span class="n">denor</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="x">(</span><span class="n">srvnr</span><span class="o">*</span><span class="n">srsm</span><span class="o">*</span><span class="n">ror</span><span class="o">-</span><span class="n">bnr</span><span class="o">^</span><span class="mi">2</span><span class="x">)</span>
            <span class="n">vtir</span> <span class="o">=</span> <span class="n">vtr</span> <span class="o">-</span> <span class="n">btr</span> <span class="o">*</span> <span class="n">bnr</span> <span class="o">*</span> <span class="n">smvnr</span> <span class="o">*</span> <span class="n">denor</span>
            <span class="n">vuir</span> <span class="o">=</span> <span class="n">vur</span> <span class="o">-</span> <span class="n">bur</span> <span class="o">*</span> <span class="n">bnr</span> <span class="o">*</span> <span class="n">smvnr</span> <span class="o">*</span> <span class="n">denor</span>
            <span class="n">btir</span> <span class="o">=</span> <span class="n">btr</span> <span class="o">*</span> <span class="x">(</span><span class="n">ror</span><span class="o">*</span><span class="n">srvnr</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="n">bnr</span><span class="o">^</span><span class="mi">2</span><span class="x">)</span> <span class="o">*</span> <span class="n">denor</span>
            <span class="n">buir</span> <span class="o">=</span> <span class="n">bur</span> <span class="o">*</span> <span class="x">(</span><span class="n">ror</span><span class="o">*</span><span class="n">srvnr</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="n">bnr</span><span class="o">^</span><span class="mi">2</span><span class="x">)</span> <span class="o">*</span> <span class="n">denor</span>    
        <span class="k">else</span>
            <span class="c"># if denominator == 0, substitute with vy, vz, by, bz at right state</span>
            <span class="n">vtir</span> <span class="o">=</span> <span class="n">vtr</span>
            <span class="n">vuir</span> <span class="o">=</span> <span class="n">vur</span>
            <span class="n">btir</span> <span class="o">=</span> <span class="n">btr</span>
            <span class="n">buir</span> <span class="o">=</span> <span class="n">bur</span>
        <span class="k">end</span>
        <span class="c"># compute en at left state</span>
        <span class="n">vl2</span> <span class="o">=</span> <span class="n">dot</span><span class="x">(</span><span class="n">Vl</span><span class="x">[</span><span class="mi">2</span><span class="o">:</span><span class="mi">4</span><span class="x">,</span> <span class="n">i</span><span class="x">],</span> <span class="n">Vl</span><span class="x">[</span><span class="mi">2</span><span class="o">:</span><span class="mi">4</span><span class="x">,</span> <span class="n">i</span><span class="x">])</span>
        <span class="n">enl</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="x">(</span><span class="n">rol</span><span class="o">*</span><span class="n">vl2</span><span class="o">+</span><span class="n">bl2</span><span class="x">)</span> <span class="o">+</span> <span class="n">prl</span> <span class="o">*</span> <span class="n">gm1i</span>
        <span class="c"># compute en at right state</span>
        <span class="n">vr2</span> <span class="o">=</span> <span class="n">dot</span><span class="x">(</span><span class="n">Vr</span><span class="x">[</span><span class="mi">2</span><span class="o">:</span><span class="mi">4</span><span class="x">,</span> <span class="n">i</span><span class="x">],</span> <span class="n">Vr</span><span class="x">[</span><span class="mi">2</span><span class="o">:</span><span class="mi">4</span><span class="x">,</span> <span class="n">i</span><span class="x">])</span>
        <span class="n">enr</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="x">(</span><span class="n">ror</span><span class="o">*</span><span class="n">vr2</span><span class="o">+</span><span class="n">br2</span><span class="x">)</span> <span class="o">+</span> <span class="n">prr</span> <span class="o">*</span> <span class="n">gm1i</span>
        <span class="c"># compute en at left outer side in Riemann fan</span>
        <span class="n">vlbl</span> <span class="o">=</span> <span class="n">dot</span><span class="x">(</span><span class="n">Vl</span><span class="x">[</span><span class="mi">2</span><span class="o">:</span><span class="mi">4</span><span class="x">,</span> <span class="n">i</span><span class="x">],</span> <span class="n">Vl</span><span class="x">[</span><span class="mi">6</span><span class="o">:</span><span class="mi">8</span><span class="x">,</span> <span class="n">i</span><span class="x">])</span>
        <span class="n">vilbil</span> <span class="o">=</span> <span class="n">dot</span><span class="x">([</span><span class="n">sm</span><span class="x">,</span> <span class="n">vtil</span><span class="x">,</span> <span class="n">vuil</span><span class="x">],</span> <span class="x">[</span><span class="n">bnl</span><span class="x">,</span> <span class="n">btil</span><span class="x">,</span> <span class="n">buil</span><span class="x">])</span>
        <span class="n">enil</span> <span class="o">=</span> <span class="x">(</span><span class="n">slvnl</span><span class="o">*</span><span class="n">enl</span><span class="o">-</span><span class="n">ptl</span><span class="o">*</span><span class="n">vnl</span><span class="o">+</span><span class="n">pti</span><span class="o">*</span><span class="n">sm</span><span class="o">+</span><span class="n">bnl</span><span class="o">*</span><span class="x">(</span><span class="n">vlbl</span><span class="o">-</span><span class="n">vilbil</span><span class="x">))</span> <span class="o">/</span> <span class="n">slsm</span>
        <span class="c"># compute en at right outer side in Riemann fan</span>
        <span class="n">vrbr</span> <span class="o">=</span> <span class="n">dot</span><span class="x">(</span><span class="n">Vr</span><span class="x">[</span><span class="mi">2</span><span class="o">:</span><span class="mi">4</span><span class="x">,</span> <span class="n">i</span><span class="x">],</span> <span class="n">Vr</span><span class="x">[</span><span class="mi">6</span><span class="o">:</span><span class="mi">8</span><span class="x">,</span> <span class="n">i</span><span class="x">])</span>
        <span class="n">virbir</span> <span class="o">=</span> <span class="n">dot</span><span class="x">([</span><span class="n">sm</span><span class="x">,</span> <span class="n">vtir</span><span class="x">,</span> <span class="n">vuir</span><span class="x">],</span> <span class="x">[</span><span class="n">bnr</span><span class="x">,</span> <span class="n">btir</span><span class="x">,</span> <span class="n">buir</span><span class="x">])</span>            
        <span class="n">enir</span> <span class="o">=</span> <span class="x">(</span><span class="n">srvnr</span><span class="o">*</span><span class="n">enr</span><span class="o">-</span><span class="n">ptr</span><span class="o">*</span><span class="n">vnr</span><span class="o">+</span><span class="n">pti</span><span class="o">*</span><span class="n">sm</span><span class="o">+</span><span class="n">bnr</span><span class="o">*</span><span class="x">(</span><span class="n">vrbr</span><span class="o">-</span><span class="n">virbir</span><span class="x">))</span> <span class="o">/</span> <span class="n">srsm</span>
        <span class="c"># compute ro at inner side in Riemann fan</span>
        <span class="n">roiil</span> <span class="o">=</span> <span class="n">roil</span>
        <span class="n">roiir</span> <span class="o">=</span> <span class="n">roir</span>
        <span class="c"># compute vy, vz, by, bz at inner side in Riemann fan</span>
        <span class="n">rtroil</span> <span class="o">=</span> <span class="n">sqrt</span><span class="x">(</span><span class="n">roil</span><span class="x">)</span>
        <span class="n">rtroir</span> <span class="o">=</span> <span class="n">sqrt</span><span class="x">(</span><span class="n">roir</span><span class="x">)</span>
        <span class="n">denoii</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="x">(</span><span class="n">rtroil</span><span class="o">+</span><span class="n">rtroir</span><span class="x">)</span>
        <span class="n">signbn</span> <span class="o">=</span> <span class="n">sign</span><span class="x">(</span><span class="n">bnl</span><span class="x">)</span>
        <span class="n">vtii</span> <span class="o">=</span> <span class="x">(</span><span class="n">rtroil</span><span class="o">*</span><span class="n">vtil</span><span class="o">+</span><span class="n">rtroir</span><span class="o">*</span><span class="n">vtir</span><span class="o">+</span><span class="x">(</span><span class="n">btir</span><span class="o">-</span><span class="n">btil</span><span class="x">)</span><span class="o">*</span><span class="n">signbn</span><span class="x">)</span> <span class="o">*</span> <span class="n">denoii</span>
        <span class="n">vuii</span> <span class="o">=</span> <span class="x">(</span><span class="n">rtroil</span><span class="o">*</span><span class="n">vuil</span><span class="o">+</span><span class="n">rtroir</span><span class="o">*</span><span class="n">vuir</span><span class="o">+</span><span class="x">(</span><span class="n">buir</span><span class="o">-</span><span class="n">buil</span><span class="x">)</span><span class="o">*</span><span class="n">signbn</span><span class="x">)</span> <span class="o">*</span> <span class="n">denoii</span>
        <span class="n">btii</span> <span class="o">=</span> <span class="x">(</span><span class="n">rtroil</span><span class="o">*</span><span class="n">btir</span><span class="o">+</span><span class="n">rtroir</span><span class="o">*</span><span class="n">btil</span><span class="o">+</span><span class="n">rtroil</span><span class="o">*</span><span class="n">rtroir</span><span class="o">*</span><span class="x">(</span><span class="n">vtir</span><span class="o">-</span><span class="n">vtil</span><span class="x">)</span><span class="o">*</span><span class="n">signbn</span><span class="x">)</span> <span class="o">*</span> <span class="n">denoii</span>
        <span class="n">buii</span> <span class="o">=</span> <span class="x">(</span><span class="n">rtroil</span><span class="o">*</span><span class="n">buir</span><span class="o">+</span><span class="n">rtroir</span><span class="o">*</span><span class="n">buil</span><span class="o">+</span><span class="n">rtroil</span><span class="o">*</span><span class="n">rtroir</span><span class="o">*</span><span class="x">(</span><span class="n">vuir</span><span class="o">-</span><span class="n">vuil</span><span class="x">)</span><span class="o">*</span><span class="n">signbn</span><span class="x">)</span> <span class="o">*</span> <span class="n">denoii</span>
        <span class="c"># compute en at left &amp; right inner side in Riemann fan</span>
        <span class="n">viibii</span> <span class="o">=</span> <span class="n">dot</span><span class="x">([</span><span class="n">sm</span><span class="x">,</span> <span class="n">vtii</span><span class="x">,</span> <span class="n">vuii</span><span class="x">],</span> <span class="x">[</span><span class="n">bnl</span><span class="x">,</span> <span class="n">btii</span><span class="x">,</span> <span class="n">buii</span><span class="x">])</span>
        <span class="n">eniil</span> <span class="o">=</span> <span class="n">enil</span> <span class="o">-</span> <span class="n">rtroil</span> <span class="o">*</span> <span class="x">(</span><span class="n">vilbil</span><span class="o">-</span><span class="n">viibii</span><span class="x">)</span> <span class="o">*</span> <span class="n">signbn</span>
        <span class="n">eniir</span> <span class="o">=</span> <span class="n">enir</span> <span class="o">+</span> <span class="n">rtroir</span> <span class="o">*</span> <span class="x">(</span><span class="n">virbir</span><span class="o">-</span><span class="n">viibii</span><span class="x">)</span> <span class="o">*</span> <span class="n">signbn</span>
        <span class="c"># choose flux</span>
        <span class="k">if</span> <span class="n">sl</span> <span class="o">&gt;</span> <span class="mf">0.0</span>
            <span class="n">result</span> <span class="o">=</span> <span class="x">[</span><span class="n">rol</span><span class="x">,</span> <span class="n">vnl</span><span class="x">,</span> <span class="n">vtl</span><span class="x">,</span> <span class="n">vul</span><span class="x">,</span> <span class="n">ptl</span><span class="x">,</span> <span class="n">enl</span><span class="x">,</span> <span class="n">bnl</span><span class="x">,</span> <span class="n">btl</span><span class="x">,</span> <span class="n">bul</span><span class="x">,</span> <span class="n">vlbl</span><span class="x">]</span>
        <span class="k">elseif</span> <span class="n">sl</span> <span class="o">&lt;=</span> <span class="mf">0.0</span> <span class="o">&lt;</span> <span class="n">sm</span> <span class="o">-</span> <span class="n">abs</span><span class="x">(</span><span class="n">bnl</span><span class="x">)</span> <span class="o">/</span> <span class="n">rtroil</span>
            <span class="n">result</span> <span class="o">=</span> <span class="x">[</span><span class="n">roil</span><span class="x">,</span> <span class="n">sm</span><span class="x">,</span> <span class="n">vtil</span><span class="x">,</span> <span class="n">vuil</span><span class="x">,</span> <span class="n">pti</span><span class="x">,</span> <span class="n">enil</span><span class="x">,</span> <span class="n">bnl</span><span class="x">,</span> <span class="n">btil</span><span class="x">,</span> <span class="n">buil</span><span class="x">,</span> <span class="n">vilbil</span><span class="x">]</span>
        <span class="k">elseif</span> <span class="n">sm</span> <span class="o">-</span> <span class="n">abs</span><span class="x">(</span><span class="n">bnl</span><span class="x">)</span> <span class="o">/</span> <span class="n">rtroil</span> <span class="o">&lt;=</span> <span class="mf">0.0</span> <span class="o">&lt;</span> <span class="n">sm</span>
            <span class="n">result</span> <span class="o">=</span> <span class="x">[</span><span class="n">roiil</span><span class="x">,</span> <span class="n">sm</span><span class="x">,</span> <span class="n">vtii</span><span class="x">,</span> <span class="n">vuii</span><span class="x">,</span> <span class="n">pti</span><span class="x">,</span> <span class="n">eniil</span><span class="x">,</span> <span class="n">bnl</span><span class="x">,</span> <span class="n">btii</span><span class="x">,</span> <span class="n">buii</span><span class="x">,</span> <span class="n">viibii</span><span class="x">]</span>
        <span class="k">elseif</span> <span class="n">sm</span> <span class="o">&lt;=</span> <span class="mf">0.0</span> <span class="o">&lt;</span> <span class="n">sm</span> <span class="o">+</span> <span class="n">abs</span><span class="x">(</span><span class="n">bnl</span><span class="x">)</span> <span class="o">/</span> <span class="n">rtroir</span>
            <span class="n">result</span> <span class="o">=</span> <span class="x">[</span><span class="n">roiir</span><span class="x">,</span> <span class="n">sm</span><span class="x">,</span> <span class="n">vtii</span><span class="x">,</span> <span class="n">vuii</span><span class="x">,</span> <span class="n">pti</span><span class="x">,</span> <span class="n">eniir</span><span class="x">,</span> <span class="n">bnr</span><span class="x">,</span> <span class="n">btii</span><span class="x">,</span> <span class="n">buii</span><span class="x">,</span> <span class="n">viibii</span><span class="x">]</span>
        <span class="k">elseif</span> <span class="n">sm</span> <span class="o">+</span> <span class="n">abs</span><span class="x">(</span><span class="n">bnl</span><span class="x">)</span> <span class="o">/</span> <span class="n">rtroir</span> <span class="o">&lt;=</span> <span class="mf">0.0</span> <span class="o">&lt;</span> <span class="n">sr</span>
            <span class="n">result</span> <span class="o">=</span> <span class="x">[</span><span class="n">roir</span><span class="x">,</span> <span class="n">sm</span><span class="x">,</span> <span class="n">vtir</span><span class="x">,</span> <span class="n">vuir</span><span class="x">,</span> <span class="n">pti</span><span class="x">,</span> <span class="n">enir</span><span class="x">,</span> <span class="n">bnr</span><span class="x">,</span> <span class="n">btir</span><span class="x">,</span> <span class="n">buir</span><span class="x">,</span> <span class="n">virbir</span><span class="x">]</span>
        <span class="k">else</span>
            <span class="n">result</span> <span class="o">=</span> <span class="x">[</span><span class="n">ror</span><span class="x">,</span> <span class="n">vnr</span><span class="x">,</span> <span class="n">vtr</span><span class="x">,</span> <span class="n">vur</span><span class="x">,</span> <span class="n">ptr</span><span class="x">,</span> <span class="n">enr</span><span class="x">,</span> <span class="n">bnr</span><span class="x">,</span> <span class="n">btr</span><span class="x">,</span> <span class="n">bur</span><span class="x">,</span> <span class="n">vrbr</span><span class="x">]</span>
        <span class="k">end</span>
        <span class="c"># convert flux and input to F</span>
        <span class="n">F</span><span class="x">[</span><span class="o">:</span><span class="x">,</span> <span class="n">i</span><span class="x">]</span> <span class="o">=</span> <span class="n">Convert</span><span class="o">.</span><span class="n">i_to_f</span><span class="x">(</span><span class="n">result</span><span class="o">...</span><span class="x">)</span>
    <span class="k">end</span>
<span class="k">end</span>
</code></pre></div></div>

<p>ãã—ã¦<a href="/simulation/hll">HLL</a>, <a href="/simulation/hllc#b_x-neq-0ã®å ´åˆgurskiã®æ‰‹æ³•">HLLC-G</a>, <a href="/simulation/hllc#b_x-neq-0ã®å ´åˆliã®æ–¹æ³•">HLLC-L</a>, HLLDã®4æ‰‹æ³•ã§ã®ã€ç£æ°—æµä½“è¡æ’ƒæ³¢ç®¡å•é¡Œã‚’è§£ã„ãŸã¨ãã®ã‚¬ã‚¹å¯†åº¦åˆ†å¸ƒã‚’æ¯”è¼ƒã—ãŸå›³ã‚’ä»¥ä¸‹ã«ç¤ºã—ã¾ã™ã€‚</p>

<p><img src="/assets/images/simulation/hlld_04.png" alt="" /></p>

<p>ã‚ã‹ã‚Šãã„ãŸã‚ã€ã•ã‚‰ã«\(0.5 \leq x \leq 0.75\)ã®é ˜åŸŸéƒ¨åˆ†ã‚’æ‹¡å¤§ã—ã¦æç”»ã—ãŸã‚‚ã®ã‚’ç¤ºã—ã¾ã™ã€‚</p>

<p><img src="/assets/images/simulation/hlld_05.png" alt="" /></p>

<p>ç´«ç·šã®HLLDæ³•ã¯ã€\(x = 0.55\)ã®ä¸é€£ç¶šé¢ã‚’ä¸€ç•ªæ­£ç¢ºã«æ‰ãˆã‚‰ã‚Œã¦ã„ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ã•ã‚‰ã«\(0.55 \leq x \leq 0.6\)ã«å­˜åœ¨ã™ã‚‹å¯†åº¦ãƒ”ãƒ¼ã‚¯ã®æœ€å¤§å€¤ã‚‚ã€HLLDæ³•ãŒä¸€ç•ªå¤§ãããªã£ã¦ã„ã¾ã™ã€‚
ã“ã®ã“ã¨ã‹ã‚‰ã‚ã‹ã‚‹ã‚ˆã†ã«ã€HLLDæ³•ã¯æ•°å€¤ç²˜æ€§ã®å½±éŸ¿ã‚’ä¸€ç•ªæŠ‘ãˆã‚‰ã‚Œã¦ã„ã‚‹ã“ã¨ãŒã‚ã‹ã‚Šã¾ã™ã€‚</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>è‰²å¼±ã®æ–¹ã«ã¯è¦‹ãˆã«ãã„é…è‰²ã‚’ã—ã¦ã„ã‚‹ã‹ã‚‚ã—ã‚Œãªã„...ç”³ã—è¨³ãªã„ã§ã™ã€‚
è¿‘ã„ã†ã¡ã«é…è‰²ã®å‹‰å¼·ã‚‚ã—ãŸã„ã‹ã‚‚ã—ã‚Œãªã„(2022å¹´8æœˆ12æ—¥ç¾åœ¨)
</code></pre></div></div>

<h1 id="å‚è€ƒæ–‡çŒ®">å‚è€ƒæ–‡çŒ®</h1>

<ul>
  <li><a href="https://www.sciencedirect.com/science/article/pii/S0021999105001142?via%3Dihub">Miyoshi &amp; Kusano, 2005, â€œA multi-state HLL approximate Riemann solver for ideal magnetohydrodynamicsâ€</a></li>
  <li><a href="https://arxiv.org/abs/astro-ph/9404074">Ryu &amp; Jones, 1994, â€œNumerical Magnetohydrodynamics in Astrophysics: Algorithm and Tests for One-Dimensional Flowâ€</a></li>
  <li><a href="https://iopscience.iop.org/article/10.1086/588755">Stone et al., 2008, â€œAthena: A New Code for Astrophysical MHDâ€</a></li>
  <li><a href="https://qiita.com/ur_kinsk/items/1893602e2ee73060b207">Qiitaè¨˜äº‹, ç£æ°—æµä½“ã®æ•°å€¤è¨ˆç®—ã§éŠã¶</a></li>
  <li><a href="http://www.astro.phys.s.chiba-u.ac.jp/cans/doc/riemann.html">CANS+ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ, ç£æ°—æµä½“åŠ›å­¦æ–¹ç¨‹å¼ã«å¯¾ã™ã‚‹è¿‘ä¼¼ãƒªãƒ¼ãƒãƒ³è§£æ³•</a></li>
</ul>

<script async="" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-9131160172347693" crossorigin="anonymous"></script>

<!-- for_jekyll -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-9131160172347693" data-ad-slot="3528582902" data-ad-format="auto" data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script></p>

:ET