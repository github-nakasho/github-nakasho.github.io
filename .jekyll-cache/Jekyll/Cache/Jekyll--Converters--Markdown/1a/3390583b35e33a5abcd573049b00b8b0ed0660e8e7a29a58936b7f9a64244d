I"a³
<details open="">
  <summary class="text-delta">
    Table of contents
  </summary>
<ol id="markdown-toc">
  <li><a href="#ç­‰æ¸©ã®å ´åˆã®hlld" id="markdown-toc-ç­‰æ¸©ã®å ´åˆã®hlld">ç­‰æ¸©ã®å ´åˆã®HLLD</a>    <ol>
      <li><a href="#ç£æ°—æµä½“æ–¹ç¨‹å¼ç¾¤" id="markdown-toc-ç£æ°—æµä½“æ–¹ç¨‹å¼ç¾¤">ç£æ°—æµä½“æ–¹ç¨‹å¼ç¾¤</a></li>
      <li><a href="#æµæŸè¨ˆç®—" id="markdown-toc-æµæŸè¨ˆç®—">æµæŸè¨ˆç®—</a></li>
      <li><a href="#æ•°å€¤è¨ˆç®—ã«ç”¨ã„ã‚‹" id="markdown-toc-æ•°å€¤è¨ˆç®—ã«ç”¨ã„ã‚‹">æ•°å€¤è¨ˆç®—ã«ç”¨ã„ã‚‹</a></li>
      <li><a href="#ç­‰æ¸©hlldæµæŸã®è¨ˆç®—ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«" id="markdown-toc-ç­‰æ¸©hlldæµæŸã®è¨ˆç®—ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«">ç­‰æ¸©HLLDæµæŸã®è¨ˆç®—ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«</a></li>
    </ol>
  </li>
  <li><a href="#å‚è€ƒæ–‡çŒ®" id="markdown-toc-å‚è€ƒæ–‡çŒ®">å‚è€ƒæ–‡çŒ®</a></li>
</ol>

</details>

<script async="" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-9131160172347693" crossorigin="anonymous"></script>

<!-- for_jekyll -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-9131160172347693" data-ad-slot="3528582902" data-ad-format="auto" data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script></p>

<h1 id="ç­‰æ¸©ã®å ´åˆã®hlld">ç­‰æ¸©ã®å ´åˆã®HLLD</h1>

<h2 id="ç£æ°—æµä½“æ–¹ç¨‹å¼ç¾¤">ç£æ°—æµä½“æ–¹ç¨‹å¼ç¾¤</h2>

<p>å®‡å®™ç©ºé–“ã«å­˜åœ¨ã™ã‚‹ã‚¬ã‚¹ã¯åœ§ç¸®ã‚’å—ã‘ã‚‹ã¨ä¸€æ™‚çš„ã«é«˜æ¸©ã«ãªã‚Šã¾ã™ãŒã€æ”¾å°„å†·å´ãªã©ã®ä»–ã®ç‰©ç†éç¨‹ã«ã‚ˆã‚Šç´ æ—©ãã‚¨ãƒãƒ«ã‚®ãƒ¼ã‚’å¤±ã†å ´åˆã«ã¯ã€åœ§ç¸®ã®å‰å¾Œã§ç­‰æ¸©ã®çŠ¶æ…‹ãŒä¿ãŸã‚Œã‚‹å ´åˆãŒã‚ã‚Šã¾ã™ã€‚
ãã®ã‚ˆã†ãªå ´åˆã«ã¯ã€ã‚¨ãƒãƒ«ã‚®ãƒ¼ã®æ–¹ç¨‹å¼ã‚’è€ƒãˆã‚‹å¿…è¦ãŒãªãã€1æ¬¡å…ƒã®ç†æƒ³ç£æ°—æµä½“æ–¹ç¨‹å¼ã¯ä»¥ä¸‹ã®ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚</p>

\[\frac{\partial}{\partial t}\left( \begin{array}{c}
\rho \\
\rho v_x \\
\rho v_y \\
\rho v_z \\
B_y \\
B_z 
\end{array} \right) + \frac{\partial}{\partial x} \left( \begin{array}{c} 
\rho v_x \\
\rho v_x v_x + P_\mathrm{tot} - B_x B_x \\
\rho v_y v_x - B_y B_x \\
\rho v_z v_x - B_z B_x \\
B_y v_x - B_x v_y \\
B_z v_x - B_x v_z
\end{array} \right) = \mathbf{0} \tag{1}\]

<p>ã“ã®ã¨ãã€<a href="/simulation/hlld">HLLDæ³•</a>ã¯ã©ã®ã‚ˆã†ã«å¤‰å½¢ã•ã‚Œã‚‹ã§ã—ã‚‡ã†ã‹ã€‚ãã‚Œã‚’è¦‹ã¦ã¿ã¾ã—ã‚‡ã†ã€‚ä»¥é™ã§ã¯æ™®é€šã®HLLDã‚’æ–­ç†±HLLDã€ç­‰æ¸©ã®å ´åˆã‚’ç­‰æ¸©HLLDã¨å‘¼ã¶ã“ã¨ã«ã—ã¾ã™ã€‚</p>

<h2 id="æµæŸè¨ˆç®—">æµæŸè¨ˆç®—</h2>

<p>(1)å¼ã®ç‰¹æ€§é€Ÿåº¦ã‚’è¨ˆç®—ã™ã‚‹ã¨ã€å®Ÿã¯ä»¥ä¸‹ã®6ã¤ã«ãªã‚Šã¾ã™ã€‚</p>

\[\lambda_{1, 6} = v_x \pm c_f, \quad \lambda_{2, 5} = v_x \pm c_a, \quad \lambda_{3, 4} = v_x \pm c_s \tag{2}\]

<p>ã“ã“ã§\(c_f, c_a, c_s\)ã¯ãã‚Œãã‚Œ<a href="/mhd/magneto_acoustic">é€Ÿã„ç£æ°—éŸ³æ³¢</a>ã®ä¼æ’­é€Ÿåº¦ã€<a href="/mhd/alfven_wave">ã‚¢ãƒ«ãƒ´ã‚§ãƒ¼ãƒ³é€Ÿåº¦</a>ã€<a href="/mhd/magneto_acoustic">é…ã„ç£æ°—éŸ³æ³¢</a>ã®ä¼æ’­é€Ÿåº¦ã§ã™ã€‚
æ–­ç†±HLLDã§ã¯ã€ã“ã“ã«ã•ã‚‰ã«\(\lambda = v_x\)ã§ä¼æ’­ã™ã‚‹ã‚¨ãƒ³ãƒˆãƒ­ãƒ”ãƒ¼æ³¢ãŒå­˜åœ¨ã—ã¾ã™ã€‚ä»Šã¯ç­‰æ¸©ã‚’è€ƒãˆã¦ã„ã‚‹ãŸã‚ã€ã‚¨ãƒ³ãƒˆãƒ­ãƒ”ãƒ¼æ³¢ã®ã‚ˆã†ã«ãã®æ³¢é¢ã‚’æŒŸã‚“ã§æ¸©åº¦ã®ä¸é€£ç¶šãŒç™ºç”Ÿã™ã‚‹ã“ã¨ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚<br />
ã‚ˆã£ã¦æ–­ç†±HLLDã®ã¨ãã¨åŒæ§˜ã«é…ã„ç£æ°—éŸ³æ³¢ã¯ç„¡è¦–ã™ã‚‹ã“ã¨ã«åŠ ãˆã€ã‚¨ãƒ³ãƒˆãƒ­ãƒ”ãƒ¼æ³¢ã‚’è€ƒæ…®ã—ãªã„ä»¥ä¸‹ã®ã‚ˆã†ãªãƒªãƒ¼ãƒãƒ³ãƒ•ã‚¡ãƒ³ã‚’è€ƒãˆã¾ã™ã€‚</p>

<p><img src="/assets/images/simulation/iso_hlld_01.png" alt="" /></p>

<p>ã“ã“ã§\(S_L, S_R\)ã¯ãã‚Œãã‚Œå·¦æ–¹å‘ã¨å³æ–¹å‘ã«é€²ã‚€é€Ÿé€²ç£æ°—éŸ³æ³¢ã®æ³¢é¢ã€\(S_L^\ast, S_R^\ast\)ã¯ãã‚Œãã‚Œå·¦æ–¹å‘ã¨å³æ–¹å‘ã«é€²ã‚€ã‚¢ãƒ«ãƒ´ã‚§ãƒ¼ãƒ³æ³¢ã®æ³¢é¢ã§ã™ã€‚æ–­ç†±HLLDã§ã¯ä¸­é–“çŠ¶æ…‹ã«ãŠã„ã¦\(x\)æ–¹å‘ã®æµä½“é€Ÿåº¦ã¨å…¨åœ§åŠ›ã‚’ä¸€å®šã¨ã—ã¾ã—ãŸã€‚ã‚ˆã£ã¦ç­‰æ¸©HLLDã§ã‚‚åŒæ§˜ã«</p>

\[v^\ast_{x, L} = v^\ast_{x, c} = v^\ast_{x, R} \equiv v_x^\ast \tag{3}\]

\[P^\ast_{\mathrm{tot}, L} = P^\ast_{\mathrm{tot}, c} = P^\ast_{\mathrm{tot}, R} \equiv P^\ast_{\mathrm{tot}} \tag{4}\]

<p>ã‚’ä»®å®šã—ã¾ã™ã€‚ã•ã‚‰ã«<a href="/simulation/hlld">æ–­ç†±HLLDã®(19)å¼</a>ã‹ã‚‰\(\rho_L^{\ast \ast} = \rho_L^\ast, \rho_R^{\ast \ast} = \rho_R^\ast\)ã§ã—ãŸãŒã€ä»Šã¯\(\mathbf{U}_L^{\ast \ast}, \mathbf{U}_R^{\ast \ast}\)ã®çŠ¶æ…‹ã¯\(\mathbf{U}_c^\ast\)ã¨ã„ã†çŠ¶æ…‹ã«é›†ç´„ã•ã‚Œã¦ã„ã‚‹ãŸã‚</p>

\[\rho_L^\ast = \rho_c^\ast = \rho_R^\ast \equiv \rho^\ast \tag{5}\]

<p>ãŒæˆã‚Šç«‹ã¡ã¾ã™ã€‚ã“ã‚Œã‚‰ã‚’è¸ã¾ãˆãŸä¸Šã§ã€\(S_\alpha\)ã®æ³¢é¢ã§ã®ã‚¸ãƒ£ãƒ³ãƒ—æ¡ä»¶ã‚’è¦‹ã¦ã„ãã¾ã—ã‚‡ã†ã€‚</p>

\[S_\alpha \left( \begin{array}{c} 
\rho^\ast \\
\rho^\ast v_x^\ast \\
\rho^\ast v_{y, \alpha}^\ast \\
\rho^\ast v_{z, \alpha}^\ast \\
B_{y, \alpha}^\ast \\
B_{z, \alpha}^\ast
\end{array} \right) - \left( \begin{array}{c} 
\rho^\ast v_x^\ast \\
\rho^\ast v_x^\ast v_x^\ast + P_\mathrm{tot}^\ast - B_x B_x \\
\rho^\ast v_{y, \alpha}^\ast v_x^\ast - B_{y, \alpha}^\ast B_x \\
\rho^\ast v_{z, \alpha}^\ast v_x^\ast - B_{z, \alpha}^\ast B_x \\
B_{y, \alpha}^\ast v_x^\ast - v_{y, \alpha}^\ast B_x \\
B_{z, \alpha}^\ast v_x^\ast - v_{z, \alpha}^\ast B_x
\end{array} \right) 
= S_\alpha \left( \begin{array}{c} 
\rho_\alpha \\
\rho_\alpha v_{x, \alpha} \\
\rho_\alpha v_{y, \alpha} \\
\rho_\alpha v_{z, \alpha} \\
B_{y, \alpha} \\
B_{z, \alpha}
\end{array} \right) - \left( \begin{array}{c} 
\rho_\alpha v_{x, \alpha} \\
\rho_\alpha v_{x, \alpha} v_{x, \alpha} + P_{\mathrm{tot}, \alpha} - B_x B_x \\
\rho_\alpha v_{y, \alpha} v_{x, \alpha} - B_{y, \alpha} B_x \\
\rho_\alpha v_{z, \alpha} v_{x, \alpha} - B_{z, \alpha} B_x \\
B_{y, \alpha} v_{x, \alpha} - v_{y, \alpha} B_x \\
B_{z, \alpha} v_{x, \alpha} - v_{z, \alpha} B_x
\end{array} \right) \tag{6}\]

<p>ã“ã“ã§(6)å¼ã®ç¬¬ä¸€, ç¬¬äºŒå¼ã«ç€ç›®ã—ã¦ã¿ã¾ã—ã‚‡ã†ã€‚</p>

\[S_\alpha \rho^\ast - \rho^\ast v_x^\ast 
= S_\alpha \rho_\alpha - \rho_\alpha v_{x, \alpha} \tag{7}\]

\[S_\alpha \rho^\ast v_x^\ast - (\rho^\ast v_x^\ast v_x^\ast + P_\mathrm{tot}^\ast - B_x B_x) 
= S_\alpha \rho_\alpha v_{x, \alpha} - (\rho_\alpha v_{x, \alpha} v_{x, \alpha} + P_{\mathrm{tot}, \alpha} - B_x B_x) \tag{8}\]

<p>ã™ã‚‹ã¨\(\alpha = R, L\)ã‚ˆã‚Šã€ã“ã®4æœ¬ã®æ–¹ç¨‹å¼ã«ã¯\(\rho^\ast, v_x^\ast, P_\mathrm{tot}^\ast\)ã®3ã¤ã®å¤‰æ•°ã—ã‹ã‚ã‚Šã¾ã›ã‚“ã€‚ã‚ˆã£ã¦ã“ã‚Œã‚’è§£ã„ã¦\(\rho^\ast\)ãªã©ã‚’å¾—ã‚‹ã“ã¨ã¯ä¸å¯èƒ½ã§ã™ã€‚
ã“ã®è­°è«–ã‹ã‚‰ã€æ–­ç†±HLLDã®ã¨ãã¨åŒæ§˜ã«\(\rho^\ast, v_x^\ast\)ã¯HLLä¸­é–“çŠ¶æ…‹ã‹ã‚‰æ±‚ã‚ã‚‹ã“ã¨ã«ã—ã¾ã—ã‚‡ã†ã€‚ã™ãªã‚ã¡</p>

\[\rho^\ast 
= \rho_\mathrm{HLL}^\ast 
= \frac{S_R \rho_R - S_L \rho_L - \rho_R v_{x, R} + \rho_L v_{x, L}}{S_R - S_L} \tag{9}\]

<p>ãã—ã¦\(\rho v_x\)ã®HLLä¸­é–“çŠ¶æ…‹ã¯ã€<a href="/simulation/hll">HLLæ³•ã®(8)å¼</a>ã‹ã‚‰æ±‚ã‚ã‚‹ã“ã¨ã«ã™ã‚‹ã¨</p>

\[(\rho v_x)_\mathrm{HLL}^\ast 
= \frac{S_R \rho_L v_{x, L} - S_L \rho_R v_{x, R} + S_R S_L (\rho_R - \rho_L)}{S_R - S_L} \tag{10}\]

<p>ã‚ˆã‚Š</p>

\[v_x^\ast 
= \frac{(\rho v_x)_\mathrm{HLL}^\ast}{\rho_\mathrm{HLL}^\ast} 
= \frac{S_R \rho_L v_{x, L} - S_L \rho_R v_{x, R} + S_R S_L (\rho_R - \rho_L)}{S_R \rho_R - S_L \rho_L - \rho_R v_{x, R} + \rho_L v_{x, L}} \tag{11}\]

<p>ã¨æ±‚ã¾ã‚Šã¾ã™ã€‚ã•ã‚‰ã«\(P_\mathrm{tot}^\ast\)ã¯(8)å¼ã‹ã‚‰æ±‚ã‚ã¾ã—ã‚‡ã†ã€‚
ã—ã‹ã—(8)å¼ã«ãŠã„ã¦\(\rho^\ast, v_x^\ast\)ã¯HLLä¸­é–“çŠ¶æ…‹ã‹ã‚‰æ±‚ã‚ãŸã“ã¨ã‹ã‚‰ã‚ã‹ã‚‹ã‚ˆã†ã«ã€\(P_\mathrm{tot}^\ast\)ã‚‚HLLä¸­é–“çŠ¶æ…‹ã‹ã‚‰æ±‚ã‚ãŸã‚‚ã®ã«ä¸€è‡´ã—ã¾ã™ã€‚<br />
ç¶šã„ã¦\(v_{y, \alpha}^\ast\)ã‚’æ±‚ã‚ã¦ã¿ã¾ã—ã‚‡ã†ã€‚ã“ã‚Œã¯æ–­ç†±HLLDã®å ´åˆã¨å¤‰ã‚ã‚Šãªã„ãŸã‚ã€ãã®å¼ã‚’æµç”¨ã—ã¾ã™ã€‚<a href="/simulation/hlld">æ–­ç†±HLLDã®(14)å¼</a>ã«ãŠã„ã¦\(S_M = v_x^\ast\)ã¨ã™ã‚‹ã¨</p>

\[v_{y, \alpha}^\ast 
= v_{y, \alpha} - \frac{v_x^\ast - v_{x, \alpha}}{(S_\alpha - v_{x, \alpha}) (S_\alpha - v_x^\ast) \rho_\alpha - B_x^2} B_{y, \alpha} B_x\]

<p>ã“ã“ã§ã€ã“ã®å¼ã®åˆ†æ•°éƒ¨åˆ†ã®åˆ†æ¯ã‚’æ•´ç†ã—ã¾ã—ã‚‡ã†ã€‚</p>

\[\rho_\alpha (S_\alpha - v_{x, \alpha}) (S_\alpha - v_x^\ast) - B_x^2 
= \rho^\ast \left\{ \frac{\rho_\alpha}{\rho^\ast} (S_\alpha - v_{x, \alpha}) (S_\alpha - v_x^\ast) - \frac{B_x^2}{\rho^\ast}\right\}\]

<p>(6)å¼ã®ç¬¬ä¸€å¼ã‚ˆã‚Š</p>

\[\rho^\ast = \frac{S_\alpha - v_{x, \alpha}}{S_\alpha - v_x^\ast} \rho_\alpha\]

<p>ã‚’ä»£å…¥ã™ã‚‹ã¨</p>

\[\rho^\ast \left\{ (S_\alpha - v_x^\ast)^2 - \frac{B_x^2}{\rho^\ast} \right\} 
= \rho^\ast \left( S_\alpha - v_x^\ast - \frac{\vert B_x\vert}{\sqrt{\rho^\ast}}\right) \left( S_\alpha - v_x^\ast + \frac{\vert B_x\vert}{\sqrt{\rho^\ast}}\right) 
= \rho^\ast (S_\alpha - S_R^\ast) (S_\alpha - S_L^\ast)\]

<p>ã®ã‚ˆã†ã«æ•´ç†ã•ã‚Œã¾ã™ã€‚ã‚ˆã£ã¦</p>

\[\rho^\ast v_{y, \alpha}^\ast = \rho^\ast v_{y, \alpha} - \frac{v_x^\ast - v_{x, \alpha}}{(S_\alpha - S_R^\ast)(S_\alpha - S_L^\ast)} B_{y, \alpha} B_x \tag{12}\]

<p>åŒæ§˜ã«ã€<a href="/simulation/hlld">æ–­ç†±HLLDã®(16)å¼</a>ã‚ˆã‚Š</p>

\[\rho^\ast v_{z, \alpha}^\ast = \rho^\ast v_{z, \alpha} - \frac{v_x^\ast - v_{x, \alpha}}{(S_\alpha - S_R^\ast)(S_\alpha - S_L^\ast)} B_{z, \alpha} B_x \tag{13}\]

<p><a href="/simulation/hlld">æ–­ç†±HLLDã®(15), (17)å¼</a>ã‹ã‚‰</p>

\[B_{y, \alpha}^\ast 
= B_{y, \alpha} \frac{\rho_\alpha (S_\alpha - v_{x, \alpha})^2 - B_x^2}{\rho_\alpha (S_\alpha - v_{x, \alpha}) (S_\alpha - v_x^\ast) - B_x^2} 
= B_{y, \alpha} \frac{\rho_\alpha (S_\alpha - v_{x, \alpha})^2 - B_x^2}{\rho^\ast (S_\alpha - S_R^\ast) (S_\alpha - S_L^\ast)} \tag{14}\]

\[B_{z, \alpha}^\ast 
= B_{z, \alpha} \frac{\rho_\alpha (S_\alpha - v_{x, \alpha})^2 - B_x^2}{\rho^\ast (S_\alpha - S_R^\ast) (S_\alpha - S_L^\ast)} \tag{15}\]

<p>ã¨ãªã‚Šã¾ã™ã€‚æ±‚ã¾ã£ã¦ã„ãªã„ã®ã¯\(\mathbf{U}_c\)ã§ã®\(v_{y, c}, v_{z, c}, B_{y, c}, B_{z, c}\)ã§ã™ã€‚
ã“ã‚Œã‚‰ã‚‚<a href="/simulation/hlld">æ–­ç†±HLLD</a>ã¨åŒæ§˜ã®è¨ˆç®—ã§æ±‚ã‚ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚<a href="/simulation/hlld">æ–­ç†±HLLDã®(27)å¼</a>ã«ãŠã„ã¦\(\rho_L^\ast = \rho_R^\ast = \rho^\ast\)ã¨ã™ã‚Œã°</p>

\[\begin{align}
&amp;v_{y, c}^\ast 
= \frac{\sqrt{\rho^\ast} v_{y, L}^\ast + \sqrt{\rho^\ast} v_{y, R}^\ast + (B_{y, R}^\ast - B_{y, L}^\ast) \mathrm{sign} (B_x)}{\sqrt{\rho^\ast} + \sqrt{\rho^\ast}} \notag \\
&amp;\Longrightarrow \ 
\rho^\ast v_{y, c}^\ast 
= \frac{\rho^\ast v_{y, L}^\ast + \rho^\ast v_{y, R}}{2} + \frac{(B_{y, R}^\ast - B_{y, L}^\ast) \sqrt{\rho^\ast} \mathrm{sign} (B_x)}{2} \tag{16}
\end{align}\]

<p>åŒæ§˜ã«<a href="/simulation/hlld">æ–­ç†±HLLDã®(28)å¼</a>ã‚ˆã‚Š</p>

\[\rho^\ast v_{z, c}^\ast 
= \frac{\rho^\ast v_{z, L}^\ast + \rho^\ast v_{z, R}}{2} + \frac{(B_{z, R}^\ast - B_{z, L}^\ast) \sqrt{\rho^\ast} \mathrm{sign} (B_x)}{2} \tag{17}\]

<p>ã§ã™ã€‚ãã—ã¦<a href="/simulation/hlld">æ–­ç†±HLLDã®(29)å¼</a>ã‚ˆã‚Š</p>

\[B_{y, c}^\ast 
= \frac{\sqrt{\rho^\ast} B_{y, R}^\ast + \sqrt{\rho^\ast} B_{y, L}^\ast + \rho^\ast (v_{y, R}^\ast - v_{y, L}^\ast) \mathrm{sign}(B_x)}{2 \sqrt{\rho^\ast}} 
= \frac{B_{y, R}^\ast + B_{y, L}^\ast}{2} + \frac{(v_{y, R}^\ast - v_{y, L}^\ast) \sqrt{\rho^\ast} \mathrm{sign} (B_x)}{2} \tag{18}\]

<p>æœ€å¾Œã«<a href="/simulation/hlld">æ–­ç†±HLLDã®(30)å¼</a>ã‹ã‚‰</p>

\[B_{y, c}^\ast 
= \frac{B_{z, R}^\ast + B_{z, L}^\ast}{2} + \frac{(v_{z, R}^\ast - v_{z, L}^\ast) \sqrt{\rho^\ast} \mathrm{sign} (B_x)}{2} \tag{19}\]

<p>ã¨æ±‚ã¾ã‚Šã¾ã™ã€‚</p>

<h2 id="æ•°å€¤è¨ˆç®—ã«ç”¨ã„ã‚‹">æ•°å€¤è¨ˆç®—ã«ç”¨ã„ã‚‹</h2>

<p><a href="/simulation/hll">HLL</a>, <a href="/simulation/hllc">HLLC</a>, <a href="/simulation/hlld">æ–­ç†±HLLD</a>ã¨åŒæ§˜ã«ã€å®Ÿéš›ã®æ•°å€¤è¨ˆç®—ã§ã¯\(S_L, S_L^\ast, S_R^\ast, S_R\)ã®å¤§ãã•ã«ä¾å­˜ã—ã¦ã€ã©ã®æµæŸã‚’ç”¨ã„ã‚‹ã‹ã‚’æ±ºå®šã—ã¾ã™ã€‚
ä¸‹å›³ã¯å·¦ä¸Šã‹ã‚‰\(S_L &gt; 0, S_L \leq 0 &lt; S_L^\ast, S_L^\ast \leq 0 S_R^\ast, S_R^\ast \leq 0 &lt; S_R, S_R \leq 0\)ã®å ´åˆã‚’å›³ç¤ºã—ãŸã‚‚ã®ã§ã™ã€‚</p>

<p><img src="/assets/images/simulation/iso_hlld_02.png" alt="" /></p>

<p>ã‚ˆã£ã¦ã€æ•°å€¤è¨ˆç®—ã‚’è¡Œã†å ´åˆã«ã€ãã®æµæŸã®é¸æŠã¯</p>

\[\mathbf{F}_\mathrm{iso \ HLLD} 
= \left\{ \begin{array}{ll}
\mathbf{F}_L &amp; \mathrm{if} \ S_L &gt; 0 \\
\mathbf{F}_L^\ast = \mathbf{F}_L + S_L (\mathbf{U}_L^\ast - \mathbf{U}_L) &amp; \mathrm{if} \ S_L \leq 0 &lt; S_L^\ast \\
\mathbf{F}_c^\ast &amp; \mathrm{if} \ S_L^\ast \leq 0 &lt; S_R^\ast \\
\mathbf{F}_R^\ast = \mathbf{F}_R + S_R (\mathbf{U}_R^\ast - \mathbf{U}_R)&amp; \mathrm{if} \ S_R^\ast &lt; 0 &lt; S_R \\
\mathbf{F}_R &amp; \mathrm{if} \ S_R \leq 0 
\end{array} \right. \tag{20}\]

<p>ã®ã‚ˆã†ã«ã—ã¾ã™ã€‚</p>

<h2 id="ç­‰æ¸©hlldæµæŸã®è¨ˆç®—ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«">ç­‰æ¸©HLLDæµæŸã®è¨ˆç®—ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«</h2>

<p>ä»¥ä¸‹ã«ç­‰æ¸©HLLDæµæŸè¨ˆç®—ã‚³ãƒ¼ãƒ‰ã®Juliaå®Ÿè£…ä¾‹ã‚’ç¤ºã—ã¾ã™ã€‚</p>

<div class="language-julia highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">function</span><span class="nf"> hlld_core</span><span class="x">(</span><span class="n">rol</span><span class="x">,</span> <span class="n">vnl</span><span class="x">,</span> <span class="n">vtl</span><span class="x">,</span> <span class="n">vul</span><span class="x">,</span> <span class="n">prl</span><span class="x">,</span> <span class="n">bnl</span><span class="x">,</span> <span class="n">btl</span><span class="x">,</span> <span class="n">bul</span><span class="x">,</span> <span class="n">ror</span><span class="x">,</span> <span class="n">vnr</span><span class="x">,</span> <span class="n">vtr</span><span class="x">,</span> <span class="n">vur</span><span class="x">,</span> <span class="n">prr</span><span class="x">,</span> <span class="n">bnr</span><span class="x">,</span> <span class="n">btr</span><span class="x">,</span> <span class="n">bur</span><span class="x">,</span> <span class="n">cs2</span><span class="x">)</span>
    <span class="c"># compute B * B at left side</span>
    <span class="n">bl2</span> <span class="o">=</span> <span class="n">dot</span><span class="x">([</span><span class="n">bnl</span><span class="x">,</span> <span class="n">btl</span><span class="x">,</span> <span class="n">bul</span><span class="x">],</span> <span class="x">[</span><span class="n">bnl</span><span class="x">,</span> <span class="n">btl</span><span class="x">,</span> <span class="n">bul</span><span class="x">])</span>
    <span class="c"># compute fast-mode speed at left side</span>
    <span class="n">vfl</span> <span class="o">=</span> <span class="n">sqrt</span><span class="x">(((</span><span class="n">bl2</span><span class="o">+</span><span class="n">prl</span><span class="x">)</span><span class="o">+</span><span class="n">sqrt</span><span class="x">((</span><span class="n">bl2</span><span class="o">+</span><span class="n">prl</span><span class="x">)</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="mi">4</span><span class="o">*</span><span class="n">prl</span><span class="o">*</span><span class="n">bnl</span><span class="o">^</span><span class="mi">2</span><span class="x">))</span><span class="o">/</span><span class="x">(</span><span class="mi">2</span><span class="o">*</span><span class="n">rol</span><span class="x">))</span>
    <span class="c"># compute B * B at right side</span>
    <span class="n">br2</span> <span class="o">=</span> <span class="n">dot</span><span class="x">([</span><span class="n">bnr</span><span class="x">,</span> <span class="n">btr</span><span class="x">,</span> <span class="n">bur</span><span class="x">],</span> <span class="x">[</span><span class="n">bnr</span><span class="x">,</span> <span class="n">btr</span><span class="x">,</span> <span class="n">bur</span><span class="x">])</span>
    <span class="c"># compute fast-mode speed at right side</span>
    <span class="n">vfr</span> <span class="o">=</span> <span class="n">sqrt</span><span class="x">(((</span><span class="n">br2</span><span class="o">+</span><span class="n">prr</span><span class="x">)</span><span class="o">+</span><span class="n">sqrt</span><span class="x">((</span><span class="n">br2</span><span class="o">+</span><span class="n">prr</span><span class="x">)</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="mi">4</span><span class="o">*</span><span class="n">prr</span><span class="o">*</span><span class="n">bnr</span><span class="o">^</span><span class="mi">2</span><span class="x">))</span><span class="o">/</span><span class="x">(</span><span class="mi">2</span><span class="o">*</span><span class="n">ror</span><span class="x">))</span>
    <span class="c"># compute sl, sr</span>
    <span class="n">sl</span> <span class="o">=</span> <span class="n">min</span><span class="x">(</span><span class="n">vnl</span><span class="x">,</span> <span class="n">vnr</span><span class="x">)</span> <span class="o">-</span> <span class="n">max</span><span class="x">(</span><span class="n">vfl</span><span class="x">,</span> <span class="n">vfr</span><span class="x">)</span>
    <span class="n">sr</span> <span class="o">=</span> <span class="n">max</span><span class="x">(</span><span class="n">vnl</span><span class="x">,</span> <span class="n">vnr</span><span class="x">)</span> <span class="o">+</span> <span class="n">max</span><span class="x">(</span><span class="n">vfl</span><span class="x">,</span> <span class="n">vfr</span><span class="x">)</span>
    <span class="c"># compute bnc from HLL average</span>
    <span class="n">bnc</span> <span class="o">=</span> <span class="x">(</span><span class="n">sr</span><span class="o">*</span><span class="n">bnr</span><span class="o">-</span><span class="n">sl</span><span class="o">*</span><span class="n">bnl</span><span class="x">)</span> <span class="o">/</span> <span class="x">(</span><span class="n">sr</span><span class="o">-</span><span class="n">sl</span><span class="x">)</span>
    <span class="c"># compute pt at left and right sides</span>
    <span class="n">ptl</span> <span class="o">=</span> <span class="n">prl</span> <span class="o">+</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">bl2</span>
    <span class="n">ptr</span> <span class="o">=</span> <span class="n">prr</span> <span class="o">+</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">br2</span>
    <span class="c"># compute ro from HLL average at intermediate state</span>
    <span class="n">srsl</span> <span class="o">=</span> <span class="n">sr</span> <span class="o">-</span> <span class="n">sl</span>
    <span class="n">roi</span> <span class="o">=</span> <span class="x">(</span><span class="n">sr</span><span class="o">*</span><span class="n">ror</span><span class="o">-</span><span class="n">sl</span><span class="o">*</span><span class="n">rol</span><span class="o">-</span><span class="n">ror</span><span class="o">*</span><span class="n">vnr</span><span class="o">+</span><span class="n">rol</span><span class="o">*</span><span class="n">vnl</span><span class="x">)</span> <span class="o">/</span> <span class="n">srsl</span>
    <span class="c"># compute Fhll for density flux</span>
    <span class="n">Fhllro</span> <span class="o">=</span> <span class="x">(</span><span class="n">sr</span><span class="o">*</span><span class="n">rol</span><span class="o">*</span><span class="n">vnl</span><span class="o">-</span><span class="n">sl</span><span class="o">*</span><span class="n">ror</span><span class="o">*</span><span class="n">vnr</span><span class="o">+</span><span class="n">sr</span><span class="o">*</span><span class="n">sl</span><span class="o">*</span><span class="x">(</span><span class="n">ror</span><span class="o">-</span><span class="n">rol</span><span class="x">))</span> <span class="o">/</span> <span class="n">srsl</span>
    <span class="c"># compute Fhll for x-momentum flux</span>
    <span class="n">Fmnl</span> <span class="o">=</span> <span class="n">rol</span> <span class="o">*</span> <span class="n">vnl</span> <span class="o">*</span> <span class="n">vnl</span> <span class="o">+</span> <span class="n">ptl</span> <span class="o">-</span> <span class="n">bnc</span> <span class="o">*</span> <span class="n">bnc</span>
    <span class="n">Fmnr</span> <span class="o">=</span> <span class="n">ror</span> <span class="o">*</span> <span class="n">vnr</span> <span class="o">*</span> <span class="n">vnr</span> <span class="o">+</span> <span class="n">ptr</span> <span class="o">-</span> <span class="n">bnc</span> <span class="o">*</span> <span class="n">bnc</span>
    <span class="n">Fhllmn</span> <span class="o">=</span> <span class="x">(</span><span class="n">sr</span><span class="o">*</span><span class="n">Fmnl</span><span class="o">-</span><span class="n">sl</span><span class="o">*</span><span class="n">Fmnr</span><span class="o">+</span><span class="n">sr</span><span class="o">*</span><span class="n">sl</span><span class="o">*</span><span class="x">(</span><span class="n">ror</span><span class="o">*</span><span class="n">vnr</span><span class="o">-</span><span class="n">rol</span><span class="o">*</span><span class="n">vnl</span><span class="x">))</span> <span class="o">/</span> <span class="n">srsl</span>
    <span class="c"># compute vn at inbermediate state</span>
    <span class="n">vni</span> <span class="o">=</span> <span class="n">Fhllro</span> <span class="o">/</span> <span class="n">roi</span>
    <span class="c"># compute sl*, sr*</span>
    <span class="n">rtroi</span> <span class="o">=</span> <span class="n">sqrt</span><span class="x">(</span><span class="n">roi</span><span class="x">)</span>
    <span class="n">sli</span> <span class="o">=</span> <span class="n">vni</span> <span class="o">-</span> <span class="n">abs</span><span class="x">(</span><span class="n">bnc</span><span class="x">)</span> <span class="o">/</span> <span class="n">rtroi</span>
    <span class="n">sri</span> <span class="o">=</span> <span class="n">vni</span> <span class="o">+</span> <span class="n">abs</span><span class="x">(</span><span class="n">bnc</span><span class="x">)</span> <span class="o">/</span> <span class="n">rtroi</span>
    <span class="c"># compute my, mz, by, bz at left inner side in Riemann fan</span>
    <span class="k">if</span> <span class="n">abs</span><span class="x">((</span><span class="n">sl</span><span class="o">-</span><span class="n">sri</span><span class="x">)</span><span class="o">*</span><span class="x">(</span><span class="n">sl</span><span class="o">-</span><span class="n">sli</span><span class="x">))</span> <span class="o">&gt;</span> <span class="mf">1.0e-10</span>
        <span class="n">denol</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="x">((</span><span class="n">sl</span><span class="o">-</span><span class="n">sri</span><span class="x">)</span><span class="o">*</span><span class="x">(</span><span class="n">sl</span><span class="o">-</span><span class="n">sli</span><span class="x">))</span>
        <span class="n">mtil</span> <span class="o">=</span> <span class="n">roi</span> <span class="o">*</span> <span class="n">vtl</span> <span class="o">-</span> <span class="x">(</span><span class="n">vni</span><span class="o">-</span><span class="n">vnl</span><span class="x">)</span> <span class="o">*</span> <span class="n">denol</span> <span class="o">*</span> <span class="n">btl</span> <span class="o">*</span> <span class="n">bnc</span>
        <span class="n">muil</span> <span class="o">=</span> <span class="n">roi</span> <span class="o">*</span> <span class="n">vul</span> <span class="o">-</span> <span class="x">(</span><span class="n">vni</span><span class="o">-</span><span class="n">vnl</span><span class="x">)</span> <span class="o">*</span> <span class="n">denol</span> <span class="o">*</span> <span class="n">bul</span> <span class="o">*</span> <span class="n">bnc</span>
        <span class="n">btil</span> <span class="o">=</span> <span class="n">btl</span> <span class="o">*</span> <span class="x">(</span><span class="n">rol</span><span class="o">*</span><span class="x">(</span><span class="n">sl</span><span class="o">-</span><span class="n">vnl</span><span class="x">)</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="n">bnc</span><span class="o">^</span><span class="mi">2</span><span class="x">)</span> <span class="o">*</span> <span class="n">denol</span> <span class="o">/</span> <span class="n">roi</span>
        <span class="n">buil</span> <span class="o">=</span> <span class="n">bul</span> <span class="o">*</span> <span class="x">(</span><span class="n">rol</span><span class="o">*</span><span class="x">(</span><span class="n">sl</span><span class="o">-</span><span class="n">vnl</span><span class="x">)</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="n">bnc</span><span class="o">^</span><span class="mi">2</span><span class="x">)</span> <span class="o">*</span> <span class="n">denol</span> <span class="o">/</span> <span class="n">roi</span>
    <span class="k">else</span>
        <span class="n">mtil</span> <span class="o">=</span> <span class="n">rol</span> <span class="o">*</span> <span class="n">vtl</span>
        <span class="n">muil</span> <span class="o">=</span> <span class="n">rol</span> <span class="o">*</span> <span class="n">vul</span>
        <span class="n">btil</span> <span class="o">=</span> <span class="n">btl</span>
        <span class="n">buil</span> <span class="o">=</span> <span class="n">bul</span>
    <span class="k">end</span>
    <span class="c"># compute my, mz, by, bz at right inner side in Riemann fan</span>
    <span class="k">if</span> <span class="n">abs</span><span class="x">((</span><span class="n">sr</span><span class="o">-</span><span class="n">sri</span><span class="x">)</span><span class="o">*</span><span class="x">(</span><span class="n">sr</span><span class="o">-</span><span class="n">sli</span><span class="x">))</span> <span class="o">&gt;</span> <span class="mf">1.0e-10</span>
        <span class="n">denor</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="x">((</span><span class="n">sr</span><span class="o">-</span><span class="n">sri</span><span class="x">)</span><span class="o">*</span><span class="x">(</span><span class="n">sr</span><span class="o">-</span><span class="n">sli</span><span class="x">))</span>
        <span class="n">mtir</span> <span class="o">=</span> <span class="n">roi</span> <span class="o">*</span> <span class="n">vtr</span> <span class="o">-</span> <span class="x">(</span><span class="n">vni</span><span class="o">-</span><span class="n">vnr</span><span class="x">)</span> <span class="o">*</span> <span class="n">denor</span> <span class="o">*</span> <span class="n">btr</span> <span class="o">*</span> <span class="n">bnc</span>
        <span class="n">muir</span> <span class="o">=</span> <span class="n">roi</span> <span class="o">*</span> <span class="n">vur</span> <span class="o">-</span> <span class="x">(</span><span class="n">vni</span><span class="o">-</span><span class="n">vnr</span><span class="x">)</span> <span class="o">*</span> <span class="n">denor</span> <span class="o">*</span> <span class="n">bur</span> <span class="o">*</span> <span class="n">bnc</span>
        <span class="n">btir</span> <span class="o">=</span> <span class="n">btr</span> <span class="o">*</span> <span class="x">(</span><span class="n">ror</span><span class="o">*</span><span class="x">(</span><span class="n">sr</span><span class="o">-</span><span class="n">vnr</span><span class="x">)</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="n">bnc</span><span class="o">^</span><span class="mi">2</span><span class="x">)</span> <span class="o">*</span> <span class="n">denor</span> <span class="o">/</span> <span class="n">roi</span>
        <span class="n">buir</span> <span class="o">=</span> <span class="n">bur</span> <span class="o">*</span> <span class="x">(</span><span class="n">ror</span><span class="o">*</span><span class="x">(</span><span class="n">sr</span><span class="o">-</span><span class="n">vnr</span><span class="x">)</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="n">bnc</span><span class="o">^</span><span class="mi">2</span><span class="x">)</span> <span class="o">*</span> <span class="n">denor</span> <span class="o">/</span> <span class="n">roi</span>
    <span class="k">else</span>
        <span class="n">mtir</span> <span class="o">=</span> <span class="n">ror</span> <span class="o">*</span> <span class="n">vtr</span>
        <span class="n">muir</span> <span class="o">=</span> <span class="n">ror</span> <span class="o">*</span> <span class="n">vur</span>
        <span class="n">btir</span> <span class="o">=</span> <span class="n">btr</span>
        <span class="n">buir</span> <span class="o">=</span> <span class="n">bur</span>
    <span class="k">end</span>
    <span class="c"># compute my, mz, by, bz at middle inner side in Riemann fan</span>
    <span class="n">signbn</span> <span class="o">=</span> <span class="n">sign</span><span class="x">(</span><span class="n">bnc</span><span class="x">)</span>
    <span class="n">mtic</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="x">(</span><span class="n">mtil</span><span class="o">+</span><span class="n">mtir</span><span class="o">+</span><span class="x">(</span><span class="n">btir</span><span class="o">-</span><span class="n">btil</span><span class="x">)</span><span class="o">*</span><span class="n">rtroi</span><span class="o">*</span><span class="n">signbn</span><span class="x">)</span>
    <span class="n">muic</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="x">(</span><span class="n">muil</span><span class="o">+</span><span class="n">muir</span><span class="o">+</span><span class="x">(</span><span class="n">buir</span><span class="o">-</span><span class="n">buil</span><span class="x">)</span><span class="o">*</span><span class="n">rtroi</span><span class="o">*</span><span class="n">signbn</span><span class="x">)</span>
    <span class="n">btic</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="x">(</span><span class="n">btil</span><span class="o">+</span><span class="n">btir</span><span class="o">+</span><span class="x">(</span><span class="n">mtir</span><span class="o">-</span><span class="n">mtil</span><span class="x">)</span><span class="o">*</span><span class="n">signbn</span><span class="o">/</span><span class="n">rtroi</span><span class="x">)</span>
    <span class="n">buic</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="x">(</span><span class="n">buil</span><span class="o">+</span><span class="n">buir</span><span class="o">+</span><span class="x">(</span><span class="n">muir</span><span class="o">-</span><span class="n">muil</span><span class="x">)</span><span class="o">*</span><span class="n">signbn</span><span class="o">/</span><span class="n">rtroi</span><span class="x">)</span>
    <span class="c"># choose flux</span>
    <span class="k">if</span> <span class="n">sl</span> <span class="o">&gt;</span> <span class="mf">0.0</span>
        <span class="n">Ultmp</span> <span class="o">=</span> <span class="x">[</span><span class="n">rol</span><span class="x">,</span> <span class="n">rol</span><span class="o">*</span><span class="n">vnl</span><span class="x">,</span> <span class="n">rol</span><span class="o">*</span><span class="n">vtl</span><span class="x">,</span> <span class="n">rol</span><span class="o">*</span><span class="n">vul</span><span class="x">,</span> <span class="n">bnl</span><span class="x">,</span> <span class="n">btl</span><span class="x">,</span> <span class="n">bul</span><span class="x">]</span>
        <span class="n">Fresult</span> <span class="o">=</span> <span class="n">Convert</span><span class="o">.</span><span class="n">u_to_f</span><span class="x">(</span><span class="n">Ultmp</span><span class="x">,</span> <span class="n">cs2</span><span class="x">)</span>
    <span class="k">elseif</span> <span class="n">sl</span> <span class="o">&lt;=</span> <span class="mf">0.0</span> <span class="o">&lt;</span> <span class="n">sli</span>
        <span class="n">Ultmp</span> <span class="o">=</span> <span class="x">[</span><span class="n">rol</span><span class="x">,</span> <span class="n">rol</span><span class="o">*</span><span class="n">vnl</span><span class="x">,</span> <span class="n">rol</span><span class="o">*</span><span class="n">vtl</span><span class="x">,</span> <span class="n">rol</span><span class="o">*</span><span class="n">vul</span><span class="x">,</span> <span class="n">bnl</span><span class="x">,</span> <span class="n">btl</span><span class="x">,</span> <span class="n">bul</span><span class="x">]</span>
        <span class="n">Ulitmp</span> <span class="o">=</span> <span class="x">[</span><span class="n">roi</span><span class="x">,</span> <span class="n">roi</span><span class="o">*</span><span class="n">vni</span><span class="x">,</span> <span class="n">mtil</span><span class="x">,</span> <span class="n">muil</span><span class="x">,</span> <span class="n">bnc</span><span class="x">,</span> <span class="n">btil</span><span class="x">,</span> <span class="n">buil</span><span class="x">]</span>
        <span class="n">Fltmp</span> <span class="o">=</span> <span class="n">Convert</span><span class="o">.</span><span class="n">u_to_f</span><span class="x">(</span><span class="n">Ultmp</span><span class="x">,</span> <span class="n">cs2</span><span class="x">)</span>
        <span class="n">Fresult</span> <span class="o">=</span> <span class="n">Fltmp</span> <span class="o">+</span> <span class="n">sl</span> <span class="o">*</span> <span class="x">(</span><span class="n">Ulitmp</span><span class="o">-</span><span class="n">Ultmp</span><span class="x">)</span>
    <span class="k">elseif</span> <span class="n">sli</span> <span class="o">&lt;=</span> <span class="mf">0.0</span> <span class="o">&lt;</span> <span class="n">sri</span>
        <span class="n">Fresult</span> <span class="o">=</span> <span class="x">[</span><span class="n">roi</span><span class="o">*</span><span class="n">vni</span><span class="x">,</span> <span class="n">Fhllmn</span><span class="x">,</span> <span class="n">mtic</span><span class="o">*</span><span class="n">vni</span><span class="o">-</span><span class="n">btic</span><span class="o">*</span><span class="n">bnc</span><span class="x">,</span> <span class="n">muic</span><span class="o">*</span><span class="n">vni</span><span class="o">-</span><span class="n">buic</span><span class="o">*</span><span class="n">bnc</span><span class="x">,</span> <span class="mf">0.0</span><span class="x">,</span> <span class="n">btic</span><span class="o">*</span><span class="n">vni</span><span class="o">-</span><span class="n">bnc</span><span class="o">*</span><span class="n">mtic</span><span class="o">/</span><span class="n">roi</span><span class="x">,</span> <span class="n">buic</span><span class="o">*</span><span class="n">vni</span><span class="o">-</span><span class="n">bnc</span><span class="o">*</span><span class="n">muic</span><span class="o">/</span><span class="n">roi</span><span class="x">]</span>
    <span class="k">elseif</span> <span class="n">sri</span> <span class="o">&lt;=</span> <span class="mf">0.0</span> <span class="o">&lt;</span> <span class="n">sr</span>
        <span class="n">Urtmp</span> <span class="o">=</span> <span class="x">[</span><span class="n">ror</span><span class="x">,</span> <span class="n">ror</span><span class="o">*</span><span class="n">vnr</span><span class="x">,</span> <span class="n">ror</span><span class="o">*</span><span class="n">vtr</span><span class="x">,</span> <span class="n">ror</span><span class="o">*</span><span class="n">vur</span><span class="x">,</span> <span class="n">bnr</span><span class="x">,</span> <span class="n">btr</span><span class="x">,</span> <span class="n">bur</span><span class="x">]</span>
        <span class="n">Uritmp</span> <span class="o">=</span> <span class="x">[</span><span class="n">roi</span><span class="x">,</span> <span class="n">roi</span><span class="o">*</span><span class="n">vni</span><span class="x">,</span> <span class="n">mtir</span><span class="x">,</span> <span class="n">muil</span><span class="x">,</span> <span class="n">bnc</span><span class="x">,</span> <span class="n">btir</span><span class="x">,</span> <span class="n">buir</span><span class="x">]</span>
        <span class="n">Frtmp</span> <span class="o">=</span> <span class="n">Convert</span><span class="o">.</span><span class="n">u_to_f</span><span class="x">(</span><span class="n">Urtmp</span><span class="x">,</span> <span class="n">cs2</span><span class="x">)</span>
        <span class="n">Fresult</span> <span class="o">=</span> <span class="n">Frtmp</span> <span class="o">+</span> <span class="n">sr</span> <span class="o">*</span> <span class="x">(</span><span class="n">Uritmp</span><span class="o">-</span><span class="n">Urtmp</span><span class="x">)</span>
    <span class="k">else</span>
        <span class="n">Urtmp</span> <span class="o">=</span> <span class="x">[</span><span class="n">ror</span><span class="x">,</span> <span class="n">ror</span><span class="o">*</span><span class="n">vnr</span><span class="x">,</span> <span class="n">ror</span><span class="o">*</span><span class="n">vtr</span><span class="x">,</span> <span class="n">ror</span><span class="o">*</span><span class="n">vur</span><span class="x">,</span> <span class="n">bnr</span><span class="x">,</span> <span class="n">btr</span><span class="x">,</span> <span class="n">bur</span><span class="x">]</span>
        <span class="n">Fresult</span> <span class="o">=</span> <span class="n">Convert</span><span class="o">.</span><span class="n">u_to_f</span><span class="x">(</span><span class="n">Urtmp</span><span class="x">,</span> <span class="n">cs2</span><span class="x">)</span>
    <span class="k">end</span>
    <span class="k">return</span> <span class="n">Fresult</span>
<span class="k">end</span>

<span class="k">function</span><span class="nf"> hlld!</span><span class="x">(</span><span class="n">F</span><span class="o">::</span><span class="kt">Array</span><span class="x">{</span><span class="kt">Float64</span><span class="x">,</span> <span class="mi">2</span><span class="x">},</span> <span class="n">Vl</span><span class="o">::</span><span class="kt">Array</span><span class="x">{</span><span class="kt">Float64</span><span class="x">,</span> <span class="mi">2</span><span class="x">},</span> <span class="n">Vr</span><span class="o">::</span><span class="kt">Array</span><span class="x">{</span><span class="kt">Float64</span><span class="x">,</span> <span class="mi">2</span><span class="x">},</span> <span class="n">nxmax</span><span class="o">::</span><span class="kt">Int64</span><span class="x">,</span> <span class="n">cs2</span><span class="o">::</span><span class="kt">Float64</span><span class="x">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="k">in</span> <span class="mi">1</span><span class="o">:</span><span class="n">nxmax</span><span class="o">-</span><span class="mi">1</span>
        <span class="c"># set primitive variables at left side</span>
        <span class="n">rol</span> <span class="o">=</span> <span class="n">Vl</span><span class="x">[</span><span class="mi">1</span><span class="x">,</span> <span class="n">i</span><span class="x">]</span>
        <span class="n">vnl</span> <span class="o">=</span> <span class="n">Vl</span><span class="x">[</span><span class="mi">2</span><span class="x">,</span> <span class="n">i</span><span class="x">]</span>
        <span class="n">vtl</span> <span class="o">=</span> <span class="n">Vl</span><span class="x">[</span><span class="mi">3</span><span class="x">,</span> <span class="n">i</span><span class="x">]</span>
        <span class="n">vul</span> <span class="o">=</span> <span class="n">Vl</span><span class="x">[</span><span class="mi">4</span><span class="x">,</span> <span class="n">i</span><span class="x">]</span>
        <span class="n">bnl</span> <span class="o">=</span> <span class="n">Vl</span><span class="x">[</span><span class="mi">5</span><span class="x">,</span> <span class="n">i</span><span class="x">]</span>
        <span class="n">btl</span> <span class="o">=</span> <span class="n">Vl</span><span class="x">[</span><span class="mi">6</span><span class="x">,</span> <span class="n">i</span><span class="x">]</span>
        <span class="n">bul</span> <span class="o">=</span> <span class="n">Vl</span><span class="x">[</span><span class="mi">7</span><span class="x">,</span> <span class="n">i</span><span class="x">]</span>
        <span class="n">prl</span> <span class="o">=</span> <span class="n">cs2</span> <span class="o">*</span> <span class="n">rol</span>
        <span class="c"># set primitive variables at right side</span>
        <span class="n">ror</span> <span class="o">=</span> <span class="n">Vr</span><span class="x">[</span><span class="mi">1</span><span class="x">,</span> <span class="n">i</span><span class="x">]</span>
        <span class="n">vnr</span> <span class="o">=</span> <span class="n">Vr</span><span class="x">[</span><span class="mi">2</span><span class="x">,</span> <span class="n">i</span><span class="x">]</span>
        <span class="n">vtr</span> <span class="o">=</span> <span class="n">Vr</span><span class="x">[</span><span class="mi">3</span><span class="x">,</span> <span class="n">i</span><span class="x">]</span>
        <span class="n">vur</span> <span class="o">=</span> <span class="n">Vr</span><span class="x">[</span><span class="mi">4</span><span class="x">,</span> <span class="n">i</span><span class="x">]</span>
        <span class="n">bnr</span> <span class="o">=</span> <span class="n">Vr</span><span class="x">[</span><span class="mi">5</span><span class="x">,</span> <span class="n">i</span><span class="x">]</span>
        <span class="n">btr</span> <span class="o">=</span> <span class="n">Vr</span><span class="x">[</span><span class="mi">6</span><span class="x">,</span> <span class="n">i</span><span class="x">]</span>
        <span class="n">bur</span> <span class="o">=</span> <span class="n">Vr</span><span class="x">[</span><span class="mi">7</span><span class="x">,</span> <span class="n">i</span><span class="x">]</span>
        <span class="n">prr</span> <span class="o">=</span> <span class="n">cs2</span> <span class="o">*</span> <span class="n">ror</span>
        <span class="c"># compute HLLD flux </span>
        <span class="n">Fresult</span> <span class="o">=</span> <span class="n">hlld_core</span><span class="x">(</span><span class="n">rol</span><span class="x">,</span> <span class="n">vnl</span><span class="x">,</span> <span class="n">vtl</span><span class="x">,</span> <span class="n">vul</span><span class="x">,</span> <span class="n">prl</span><span class="x">,</span> <span class="n">bnl</span><span class="x">,</span> <span class="n">btl</span><span class="x">,</span> <span class="n">bul</span><span class="x">,</span> <span class="n">ror</span><span class="x">,</span> <span class="n">vnr</span><span class="x">,</span> <span class="n">vtr</span><span class="x">,</span> <span class="n">vur</span><span class="x">,</span> <span class="n">prr</span><span class="x">,</span> <span class="n">bnr</span><span class="x">,</span> <span class="n">btr</span><span class="x">,</span> <span class="n">bur</span><span class="x">,</span> <span class="n">cs2</span><span class="x">)</span>
        <span class="c"># convert flux and input to F</span>
        <span class="n">F</span><span class="x">[</span><span class="o">:</span><span class="x">,</span> <span class="n">i</span><span class="x">]</span> <span class="o">=</span> <span class="n">Fresult</span>
    <span class="k">end</span>
<span class="k">end</span>
</code></pre></div></div>

<p>ä¾‹ãˆã°å…¨åœ§åŠ›\(P_\mathrm{tot} = P_\mathrm{gas} + \frac{1}{2} B^2\)ã‚’è¨ˆç®—ã™ã‚‹éš›ã«ã¯ã€ã‚¬ã‚¹åœ§\(P_\mathrm{gas}\)ãŒå¿…è¦ã«ãªã‚Šã¾ã™ã€‚ãã®å ´åˆã«ã¯ä»¥ä¸‹ã®é–¢ä¿‚å¼ã‚’ç”¨ã„ã¾ã™ã€‚</p>

\[C_s^2 = \frac{P_\mathrm{gas}}{\rho} \ \Longrightarrow \ 
P_\mathrm{gas} = C_s^2 \rho \tag{21}\]

<p>ç­‰æ¸©ã®å ´åˆã€<a href="/mhd/sound_wave">éŸ³é€Ÿ\(C_s\)</a>ã¯ä¸€å®šãƒ»ä¸€æ§˜ãªå€¤ã«ãªã‚Šã¾ã™ã€‚ã“ã®å€¤ã‚’ã‚ã‚‰ã‹ã˜ã‚åˆæœŸæ¡ä»¶ã¨ã—ã¦å®šã‚ã¦ãŠãã“ã¨ã§ã€è¨ˆç®—ã‚’é€²ã‚ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚</p>

<h1 id="å‚è€ƒæ–‡çŒ®">å‚è€ƒæ–‡çŒ®</h1>

<ul>
  <li><a href="https://www.sciencedirect.com/science/article/pii/S0021999105001142?via%3Dihub">Miyoshi &amp; Kusano, 2005, â€œA multi-state HLL approximate Riemann solver for ideal magnetohydrodynamicsâ€</a></li>
  <li><a href="https://arxiv.org/abs/astro-ph/9404074">Ryu &amp; Jones, 1994, â€œNumerical Magnetohydrodynamics in Astrophysics: Algorithm and Tests for One-Dimensional Flowâ€</a></li>
  <li><a href="https://iopscience.iop.org/article/10.1086/588755">Stone et al., 2008, â€œAthena: A New Code for Astrophysical MHDâ€</a></li>
  <li><a href="https://qiita.com/ur_kinsk/items/1893602e2ee73060b207">Qiitaè¨˜äº‹, ç£æ°—æµä½“ã®æ•°å€¤è¨ˆç®—ã§éŠã¶</a></li>
  <li><a href="http://www.astro.phys.s.chiba-u.ac.jp/cans/doc/riemann.html">CANS+ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ, ç£æ°—æµä½“åŠ›å­¦æ–¹ç¨‹å¼ã«å¯¾ã™ã‚‹è¿‘ä¼¼ãƒªãƒ¼ãƒãƒ³è§£æ³•</a></li>
</ul>

<script async="" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-9131160172347693" crossorigin="anonymous"></script>

<!-- for_jekyll -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-9131160172347693" data-ad-slot="3528582902" data-ad-format="auto" data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script></p>

:ET