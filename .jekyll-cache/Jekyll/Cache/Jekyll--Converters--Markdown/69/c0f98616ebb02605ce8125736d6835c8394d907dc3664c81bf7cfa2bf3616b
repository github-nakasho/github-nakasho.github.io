I"\
<details open="">
  <summary class="text-delta">
    Table of contents
  </summary>
<ol id="markdown-toc">
  <li><a href="#多数の局所解があるような連続ポテンシャルでの量子古典アニーリング" id="markdown-toc-多数の局所解があるような連続ポテンシャルでの量子古典アニーリング">多数の局所解があるような連続ポテンシャルでの量子・古典アニーリング</a>    <ol>
      <li><a href="#概要" id="markdown-toc-概要">概要</a></li>
      <li><a href="#i-研究背景-連続最適化における量子アニーリング" id="markdown-toc-i-研究背景-連続最適化における量子アニーリング">I. 研究背景: 連続最適化における量子アニーリング</a></li>
      <li><a href="#ii-問題設定" id="markdown-toc-ii-問題設定">II. 問題設定</a>        <ol>
          <li><a href="#a-連続最適化に用いるポテンシャル" id="markdown-toc-a-連続最適化に用いるポテンシャル">A. 連続最適化に用いるポテンシャル</a></li>
          <li><a href="#b-局所解の数" id="markdown-toc-b-局所解の数">B. 局所解の数</a></li>
        </ol>
      </li>
      <li><a href="#iii-量子力学的な基底状態と古典的な熱平衡状態の比較" id="markdown-toc-iii-量子力学的な基底状態と古典的な熱平衡状態の比較">III. 量子力学的な基底状態と古典的な熱平衡状態の比較</a>        <ol>
          <li><a href="#a-エネルギーによる比較" id="markdown-toc-a-エネルギーによる比較">A. エネルギーによる比較</a></li>
          <li><a href="#b-エネルギーギャップから言えること" id="markdown-toc-b-エネルギーギャップから言えること">B. エネルギーギャップから言えること</a></li>
        </ol>
      </li>
      <li><a href="#iv-線形のスケジューリングによる量子アニーリング" id="markdown-toc-iv-線形のスケジューリングによる量子アニーリング">IV. 線形のスケジューリングによる量子アニーリング</a>        <ol>
          <li><a href="#a-線形スケジュール" id="markdown-toc-a-線形スケジュール">A. 線形スケジュール</a></li>
          <li><a href="#b-アニーリングの段階" id="markdown-toc-b-アニーリングの段階">B. アニーリングの段階</a></li>
        </ol>
      </li>
    </ol>
  </li>
</ol>

</details>

<script async="" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-9131160172347693" crossorigin="anonymous"></script>

<!-- for_jekyll -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-9131160172347693" data-ad-slot="3528582902" data-ad-format="auto" data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script></p>

<h1 id="多数の局所解があるような連続ポテンシャルでの量子古典アニーリング">多数の局所解があるような連続ポテンシャルでの量子・古典アニーリング</h1>

<h2 id="概要">概要</h2>

<p>こちらは<a href="https://arxiv.org/abs/2203.11417">Koh &amp; Nishimori, 2022, “Quantum and classical annealing in a continuous space with multiple local minima”</a>を読み、理解を深めるためのメモです。</p>

<h2 id="i-研究背景-連続最適化における量子アニーリング">I. 研究背景: 連続最適化における量子アニーリング</h2>

<p>量子アニーリング(以下QA)はバイナリ変数$x={ 0, 1 }$(もしくはスピン変数$\sigma={-1, 1}$)で表現される離散最適化問題を解くために用いられる、量子力学に基づいたメタヒューリスティックです。最近の先行研究、例えば<a href="https://journals.aps.org/prxquantum/abstract/10.1103/PRXQuantum.2.010349">Abel &amp; Spannowsky, 2021, “Quantum-Field-Theoretic Simulation Platform for Observing the Fate of the False Vacuum”</a>ではdomain-wall encodingと呼ばれる手法を応用し、近似的に(しかし正確に)QFTでの連続自由度をイジングスピンで表現しています。</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>他にもdomain-wall encodingの有用性に関しては、QAであれば例えば[Chen et al., 2021, “Performance of Domain-Wall Encoding for Quantum Annealing”](https://ieeexplore.ieee.org/document/9485068),   
そして量子回路のQAOAであれば例えば[Chancellor, 2019, “Domain wall encoding of discrete variables for quantum annealing and QAOA”](https://iopscience.iop.org/article/10.1088/2058-9565/ab33c2)などで示されています。
</code></pre></div></div>

<p>先程と同じ著者らの研究である<a href="https://arxiv.org/abs/2105.13945">Abel et al., 2021, “Quantum Optimization of Complex Systems with a Quantum Annealer”</a>では、複数の鋭い局所解が存在する複雑なエネルギーランドスケープの場合にこれを拡張し、D-WaveでのQAが、シミュレーテッド・アニーリング(以下SA)を含む古典アルゴリズムよりも優れた性能を達成することを示しました。</p>

<p>上図のように、\((\psi, \phi) = \mathbf{0}\)にある大域最適解の周囲に局所解が配置されているようなポテンシャルを用意します。これにおいて、古典(Nelder-Mead, 勾配降下, SA)とQAを比較したものが下図です(画像はどちらもAbel et al., 2021)。</p>

<p>図の左3つのパネルは古典での結果、一番右のパネルがQAの結果です。QAでは中心に位置する大域最適解に高い確率で到達できていることがわかります。ここからもわかるように、このQAの力を連続最適化にも応用できれば、数多くの社会問題を解決に導くことができると考えられます。</p>

<p>実はKoh &amp; Nishimori, 2022の研究に最も大きく関わりのある論文が存在します。それは<a href="https://journals.aps.org/prb/abstract/10.1103/PhysRevB.72.014303">Stella et al., 2005, “Optimization by quantum annealing: Lesson from simple cases”</a>という論文です。この論文ではシミュレーテッド・量子アニーリング(以下SQA)と古典SAとの性能を、様々な連続ポテンシャルで比較したというものです。Stella et al., 2005の結論としては、「量子を用いたアプローチは古典よりも速く大域最適解に収束する」というものです。調和振動子型のポテンシャルと2重井戸型ポテンシャルでその有効性が数値・解析的に求められています。しかし<a href="https://iopscience.iop.org/article/10.1088/0305-4470/24/3/008/meta">Shinomoto &amp; Kabashima, 1991, “Finite time scalling of energy in simulated annealing”</a>で導入された多数の局所解を持つポテンシャルに対しての古典的な解析においては、Stella et al., 2005は現象論的に粗視化されたモデルが採用されています。これは離散的な局所解の位置のみを考慮し、解析を容易にするために局所解間の距離を無視した連続極限を取るというものです。この解析手法には当然ながら近似が含まれており、その正当性は古典的な場合の長時間・低温極限では必ずしも明らかではありません。この考察はもちろん量子にも言えることであり、近似の適用範囲には慎重な吟味が必要となります。またこのような近似を用いると、量子力学による局所解から大域最適解(最小エネルギー)への確率の流れの理解を直感的に行うことが難しくなる、という難点も生まれます。</p>

<p>このような背景から、多くの局所解を持つShinomoto-Kabashima的な連続ポテンシャルでの最適化問題を古典SAおよびQAでの直接計算を行い、この系での収束性などの研究を行なったという論文です。</p>

<h2 id="ii-問題設定">II. 問題設定</h2>

<h3 id="a-連続最適化に用いるポテンシャル">A. 連続最適化に用いるポテンシャル</h3>

<p>古典手法とQAを用いた最適化には、以下のShinomoto-Kabashimaポテンシャルを用います。</p>

\[V_\mathrm{SK}(x) = \frac{1}{2} kx^2 + \frac{h_0}{2} \left\{ 1-\cos \left( \frac{2\pi x}{w_0}\right) \right\} \tag{1}\]

<p>第一項の調和振動子的なポテンシャルがポテンシャルの概形を表しています。そこに\(h_0, w_0\)をパラメータとして、局所解を表現するcos項を導入しています。\(h_0\)は局所解どうしのエネルギーバリアの高さ、そして\(w_0\)は局所解どうしの距離を表すパラメータです。下図は\(k=1, h_0=w_0=0.2\)の場合の\(V_\mathrm{SK}\)を示しています。</p>

<p>(1)式のポテンシャルは第1項のために、\(x\)が大きい部分では局所解の影響が小さくなります。よって局所解の総数は有限と考えて差し支えありません(重要なのは大域最適解\(x=0\)付近での挙動であり、長時間のアニーリングでは\(\vert x \vert \gg 1\)の部分の状態存在確率は限りなく小さいため、このような取り扱いをします)。このポテンシャルは数値計算実装が容易でありながらも、本質的に他のポテンシャルでの漸近的な振る舞いを表すことができます。</p>

<h3 id="b-局所解の数">B. 局所解の数</h3>

<p>ここで局所解の数\(N_\mathrm{min}\)について触れておきましょう。上図の\(h_0 = w_0 = 0.2\)の場合には、\(N_\mathrm{min} = 15\)となります。この\(N_\mathrm{min}\)の数が大きいほど最適化が難しくなるため、下図のように\(N_\mathrm{min}\)の相図から\(V_\mathrm{SK}(x)\)での最適化の難しさを予想することができます。</p>

<p>\(N_\mathrm{min} = (一定)\)の領域においては、\(h_0, w_0\)のどちらか(あるいは両方)が大きいほど最適化が難しいと言う特徴を持ちます。この位相空間全体で数値計算を行うことは現実的ではないので、今回は代表として\((h_0, w_0) = (0.2, 0.2)\)の場合に数値計算を行います(簡単すぎず、また計算時間が恐ろしくかかるような難しさではない、ちょうど良く本質を理解できるインスタンスを選んでいます)。</p>

<h2 id="iii-量子力学的な基底状態と古典的な熱平衡状態の比較">III. 量子力学的な基底状態と古典的な熱平衡状態の比較</h2>

<h3 id="a-エネルギーによる比較">A. エネルギーによる比較</h3>

<p>アニーリングに入る前に、時間に依存しないシュレディンガー方程式から言えることを考察してみましょう。この系のハミルトニアンは</p>

\[H = \frac{p^2}{2m} + V_\mathrm{SK} (x) \tag{2}\]

<p>のように記述されます。ここで\(p, m\)はそれぞれ粒子の運動量と質量です。\(p\)は、量子力学では\(\frac{\hbar} {i} \frac{\partial}{\partial x}\)のような運動量演算子、そして\(x\)は位置演算子となります。</p>

<p>古典の場合、この系は分配関数を用いた統計力学の枠組みで理解することができます。この系の分配関数は</p>

\[Z(\beta) = \frac{1}{h} \int_{-\infty}^\infty dp \int_{-\infty}^\infty dx e^{-\beta H}\]

<p>のようになります。ここで\(\beta=1/T\)は逆温度(\(k_B = 1\))、係数の\(1/h\)は不確定性関係から1つの状態が占める体積を表します。運動量の部分\(e^{- \beta p^2 / 2m}\)はガウス積分を実行できて</p>

\[Z(\beta) = C \int_{-\infty}^\infty e^{-\beta V_\mathrm{SK}(x)} dx \quad (C: 定数)\]

<p>を得ます。ここから位置\(x\)で状態を見出す確率を表す、ボルツマン分布は</p>

\[\varrho (x) = \frac{e^{-\beta V_\mathrm{SK}(x)}}{Z(\beta)} \tag{3}\]

<p>のようになります。今注目したいのは(内部)エネルギーについてなので、これを計算しましょう。このポテンシャルにおけるエネルギーは</p>

\[U(\beta) = \frac{1}{2\beta} + \langle V_\mathrm{SK} (x)\rangle_\beta \tag{4}\]

<p>のようになります。第1項は運動エネルギー\(p^2 / 2m \simeq k_B T \simeq 1/\beta\)による寄与、そして第2項はポテンシャルによる平均エネルギーで</p>

\[\langle V_\mathrm{SK} (x) \rangle_\beta = \int_{-\infty}^\infty V_\mathrm{SK}(x) \varrho (x) dx \tag{5}\]

<p>と表されます。\(\langle \cdots \rangle_\beta\)はボルツマン分布(3)式を通して\(\beta\)に依存することを表現しています。量子的な枠組みと異なり、古典的なエネルギーはそのアニーリングにおいて\(\beta\)依存性が存在します。</p>

<p>次の図はあるエネルギーにおける量子と古典での存在確率の比較です。</p>

<table>
  <tbody>
    <tr>
      <td>(a)は量子力学において、基底エネルギー\(E_0 \sim 0.6\) (青線)のときの、ある位置における存在確率密度$$</td>
      <td>\langle x</td>
      <td>E_0 \rangle</td>
      <td>^2\(を赤線で描画したものです。存在確率は局所解に局在化していないことがわかります。(b)は\)U\sim 0.6\(でのボルツマン分布\)\varrho(x)\(を緑線で示しています。振動のようなものが見えますが、大局的には量子と同じ概形をしています。このことから\)V_\mathrm{SK}(x)$$のポテンシャルにおいて、高エネルギーになれば量子と古典は等価なものになると言えるでしょう。</td>
    </tr>
  </tbody>
</table>

<p>しかし\(E_0 \sim 0.1, U\sim 0.1\)では、量子と古典では振る舞いが大きく異なります。</p>

<p>量子では大域最適解\(x=0\)に集まっているのに対し、古典はそれ以外の局所解にも存在確率が分離しています。さらに低エネルギーの0.01ではボルツマン分布には2つのspurious(擬似的？)な凖安定モードがより顕著に現れます。これら2つのモードが凖安定(長寿命)な理由としては、\(x=0\)に存在する主モードに移動する確率チャンネルが完全に0となり、取り残されてしまうためです。</p>

<p>これらから、量子の方が古典よりも最適化により向いていると見ることができます。古典力学的な描像としては、粒子の全エネルぎーがポテンシャルエネルギーより小さな領域ではペナルティを受けます。このためペナルティをなるべく避けるために局所解にとどまるような平衡状態の分布が形成されると言えるでしょう。しかし量子力学的な描像では、古典では禁止されている領域にトンネル効果を通して到達することができるため、最適解付近に収束することができると言えます。</p>

<p>次に、質量\(m\)と温度(逆温度\(\beta\))に対する量子と古典のエネルギーの変化について見てみましょう。</p>

<p>上図のパネル(a)は質量\(m\)に対する量子的な基底状態エネルギー固有値\(E_0\)のグラフを赤線で示しています。同時にInner oscillator(\(k=99.696\))とouter oscillator(\(k=1\))における零点振動エネルギー\(\frac{1}{2} \sqrt{k/m}\)も青線で表示しています。\(V_\mathrm{SK} (x)\)においてポテンシャルの概形を成している\(\frac{1}{2} k x^2\)による調和振動をouter、そして\(x=0\)の大域最適解近傍のポテンシャルを2次関数で近似したときの調和振動をinnerと記述しています。すると小質量極限ではouter, 大質量極限ではinnerで良く記述されることがわかります。小質量極限と大質量極限の中間にあたる遷移領域が量子系の重要な領域を示しています。</p>

<p>パネル(b)は逆温度\(\beta\)に対する古典的なエネルギー依存性を緑線で示したものです。このグラフでは等分配の定理から導かれる、バネ定数に依存しない内部エネルギーも青線で示しています。量子と同じく、\(\beta\)の無限小・無限大極限では調和振動子によく一致していることがわかります。一方で、\(V_\mathrm{SK}(x)\)の非自明な部分が、黄色で色付けされた超過エネルギーとして表現されています。この超過エネルギーが現れる部分が古典系での重要な領域です。</p>

<h3 id="b-エネルギーギャップから言えること">B. エネルギーギャップから言えること</h3>

<p>もう一つの大きな指標として、量子力学における系の第一励起状態とのエネルギーギャップ\(\Delta = E_1 - E_0\)があります。QAにおいて、エネルギーギャップの高速な0への収束は一次相転移を表しており、これは長いアニーリング時間を必要とします。</p>

<p>上図は\(V_\mathrm{SK}(x)\)における\(\Delta\)を\(m\)の関数として表したものです。ここでもinnerとouter oscillatorの2つの青線間での遷移が起こっていることがわかります。エネルギーギャップは2つの振動子の間で特に狭まるような挙動を示していません。そのため、QAではこの系は多項式時間で解けることが示唆されます。そのため、これは計算量の観点からは決して難しい問題とは言えませんが、この問題設定でQAと古典の比較を行います。またここでは、第一励起状態が多重縮退を伴う、\(\frac{\partial \Delta}{\partial m}\)がほぼ0となる遷移区間について言及しています。これは”flat gap”と呼ばれています。これは\(h_0 = w_0 = 0.2\)のみに限った特徴ではなく、\(h_0 - w_0\)相図上で普遍的に存在する特徴です。</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>“Flat gap”に関する詳細な議論は論文のAppendix Aでされていますが、ここでは割愛します。
</code></pre></div></div>

<h2 id="iv-線形のスケジューリングによる量子アニーリング">IV. 線形のスケジューリングによる量子アニーリング</h2>

<h3 id="a-線形スケジュール">A. 線形スケジュール</h3>

<p>ここではまず線形のQAスケジュールを用いた場合のダイナミクスを解析していきましょう。\(V_\mathrm{SK}(x)\)のポテンシャル中でのQAは、以下の時間に依存したSchrödinger方程式を解くことで行われます。</p>

\[\left( i\hbar \frac{\partial}{\partial t} + \frac{\hbar^2}{2m(t)} \frac{\partial^2}{\partial x^2} - V_\mathrm{SK} (x) \right) \psi (x, t) = 0 \tag{6}\]

<p>ここで\(\psi(x, t)\)は波動関数、そして時間に依存した粒子質量\(m(t)\)はアニーリングスケジュールを表します。本来なら、質量が0(すなわち運動エネルギーによる項が支配的である状態)からアニーリングを始め、質量を徐々に無限大に大きくしていくことで\(V_\mathrm{SK}(x)\)が支配的な状態に移していきます。\(m(t)\)が無限大まで大きくなる速度が十分に遅ければ、断熱定理から、初期に基底状態の波動関数を用意することで\(V_\mathrm{SK}(x)\)の基底状態を得ることができます。</p>

<p>ここで総アニーリング時間を$T$として、\(0 \leq t \leq T\)での時間発展を行います。以下のように、質量\(m(t)\)が時間の1次関数で与えられるとしましょう。</p>

\[m^{(1)} (t) = (m_f - m_i) \frac{t}{T} + m_i \tag{7}\]

<p>ここで\(m_i, m_f\)はそれぞれ\(t=0, t=T\)での粒子質量です。\(m_i\)と\(m_f\)を固定したとき、\(T\)はアニーリング速度を表す変数となります。当然、大きな\(T\)はゆっくりアニーリングを行うことに対応します。実は<a href="https://journals.jps.jp/doi/10.1143/JPSJ.76.104001">Morita, 2007, “Faster Annealing Schedules for Quantum Annealing”</a>で示されているように、十分大きなアニーリング時間では、アニーリング開始時と終了時におけるアニーリングスケジュールの導関数によって終状態での励起状態確率が決まります。このことからアニーリングスケジュールの陽的な形、つまり(7)式での質量変化や運動エネルギーの係数\(\Gamma(t) \equiv \hbar /2m\)の変化は特に重要ではありません。(7)式のような線形スケジューリングでは、開始・終了時の両方で有限の微分の値となります。</p>

<h3 id="b-アニーリングの段階">B. アニーリングの段階</h3>

<p>原理的には、(7)式において任意の小ささの\(m_i\)と任意の大きさの\(m_f\)を用いることができます。例えばFig. 3(a)のように非常に高いエネルギーからスタートし、Fig. 4(c)のように非常に低いエネルギーに向かってアニーリングを進めることもできます。しかし、そのように大きなエネルギー差を課してしまうと、波動関数を表現するために必要なグリッド数が巨大になり、計算時間が現実的ではなくなってしまいます。それと同時にグリッド数は終状態を十分な解像度で計算するほど十分な量が必要です。この論文では2048グリッド点を用いてQAのシミュレーションを行い、\(m_i, m_f\)はこのグリッド数でも十分計算が可能な範囲で選んでいます。</p>

<p>上表はFig. 5で縦線として描かれている粒子質量の値です。$m_a$と$m_d$の値が6桁も異なっていることがわかります。この大きな質量差を扱うために、各段階でアニーリングを実行します。表にある通り、$m_a-m_b$をステージ1, $m_b-m_c$をステージ2, $m_c-m_d$をステージ3と定義します。ステージ1はouter期, ステージ2はouterからinnerへの遷移期, そしてステージ3はinner期、のように考えられるとIII章の議論からわかります。ステージ1では、FIg. 3(a)とFig. 4(a)の青線で示されているように、エネルギーがとても高い状態から、$V_\mathrm{SK}(x)$の局所解どうしのバリア障壁の半分の高さあたりまでエネルギーを減少させています。ステージ2ではさらに大域最適解の横にある一番低いエネルギーの局所解2つと同程度までエネルギーを減少させています。最後にステージ3でエネルギーを大域最適解でのポテンシャルエネルギーまで下げていきます。</p>

<script async="" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-9131160172347693" crossorigin="anonymous"></script>

<!-- for_jekyll -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-9131160172347693" data-ad-slot="3528582902" data-ad-format="auto" data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script></p>
:ET