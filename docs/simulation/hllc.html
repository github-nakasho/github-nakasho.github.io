<!DOCTYPE html> <html lang="en-US"> <head> <meta charset="UTF-8"> <meta http-equiv="X-UA-Compatible" content="IE=Edge"> <title>HLLC法 - 宇宙物理メモ</title> <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon"> <link rel="stylesheet" href="/assets/css/just-the-docs-default.css"> <script async src="https://www.googletagmanager.com/gtag/js?id=G-C550SVR5KQ"></script> <script> window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-C550SVR5KQ', { 'anonymize_ip': true }); </script> <script type="text/javascript" src="/assets/js/vendor/lunr.min.js"></script> <script type="text/javascript" src="/assets/js/just-the-docs.js"></script> <meta name="viewport" content="width=device-width, initial-scale=1"> <!-- Begin Jekyll SEO tag v2.7.1 --> <title>HLLC法 | 宇宙物理メモ</title> <meta name="generator" content="Jekyll v4.2.1" /> <meta property="og:title" content="HLLC法" /> <meta property="og:locale" content="en_US" /> <meta name="description" content="An astrophysics and physics memo." /> <meta property="og:description" content="An astrophysics and physics memo." /> <link rel="canonical" href="http://localhost:4000/simulation/hllc" /> <meta property="og:url" content="http://localhost:4000/simulation/hllc" /> <meta property="og:site_name" content="宇宙物理メモ" /> <meta name="twitter:card" content="summary" /> <meta property="twitter:title" content="HLLC法" /> <script type="application/ld+json"> {"headline":"HLLC法","url":"http://localhost:4000/simulation/hllc","publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"http://localhost:4000/assets/images/logo.png"}},"@type":"WebPage","description":"An astrophysics and physics memo.","@context":"https://schema.org"}</script> <!-- End Jekyll SEO tag --> <script> MathJax = { tex: { tags: 'ams', packages: {'[+]': ['textmacros']}, }, loader: { load: ['[tex]/textmacros'] } }; </script> <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script type="text/javascript" id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"> </script> </head> <body> <svg xmlns="http://www.w3.org/2000/svg" style="display: none;"> <symbol id="svg-link" viewBox="0 0 24 24"> <title>Link</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link"> <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path> </svg> </symbol> <symbol id="svg-search" viewBox="0 0 24 24"> <title>Search</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search"> <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line> </svg> </symbol> <symbol id="svg-menu" viewBox="0 0 24 24"> <title>Menu</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"> <line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line> </svg> </symbol> <symbol id="svg-arrow-right" viewBox="0 0 24 24"> <title>Expand</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"> <polyline points="9 18 15 12 9 6"></polyline> </svg> </symbol> <symbol id="svg-doc" viewBox="0 0 24 24"> <title>Document</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file"> <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline> </svg> </symbol> </svg> <div class="side-bar"> <div class="site-header"> <a href="http://localhost:4000/" class="site-title lh-tight"> <div class="site-logo"></div> </a> <a href="#" id="menu-button" class="site-button"> <svg viewBox="0 0 24 24" class="icon"><use xlink:href="#svg-menu"></use></svg> </a> </div> <nav role="navigation" aria-label="Main" id="site-nav" class="site-nav"> <ul class="nav-list"><li class="nav-list-item"><a href="http://localhost:4000/" class="nav-list-link">ホーム</a></li><li class="nav-list-item"><a href="http://localhost:4000/astromap" class="nav-list-link">宇宙物理学Map</a></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="http://localhost:4000/astroph" class="nav-list-link">astroph</a><ul class="nav-list "><li class="nav-list-item "><a href="http://localhost:4000/astroph/2020" class="nav-list-link">2020年振り返り</a></li><li class="nav-list-item "><a href="http://localhost:4000/astroph/2021" class="nav-list-link">2021年振り返り</a></li><li class="nav-list-item "><a href="http://localhost:4000/astroph/gn_z11_flash" class="nav-list-link">GN-z11-flashまとめ</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="http://localhost:4000/quantph" class="nav-list-link">quantph</a><ul class="nav-list "><li class="nav-list-item "><a href="http://localhost:4000/quantph/2021" class="nav-list-link">2021年振り返り</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="http://localhost:4000/mhd" class="nav-list-link">宇宙磁気流体力学</a><ul class="nav-list "><li class="nav-list-item "><a href="http://localhost:4000/mhd/euler_lagrange" class="nav-list-link">ラグランジュ微分とオイラー微分</a></li><li class="nav-list-item "><a href="http://localhost:4000/mhd/continuity" class="nav-list-link">連続の式</a></li><li class="nav-list-item "><a href="http://localhost:4000/mhd/momentum" class="nav-list-link">運動量保存則</a></li><li class="nav-list-item "><a href="http://localhost:4000/mhd/ohm" class="nav-list-link">一般化されたオームの法則</a></li><li class="nav-list-item "><a href="http://localhost:4000/mhd/induction" class="nav-list-link">誘導方程式</a></li><li class="nav-list-item "><a href="http://localhost:4000/mhd/energy" class="nav-list-link">エネルギー保存則</a></li><li class="nav-list-item "><a href="http://localhost:4000/mhd/mri" class="nav-list-link">磁気回転不安定性</a></li><li class="nav-list-item "><a href="http://localhost:4000/mhd/rayleigh_criterion" class="nav-list-link">レイリーの基準</a></li><li class="nav-list-item "><a href="http://localhost:4000/mhd/parker" class="nav-list-link">パーカー不安定性</a></li><li class="nav-list-item "><a href="http://localhost:4000/mhd/sw" class="nav-list-link">スウィート・パーカーの磁気リコネクション</a></li><li class="nav-list-item "><a href="http://localhost:4000/mhd/petschek" class="nav-list-link">ぺチェックの磁気リコネクション</a></li><li class="nav-list-item "><a href="http://localhost:4000/mhd/acoustic_gravity" class="nav-list-link">音響重力波</a></li><li class="nav-list-item "><a href="http://localhost:4000/mhd/torsional_alfven" class="nav-list-link">ねじれアルヴェーン波</a></li><li class="nav-list-item "><a href="http://localhost:4000/mhd/alfven_wave" class="nav-list-link">アルヴェーン波</a></li><li class="nav-list-item "><a href="http://localhost:4000/mhd/sound_wave" class="nav-list-link">音波</a></li><li class="nav-list-item "><a href="http://localhost:4000/mhd/shock" class="nav-list-link">衝撃波</a></li><li class="nav-list-item "><a href="http://localhost:4000/mhd/inertial" class="nav-list-link">慣性波</a></li><li class="nav-list-item "><a href="http://localhost:4000/mhd/magneto_inertial" class="nav-list-link">磁気流体慣性波</a></li><li class="nav-list-item "><a href="http://localhost:4000/mhd/magneto_acoustic" class="nav-list-link">磁気音波</a></li><li class="nav-list-item "><a href="http://localhost:4000/mhd/gravity" class="nav-list-link">内部重力波</a></li><li class="nav-list-item "><a href="http://localhost:4000/mhd/sedov" class="nav-list-link">セドフ・テイラー解</a></li><li class="nav-list-item "><a href="http://localhost:4000/mhd/jeans" class="nav-list-link">ジーンズ不安定性</a></li><li class="nav-list-item "><a href="http://localhost:4000/mhd/rotate_jeans" class="nav-list-link">回転する平板での自己重力不安定性</a></li><li class="nav-list-item "><a href="http://localhost:4000/mhd/momentum_cyl" class="nav-list-link">円筒座標系での運動量保存</a></li><li class="nav-list-item "><a href="http://localhost:4000/mhd/momentum_sph" class="nav-list-link">3次元極座標系での運動量保存</a></li><li class="nav-list-item "><a href="http://localhost:4000/mhd/mhd_shock_perp" class="nav-list-link">磁気流体での垂直衝撃波</a></li><li class="nav-list-item "><a href="http://localhost:4000/mhd/induction_cyl_sph" class="nav-list-link">円筒座標系・3次元極座標での誘導方程式</a></li><li class="nav-list-item "><a href="http://localhost:4000/mhd/mhd_shock_oblique" class="nav-list-link">磁気流体での斜め衝撃波</a></li><li class="nav-list-item "><a href="http://localhost:4000/mhd/interchange" class="nav-list-link">磁気流体における交換型不安定性</a></li><li class="nav-list-item "><a href="http://localhost:4000/mhd/rti_khi" class="nav-list-link">レイリー・テイラー、ケルビン・ヘルムホルツ不安定性</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="http://localhost:4000/astroelec" class="nav-list-link">宇宙電磁気学</a><ul class="nav-list "><li class="nav-list-item "><a href="http://localhost:4000/astroelec/coherent_time" class="nav-list-link">観測の不確定性と可干渉時間</a></li><li class="nav-list-item "><a href="http://localhost:4000/astroelec/dalembert" class="nav-list-link">ダランベール方程式の球面波解とその性質</a></li><li class="nav-list-item "><a href="http://localhost:4000/astroelec/em_energy_momentum" class="nav-list-link">電磁場のエネルギーと運動量</a></li><li class="nav-list-item "><a href="http://localhost:4000/astroelec/retarded_green" class="nav-list-link">遅延グリーン関数</a></li><li class="nav-list-item "><a href="http://localhost:4000/astroelec/potential_gauge" class="nav-list-link">電磁ポテンシャルとゲージ変換</a></li><li class="nav-list-item "><a href="http://localhost:4000/astroelec/lienard_wiechart" class="nav-list-link">リエナー・ブィーヒェルトポテンシャル</a></li><li class="nav-list-item "><a href="http://localhost:4000/astroelec/lienard_wiechart_em" class="nav-list-link">LWからの電磁場導出</a></li><li class="nav-list-item "><a href="http://localhost:4000/astroelec/vel_rad" class="nav-list-link">速度場と輻射場の性質</a></li><li class="nav-list-item "><a href="http://localhost:4000/astroelec/lienard_larmor" class="nav-list-link">リエナーの式とラーモアの式</a></li><li class="nav-list-item "><a href="http://localhost:4000/astroelec/rad_fourier" class="nav-list-link">輻射場のフーリエスペクトル</a></li><li class="nav-list-item "><a href="http://localhost:4000/astroelec/emtensor" class="nav-list-link">電磁場テンソル</a></li><li class="nav-list-item "><a href="http://localhost:4000/astroelec/uniform_mag" class="nav-list-link">一様磁場中での荷電粒子の運動</a></li><li class="nav-list-item "><a href="http://localhost:4000/astroelec/uniform_mag_rel" class="nav-list-link">一様磁場中で相対論的な運動をする電子</a></li><li class="nav-list-item "><a href="http://localhost:4000/astroelec/rel_beaming" class="nav-list-link">相対論的ビーミング効果</a></li><li class="nav-list-item "><a href="http://localhost:4000/astroelec/rel_beaming_spectrum" class="nav-list-link">相対論的ビーミング効果により観測される放射スペクトルの変化</a></li><li class="nav-list-item "><a href="http://localhost:4000/astroelec/sync_spectrum" class="nav-list-link">シンクロトロン放射</a></li><li class="nav-list-item "><a href="http://localhost:4000/astroelec/sync_energy_min" class="nav-list-link">Synchrotron energy minimum</a></li><li class="nav-list-item "><a href="http://localhost:4000/astroelec/polarization" class="nav-list-link">偏光</a></li><li class="nav-list-item "><a href="http://localhost:4000/astroelec/stokes" class="nav-list-link">ストークスパラメータ</a></li><li class="nav-list-item "><a href="http://localhost:4000/astroelec/sync_pol" class="nav-list-link">シンクロトロン放射偏光度の厳密な導出</a></li><li class="nav-list-item "><a href="http://localhost:4000/astroelec/thomson" class="nav-list-link">トムソン散乱</a></li><li class="nav-list-item "><a href="http://localhost:4000/astroelec/compton" class="nav-list-link">コンプトン散乱</a></li><li class="nav-list-item "><a href="http://localhost:4000/astroelec/inv_compton" class="nav-list-link">逆コンプトン散乱</a></li><li class="nav-list-item "><a href="http://localhost:4000/astroelec/inv_compton_intensity" class="nav-list-link">逆コンプトン放射強度</a></li><li class="nav-list-item "><a href="http://localhost:4000/astroelec/sz" class="nav-list-link">スニヤエフ・ゼルドヴィッチ効果</a></li><li class="nav-list-item "><a href="http://localhost:4000/astroelec/gcm" class="nav-list-link">RMによる銀河団磁場の推定</a></li><li class="nav-list-item "><a href="http://localhost:4000/astroelec/slmotion" class="nav-list-link">超光速運動</a></li><li class="nav-list-item "><a href="http://localhost:4000/astroelec/cherenkov" class="nav-list-link">チェレンコフ放射</a></li><li class="nav-list-item "><a href="http://localhost:4000/astroelec/transition" class="nav-list-link">遷移放射</a></li><li class="nav-list-item "><a href="http://localhost:4000/astroelec/ssa" class="nav-list-link">Synchrotron Self-Absorption</a></li><li class="nav-list-item "><a href="http://localhost:4000/astroelec/ssc" class="nav-list-link">Synchrotron Self-Comption</a></li><li class="nav-list-item "><a href="http://localhost:4000/astroelec/sc_catastroph" class="nav-list-link">Synchrotron-Compton Catastroph</a></li><li class="nav-list-item "><a href="http://localhost:4000/astroelec/e_mode_b_mode" class="nav-list-link">Eモード、Bモード</a></li><li class="nav-list-item "><a href="http://localhost:4000/astroelec/ics_spectrum" class="nav-list-link">逆コンプトン散乱の放射強度スペクトル</a></li><li class="nav-list-item "><a href="http://localhost:4000/astroelec/interferometer" class="nav-list-link">電波干渉計の基礎</a></li><li class="nav-list-item "><a href="http://localhost:4000/astroelec/spitzer_thermal" class="nav-list-link">スピッツァー熱伝導率</a></li><li class="nav-list-item "><a href="http://localhost:4000/astroelec/cooling" class="nav-list-link">放射冷却率</a></li><li class="nav-list-item "><a href="http://localhost:4000/astroelec/rutherford" class="nav-list-link">ラザフォード散乱</a></li><li class="nav-list-item "><a href="http://localhost:4000/astroelec/heaviside_feynman_jefimenko" class="nav-list-link">電磁場のヘヴィサイド・ファインマン表現とジェフィメンコ方程式</a></li><li class="nav-list-item "><a href="http://localhost:4000/astroelec/multipole_expansion" class="nav-list-link">多重極放射</a></li><li class="nav-list-item "><a href="http://localhost:4000/astroelec/accelerator" class="nav-list-link">様々な円形加速器</a></li><li class="nav-list-item "><a href="http://localhost:4000/astroelec/cosmic_rays" class="nav-list-link">宇宙線スペクトル</a></li><li class="nav-list-item "><a href="http://localhost:4000/astroelec/gzk_cutoff" class="nav-list-link">GZKカットオフ</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="http://localhost:4000/plasma" class="nav-list-link">プラズマ物理学</a><ul class="nav-list "><li class="nav-list-item "><a href="http://localhost:4000/plasma/parameter" class="nav-list-link">プラズマを特徴づけるパラメータ</a></li><li class="nav-list-item "><a href="http://localhost:4000/plasma/debye_huckel" class="nav-list-link">デバイ・ヒュッケルの理論</a></li><li class="nav-list-item "><a href="http://localhost:4000/plasma/yukawa_pot" class="nav-list-link">湯川型ポテンシャルの導出</a></li><li class="nav-list-item "><a href="http://localhost:4000/plasma/propagation_cold" class="nav-list-link">冷たい等方プラズマ中の電磁波の伝播</a></li></ul></li><li class="nav-list-item active"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="http://localhost:4000/simulation" class="nav-list-link">数値計算</a><ul class="nav-list "><li class="nav-list-item "><a href="http://localhost:4000/simulation/normalization" class="nav-list-link">磁気流体方程式の規格化</a></li><li class="nav-list-item "><a href="http://localhost:4000/simulation/hll" class="nav-list-link">HLL法</a></li><li class="nav-list-item active"><a href="http://localhost:4000/simulation/hllc" class="nav-list-link active">HLLC法</a></li><li class="nav-list-item "><a href="http://localhost:4000/simulation/hlld" class="nav-list-link">HLLD法</a></li><li class="nav-list-item "><a href="http://localhost:4000/simulation/iso_hlld" class="nav-list-link">等温HLLD法</a></li><li class="nav-list-item "><a href="http://localhost:4000/simulation/rusanov" class="nav-list-link">Rusanov法</a></li><li class="nav-list-item "><a href="http://localhost:4000/simulation/boundary" class="nav-list-link">境界条件</a></li><li class="nav-list-item "><a href="http://localhost:4000/simulation/magneticfieldline" class="nav-list-link">磁力線の可視化</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="http://localhost:4000/gr" class="nav-list-link">一般相対性理論</a><ul class="nav-list "><li class="nav-list-item "><a href="http://localhost:4000/gr/equivalence_general" class="nav-list-link">等価原理</a></li><li class="nav-list-item "><a href="http://localhost:4000/gr/riemann" class="nav-list-link">Riemann幾何学</a></li><li class="nav-list-item "><a href="http://localhost:4000/gr/metric" class="nav-list-link">メトリックテンソル</a></li><li class="nav-list-item "><a href="http://localhost:4000/gr/vector" class="nav-list-link">反変ベクトルと共変ベクトル</a></li><li class="nav-list-item "><a href="http://localhost:4000/gr/inverse" class="nav-list-link">メトリックの逆行列</a></li><li class="nav-list-item "><a href="http://localhost:4000/gr/volume" class="nav-list-link">固有体積要素</a></li><li class="nav-list-item "><a href="http://localhost:4000/gr/derivative" class="nav-list-link">共変微分</a></li><li class="nav-list-item "><a href="http://localhost:4000/gr/christoffel" class="nav-list-link">Christoffel記号</a></li><li class="nav-list-item "><a href="http://localhost:4000/gr/tensor" class="nav-list-link">テンソルの共変微分</a></li><li class="nav-list-item "><a href="http://localhost:4000/gr/riemann_tensor" class="nav-list-link">Riemannテンソル</a></li><li class="nav-list-item "><a href="http://localhost:4000/gr/bianchi" class="nav-list-link">Bianchiの恒等式</a></li><li class="nav-list-item "><a href="http://localhost:4000/gr/energy_momentum" class="nav-list-link">エネルギー・運動量テンソル</a></li><li class="nav-list-item "><a href="http://localhost:4000/gr/einstein_tensor" class="nav-list-link">Einsteinテンソル</a></li><li class="nav-list-item "><a href="http://localhost:4000/gr/einstein_eq" class="nav-list-link">Einstein方程式</a></li><li class="nav-list-item "><a href="http://localhost:4000/gr/geodesic" class="nav-list-link">測地線方程式</a></li><li class="nav-list-item "><a href="http://localhost:4000/gr/weakfield" class="nav-list-link">弱重力場極限</a></li><li class="nav-list-item "><a href="http://localhost:4000/gr/gw" class="nav-list-link">重力波</a></li><li class="nav-list-item "><a href="http://localhost:4000/gr/quadro" class="nav-list-link">重力波の振幅(四重極公式)</a></li><li class="nav-list-item "><a href="http://localhost:4000/gr/kagra" class="nav-list-link">KAGRA</a></li><li class="nav-list-item "><a href="http://localhost:4000/gr/massless" class="nav-list-link">質量のない粒子の測地線方程式</a></li><li class="nav-list-item "><a href="http://localhost:4000/gr/redshift" class="nav-list-link">重力赤方偏移</a></li><li class="nav-list-item "><a href="http://localhost:4000/gr/lensing" class="nav-list-link">重力レンズ</a></li><li class="nav-list-item "><a href="http://localhost:4000/gr/isco" class="nav-list-link">ISCO</a></li><li class="nav-list-item "><a href="http://localhost:4000/gr/bh_shadow" class="nav-list-link">BH shadow</a></li><li class="nav-list-item "><a href="http://localhost:4000/gr/tov" class="nav-list-link">TOV方程式</a></li><li class="nav-list-item "><a href="http://localhost:4000/gr/schwarzschild" class="nav-list-link">Schwarzschildの外部解</a></li><li class="nav-list-item "><a href="http://localhost:4000/gr/collapse" class="nav-list-link">重力崩壊</a></li><li class="nav-list-item "><a href="http://localhost:4000/gr/schwarzschild_interior" class="nav-list-link">Schwarzschildの内部解</a></li><li class="nav-list-item "><a href="http://localhost:4000/gr/conservation" class="nav-list-link">エネルギー運動量保存則</a></li><li class="nav-list-item "><a href="http://localhost:4000/gr/mw_smbh" class="nav-list-link">天の川銀河中心の超巨大質量コンパクトオブジェクトの発見</a></li><li class="nav-list-item "><a href="http://localhost:4000/gr/kerr" class="nav-list-link">カー・ブラックホール</a></li><li class="nav-list-item "><a href="http://localhost:4000/gr/linear_einstein" class="nav-list-link">線形近似されたEinstein方程式</a></li><li class="nav-list-item "><a href="http://localhost:4000/gr/feature_kerr" class="nav-list-link">カー・ブラックホールの特徴</a></li><li class="nav-list-item "><a href="http://localhost:4000/gr/spinning_weak_gravity" class="nav-list-link">ゆっくり自転する低質量星が作る時空</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="http://localhost:4000/galady" class="nav-list-link">銀河のダイナミクス</a><ul class="nav-list "><li class="nav-list-item "><a href="http://localhost:4000/galady/twobody" class="nav-list-link">2体問題</a></li><li class="nav-list-item "><a href="http://localhost:4000/galady/virial" class="nav-list-link">ビリアル定理</a></li><li class="nav-list-item "><a href="http://localhost:4000/galady/twobody_relaxation" class="nav-list-link">2体緩和</a></li><li class="nav-list-item "><a href="http://localhost:4000/galady/violent_relaxation" class="nav-list-link">激しい緩和</a></li><li class="nav-list-item "><a href="http://localhost:4000/galady/dynamical_friction" class="nav-list-link">動的摩擦</a></li><li class="nav-list-item "><a href="http://localhost:4000/galady/vlasov" class="nav-list-link">ブラソフ方程式</a></li><li class="nav-list-item "><a href="http://localhost:4000/galady/jeans_theorem" class="nav-list-link">運動の積分とジーンズの定理</a></li><li class="nav-list-item "><a href="http://localhost:4000/galady/poisson" class="nav-list-link">ポアソン方程式</a></li><li class="nav-list-item "><a href="http://localhost:4000/galady/spherical_model" class="nav-list-link">球対称平衡モデル</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="http://localhost:4000/cosmo" class="nav-list-link">宇宙論</a><ul class="nav-list "><li class="nav-list-item "><a href="http://localhost:4000/cosmo/rw" class="nav-list-link">Robertson-Walker計量</a></li><li class="nav-list-item "><a href="http://localhost:4000/cosmo/hubble" class="nav-list-link">Hubbleパラメータ</a></li><li class="nav-list-item "><a href="http://localhost:4000/cosmo/redshift" class="nav-list-link">赤方偏移</a></li><li class="nav-list-item "><a href="http://localhost:4000/cosmo/friedmann" class="nav-list-link">Friedmann方程式</a></li><li class="nav-list-item "><a href="http://localhost:4000/cosmo/density" class="nav-list-link">密度パラメータなど</a></li><li class="nav-list-item "><a href="http://localhost:4000/cosmo/const" class="nav-list-link">宇宙項</a></li><li class="nav-list-item "><a href="http://localhost:4000/cosmo/eos" class="nav-list-link">状態方程式</a></li><li class="nav-list-item "><a href="http://localhost:4000/cosmo/energy_cons" class="nav-list-link">エネルギー保存</a></li><li class="nav-list-item "><a href="http://localhost:4000/cosmo/energy_eq" class="nav-list-link">Energy equipartition</a></li><li class="nav-list-item "><a href="http://localhost:4000/cosmo/solve_friedmann" class="nav-list-link">Friedmann方程式を解く</a></li><li class="nav-list-item "><a href="http://localhost:4000/cosmo/flatness" class="nav-list-link">Flatness problem</a></li><li class="nav-list-item "><a href="http://localhost:4000/cosmo/proper_d" class="nav-list-link">固有距離</a></li><li class="nav-list-item "><a href="http://localhost:4000/cosmo/proper_v" class="nav-list-link">固有体積要素と数密度</a></li><li class="nav-list-item "><a href="http://localhost:4000/cosmo/luminosity_d" class="nav-list-link">光度距離</a></li><li class="nav-list-item "><a href="http://localhost:4000/cosmo/angular_d" class="nav-list-link">角径距離</a></li><li class="nav-list-item "><a href="http://localhost:4000/cosmo/age" class="nav-list-link">宇宙年齢</a></li><li class="nav-list-item "><a href="http://localhost:4000/cosmo/tolman" class="nav-list-link">Tolman効果</a></li><li class="nav-list-item "><a href="http://localhost:4000/cosmo/horizon" class="nav-list-link">地平線</a></li><li class="nav-list-item "><a href="http://localhost:4000/cosmo/planck_scale" class="nav-list-link">Planckスケール</a></li><li class="nav-list-item "><a href="http://localhost:4000/cosmo/gp" class="nav-list-link">Gunn-Peterson test</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="http://localhost:4000/atmos" class="nav-list-link">恒星大気の物理学</a><ul class="nav-list "><li class="nav-list-item "><a href="http://localhost:4000/atmos/intensity_flux" class="nav-list-link">光のIntensityとflux</a></li><li class="nav-list-item "><a href="http://localhost:4000/atmos/magnitude_color" class="nav-list-link">恒星の等級と色</a></li><li class="nav-list-item "><a href="http://localhost:4000/atmos/spectrum" class="nav-list-link">恒星のスペクトル</a></li><li class="nav-list-item "><a href="http://localhost:4000/atmos/luminosity_class" class="nav-list-link">Luminosity class</a></li><li class="nav-list-item "><a href="http://localhost:4000/atmos/radiative_transfer" class="nav-list-link">Radiative transferの式</a></li><li class="nav-list-item "><a href="http://localhost:4000/atmos/formal_absorption_emission" class="nav-list-link">Radiative transfer eq.の形式的な解</a></li><li class="nav-list-item "><a href="http://localhost:4000/atmos/infinite_plane_parallel" class="nav-list-link">深さ無限大のplane-parallel大気</a></li><li class="nav-list-item "><a href="http://localhost:4000/atmos/eddington_barbier" class="nav-list-link">Eddington-Barbier relation</a></li><li class="nav-list-item "><a href="http://localhost:4000/atmos/moment" class="nav-list-link">Radiative transfer eq.のモーメント</a></li><li class="nav-list-item "><a href="http://localhost:4000/atmos/schwarzschild_milne" class="nav-list-link">Schwarzschild-Milne equations</a></li><li class="nav-list-item "><a href="http://localhost:4000/atmos/diffusion" class="nav-list-link">Diffusion Approximation</a></li><li class="nav-list-item "><a href="http://localhost:4000/atmos/gray" class="nav-list-link">Gray atmosphere</a></li><li class="nav-list-item "><a href="http://localhost:4000/atmos/eddington_app" class="nav-list-link">Eddington approximation</a></li><li class="nav-list-item "><a href="http://localhost:4000/atmos/state_of_gas" class="nav-list-link">ガスの状態と光の吸収・発光係数</a></li><li class="nav-list-item "><a href="http://localhost:4000/atmos/transition_prob" class="nav-list-link">遷移確率</a></li><li class="nav-list-item "><a href="http://localhost:4000/atmos/continuum_einstein_milne" class="nav-list-link">連続光に対するEinstein-Milne relation</a></li><li class="nav-list-item "><a href="http://localhost:4000/atmos/hydrogen_atom" class="nav-list-link">水素原子</a></li><li class="nav-list-item "><a href="http://localhost:4000/atmos/lte" class="nav-list-link">LTE</a></li><li class="nav-list-item "><a href="http://localhost:4000/atmos/hydrostatic_equilibrium" class="nav-list-link">静水圧平衡</a></li><li class="nav-list-item "><a href="http://localhost:4000/atmos/radiative_equilibrium" class="nav-list-link">放射平衡</a></li><li class="nav-list-item "><a href="http://localhost:4000/atmos/scattering_dominated" class="nav-list-link">優勢な散乱によって生じる問題</a></li><li class="nav-list-item "><a href="http://localhost:4000/atmos/temperature_compensation" class="nav-list-link">理論的大気モデル計算法の概要</a></li><li class="nav-list-item "><a href="http://localhost:4000/atmos/temperature_distribution" class="nav-list-link">温度分布</a></li><li class="nav-list-item "><a href="http://localhost:4000/atmos/continuous_spectrum" class="nav-list-link">連続スペクトル</a></li><li class="nav-list-item "><a href="http://localhost:4000/atmos/bolometric_correction" class="nav-list-link">全輻射補正</a></li><li class="nav-list-item "><a href="http://localhost:4000/atmos/expanded_atmos" class="nav-list-link">広がった大気</a></li><li class="nav-list-item "><a href="http://localhost:4000/atmos/spherical_gray" class="nav-list-link">Sperical gray atmosphere</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="http://localhost:4000/compact" class="nav-list-link">コンパクト天体</a><ul class="nav-list "><li class="nav-list-item "><a href="http://localhost:4000/compact/spin_down" class="nav-list-link">スピンダウンによる中性子星の年齢推定</a></li><li class="nav-list-item "><a href="http://localhost:4000/compact/landau_level" class="nav-list-link">ランダウ準位と中性子星磁場の観測</a></li><li class="nav-list-item "><a href="http://localhost:4000/compact/pseudo_newton" class="nav-list-link">擬ニュートンポテンシャル</a></li><li class="nav-list-item "><a href="http://localhost:4000/compact/torus_phi" class="nav-list-link">力学平衡な磁気流体回転トーラス</a></li><li class="nav-list-item "><a href="http://localhost:4000/compact/mri_parker" class="nav-list-link">磁気回転不安定性とパーカー不安定性の釣り合い</a></li><li class="nav-list-item "><a href="http://localhost:4000/compact/standard_disk" class="nav-list-link">標準降着円盤</a></li><li class="nav-list-item "><a href="http://localhost:4000/compact/standard_disk_spectrum" class="nav-list-link">標準降着円盤からのエネルギー放出とそのスペクトル</a></li><li class="nav-list-item "><a href="http://localhost:4000/compact/roche" class="nav-list-link">ロッシュローブ</a></li><li class="nav-list-item "><a href="http://localhost:4000/compact/chandrasekhar_limit" class="nav-list-link">電子の縮退とチャンドラセカール限界質量</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="http://localhost:4000/stellar" class="nav-list-link">恒星物理学</a><ul class="nav-list "></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="http://localhost:4000/nucl" class="nav-list-link">原子核物理学</a><ul class="nav-list "><li class="nav-list-item "><a href="http://localhost:4000/nucl/wu" class="nav-list-link">Wuの実験</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="http://localhost:4000/math" class="nav-list-link">数学</a><ul class="nav-list "><li class="nav-list-item "><a href="http://localhost:4000/math/sinc" class="nav-list-link">sinc関数の積分</a></li><li class="nav-list-item "><a href="http://localhost:4000/math/sinc2" class="nav-list-link">sinc関数の2乗の積分</a></li><li class="nav-list-item "><a href="http://localhost:4000/math/sin_n_cos_n" class="nav-list-link">sin^n, cos^nの積分</a></li><li class="nav-list-item "><a href="http://localhost:4000/math/fresnel" class="nav-list-link">フレネル積分</a></li><li class="nav-list-item "><a href="http://localhost:4000/math/laplacian" class="nav-list-link">3次元極座標でのラプラシアン</a></li><li class="nav-list-item "><a href="http://localhost:4000/math/gamma" class="nav-list-link">ガンマ関数</a></li><li class="nav-list-item "><a href="http://localhost:4000/math/beta" class="nav-list-link">ベータ関数</a></li><li class="nav-list-item "><a href="http://localhost:4000/math/zeta" class="nav-list-link">ゼータ関数</a></li><li class="nav-list-item "><a href="http://localhost:4000/math/generating" class="nav-list-link">母関数</a></li><li class="nav-list-item "><a href="http://localhost:4000/math/laguerre" class="nav-list-link">ラゲール多項式</a></li><li class="nav-list-item "><a href="http://localhost:4000/math/bessel" class="nav-list-link">ベッセル関数</a></li><li class="nav-list-item "><a href="http://localhost:4000/math/modified_bessel_airy" class="nav-list-link">修正ベッセル関数とエアリー関数</a></li><li class="nav-list-item "><a href="http://localhost:4000/math/half_bessel" class="nav-list-link">半整数次のベッセル関数</a></li><li class="nav-list-item "><a href="http://localhost:4000/math/sph_bessel" class="nav-list-link">球ベッセル関数と球ノイマン関数</a></li><li class="nav-list-item "><a href="http://localhost:4000/math/legendre" class="nav-list-link">ルジャンドル多項式</a></li><li class="nav-list-item "><a href="http://localhost:4000/math/associated_legendre" class="nav-list-link">ルジャンドル陪関数</a></li><li class="nav-list-item "><a href="http://localhost:4000/math/spherical" class="nav-list-link">球面調和関数</a></li><li class="nav-list-item "><a href="http://localhost:4000/math/chebyshev" class="nav-list-link">チェビシェフ多項式</a></li><li class="nav-list-item "><a href="http://localhost:4000/math/rayleigh_expansion" class="nav-list-link">レイリーの公式</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="http://localhost:4000/mo" class="nav-list-link">数理最適化</a><ul class="nav-list "><li class="nav-list-item "><a href="http://localhost:4000/mo/first" class="nav-list-link">最適性の1次の必要条件</a></li><li class="nav-list-item "><a href="http://localhost:4000/mo/second" class="nav-list-link">最適性の2次の十分条件</a></li><li class="nav-list-item "><a href="http://localhost:4000/mo/tts" class="nav-list-link">Time-to-solution</a></li><li class="nav-list-item "><a href="http://localhost:4000/mo/augmented_lagrangian" class="nav-list-link">拡張ラグランジュ関数法</a></li><li class="nav-list-item "><a href="http://localhost:4000/mo/ohzeki" class="nav-list-link">大関法</a></li><li class="nav-list-item "><a href="http://localhost:4000/mo/clique_cover" class="nav-list-link">クリーク被覆問題</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="http://localhost:4000/ml" class="nav-list-link">機械学習</a><ul class="nav-list "><li class="nav-list-item "><a href="http://localhost:4000/ml/universal_approximation" class="nav-list-link">万能近似定理</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="http://localhost:4000/qc" class="nav-list-link">量子回路</a><ul class="nav-list "><li class="nav-list-item "><a href="http://localhost:4000/qc/qnd0" class="nav-list-link">Quantum Native Dojo, 0</a></li><li class="nav-list-item "><a href="http://localhost:4000/qc/qnd1" class="nav-list-link">Quantum Native Dojo, 1</a></li><li class="nav-list-item "><a href="http://localhost:4000/qc/qnd2" class="nav-list-link">Quantum Native Dojo, 2</a></li><li class="nav-list-item "><a href="http://localhost:4000/qc/qnd4" class="nav-list-link">Quantum Native Dojo, 4</a></li><li class="nav-list-item "><a href="http://localhost:4000/qc/qnd8" class="nav-list-link">Quantum Native Dojo, 8</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="http://localhost:4000/qa" class="nav-list-link">量子アニーリング</a><ul class="nav-list "><li class="nav-list-item "><a href="http://localhost:4000/qa/qa4u1" class="nav-list-link">Quantum annealing for you, 1</a></li><li class="nav-list-item "><a href="http://localhost:4000/qa/qa4u2" class="nav-list-link">Quantum annealing for you, 2</a></li><li class="nav-list-item "><a href="http://localhost:4000/qa/qa4u3" class="nav-list-link">Quantum annealing for you, 3</a></li><li class="nav-list-item "><a href="http://localhost:4000/qa/qa4u4" class="nav-list-link">Quantum annealing for you, 4</a></li><li class="nav-list-item "><a href="http://localhost:4000/qa/qa4u5" class="nav-list-link">Quantum annealing for you, 5</a></li><li class="nav-list-item "><a href="http://localhost:4000/qa/qa4ug" class="nav-list-link">Quantum annealing for you, group</a></li><li class="nav-list-item "><a href="http://localhost:4000/qa/quantum_and_classical_annealing_with_multi_local_minima" class="nav-list-link">多数の局所解があるような連続ポテンシャルでの量子・古典アニーリング</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="http://localhost:4000/infostat" class="nav-list-link">情報統計力学</a><ul class="nav-list "><li class="nav-list-item "><a href="http://localhost:4000/infostat/statistical_mechanics" class="nav-list-link">統計力学の復習</a></li><li class="nav-list-item "><a href="http://localhost:4000/infostat/random_spin_system" class="nav-list-link">ランダムスピン系</a></li><li class="nav-list-item "><a href="http://localhost:4000/infostat/random_matrix" class="nav-list-link">ランダム行列</a></li><li class="nav-list-item "><a href="http://localhost:4000/infostat/ml" class="nav-list-link">機械学習</a></li><li class="nav-list-item "><a href="http://localhost:4000/infostat/report" class="nav-list-link">レポート問題</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="http://localhost:4000/pro" class="nav-list-link">プログラミング</a><ul class="nav-list "><li class="nav-list-item "><a href="http://localhost:4000/pro/python" class="nav-list-link">Python</a></li><li class="nav-list-item "><a href="http://localhost:4000/pro/amplify" class="nav-list-link">Amplify</a></li><li class="nav-list-item "><a href="http://localhost:4000/pro/gitbook" class="nav-list-link">GitBook</a></li><li class="nav-list-item "><a href="http://localhost:4000/pro/git" class="nav-list-link">Git</a></li><li class="nav-list-item "><a href="http://localhost:4000/pro/jekyll" class="nav-list-link">Jekyll</a></li><li class="nav-list-item "><a href="http://localhost:4000/pro/triple_display" class="nav-list-link">M1 Macで3画面</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="http://localhost:4000/tips" class="nav-list-link">Tips</a><ul class="nav-list "><li class="nav-list-item "><a href="http://localhost:4000/tips/physical_const" class="nav-list-link">物理定数</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="http://localhost:4000/eng" class="nav-list-link">英語</a><ul class="nav-list "><li class="nav-list-item "><a href="http://localhost:4000/eng/20220123" class="nav-list-link">英会話レッスン20220123</a></li><li class="nav-list-item "><a href="http://localhost:4000/eng/20220213" class="nav-list-link">英会話レッスン20220213</a></li><li class="nav-list-item "><a href="http://localhost:4000/eng/20220220" class="nav-list-link">英会話レッスン20220220</a></li><li class="nav-list-item "><a href="http://localhost:4000/eng/20220306" class="nav-list-link">英会話レッスン20220306</a></li><li class="nav-list-item "><a href="http://localhost:4000/eng/20220327" class="nav-list-link">英会話レッスン20220327</a></li><li class="nav-list-item "><a href="http://localhost:4000/eng/20220402" class="nav-list-link">英会話レッスン20220402</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="http://localhost:4000/poem" class="nav-list-link">ポエム</a><ul class="nav-list "><li class="nav-list-item "><a href="http://localhost:4000/poem/research_in_graduate" class="nav-list-link">大学院での研究生活</a></li><li class="nav-list-item "><a href="http://localhost:4000/poem/ans" class="nav-list-link">研究の意味とは？</a></li></ul></li></ul> </nav> <footer class="site-footer"> This site uses <a href="https://github.com/pmarsceill/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll. </footer> </div> <div class="main" id="top"> <div id="main-header" class="main-header"> <div class="search"> <div class="search-input-wrap"> <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search 宇宙物理メモ" aria-label="Search 宇宙物理メモ" autocomplete="off"> <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label> </div> <div id="search-results" class="search-results"></div> </div> </div> <div id="main-content-wrap" class="main-content-wrap"> <nav aria-label="Breadcrumb" class="breadcrumb-nav"> <ol class="breadcrumb-nav-list"> <li class="breadcrumb-nav-list-item"><a href="http://localhost:4000/simulation">数値計算</a></li> <li class="breadcrumb-nav-list-item"><span>HLLC法</span></li> </ol> </nav> <div id="main-content" class="main-content" role="main"> <details open=""> <summary class="text-delta"> Table of contents </summary> <ol id="markdown-toc"> <li><a href="#hllc法" id="markdown-toc-hllc法">HLLC法</a> <ol> <li><a href="#流体方程式群" id="markdown-toc-流体方程式群">流体方程式群</a></li> <li><a href="#流束計算" id="markdown-toc-流束計算">流束計算</a></li> <li><a href="#数値計算に用いる" id="markdown-toc-数値計算に用いる">数値計算に用いる</a></li> <li><a href="#磁気流体方程式への拡張" id="markdown-toc-磁気流体方程式への拡張">磁気流体方程式への拡張</a> <ol> <li><a href="#b_x--0の場合" id="markdown-toc-b_x--0の場合">\(B_x = 0\)の場合</a></li> <li><a href="#b_x-neq-0の場合gurskiの手法" id="markdown-toc-b_x-neq-0の場合gurskiの手法">\(B_x \neq 0\)の場合、Gurskiの手法</a></li> <li><a href="#b_x-neq-0の場合liの方法" id="markdown-toc-b_x-neq-0の場合liの方法">\(B_x \neq 0\)の場合、Liの方法</a></li> </ol> </li> <li><a href="#hllc流束の計算モジュール" id="markdown-toc-hllc流束の計算モジュール">HLLC流束の計算モジュール</a></li> </ol> </li> <li><a href="#参考文献" id="markdown-toc-参考文献">参考文献</a></li> </ol> </details> <script async="" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-9131160172347693" crossorigin="anonymous"></script> <!-- for_jekyll --> <p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-9131160172347693" data-ad-slot="3528582902" data-ad-format="auto" data-full-width-responsive="true"></ins> <script> (adsbygoogle = window.adsbygoogle || []).push({}); </script></p> <h1 id="hllc法"> <a href="#hllc法" class="anchor-heading" aria-labelledby="hllc法"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> HLLC法 </h1> <p>ここでは(磁気)流体力学の計算手法であるHLLC法についての勉強メモを記述しています。</p> <h2 id="流体方程式群"> <a href="#流体方程式群" class="anchor-heading" aria-labelledby="流体方程式群"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 流体方程式群 </h2> <p>いきなり磁場がある場合は難しいため、最初は磁場のない流体を考えることにしましょう。簡単のため1次元系を解くことにします。すると解きたい方程式は</p> \[\frac{\partial}{\partial t} \left( \begin{array}{c} \rho \\ \rho v_x \\ \rho v_y \\ \rho v_z \\ E \end{array} \right) + \frac{\partial}{\partial x} \left( \begin{array}{c} \rho v_x \\ \rho v_x v_x + P \\ \rho v_y v_x \\ \rho v_z v_x \\ (E + P) v_x \end{array}\right) = \frac{\partial \mathbf{U}}{\partial t} + \frac{\partial \mathbf{F}}{\partial x} = \mathbf{0} \tag{1}\] <p>のように書かれます。</p> <h2 id="流束計算"> <a href="#流束計算" class="anchor-heading" aria-labelledby="流束計算"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 流束計算 </h2> <p><a href="/simulation/hll">HLL (Harten-Lax-van Leer)法</a>は、中間状態を1つであると仮定しました。今回は中間状態を下図のように2つとして計算を行います。</p> <p><img src="/assets/images/simulation/hllc_01.png" alt="" /></p> <p>ただし、中間状態において、\(x\)方向の流体の速度は一定であるとします。すなわち</p> \[v_{x, L}^\ast = v_{x, R}^\ast = S_M \tag{2}\] <p>この\(S_M\)は中間状態を代表する速度です。よって<a href="/simulation/hll">HLLの中間状態</a></p> \[\mathbf{U}_\mathrm{HLL}^\ast = \frac{S_R \mathbf{U}_R - S_L \mathbf{U}_L - \mathbf{F}_R + \mathbf{F}_L}{S_R - S_L} \tag{3}\] <p>から導出されるだろうと考えることができます。</p> \[\rho_\mathrm{HLL}^\ast = \frac{S_R \rho_R - S_L \rho_L - \rho_R v_{x, R} + \rho_L v_{x, L}}{S_R - S_L}\] \[(\rho v_x)_\mathrm{HLL}^\ast = \frac{S_R \rho_R v_{x, R} - S_L \rho_L v_{x, L} - (\rho_R v_{x, R} v_{x, R} + P_R) + (\rho_L v_{x, L} v_{x, L} + P_L)}{S_R - S_L}\] <p>以上より</p> \[S_M = \frac{(\rho v_x)_\mathrm{HLL}^\ast}{\rho_\mathrm{HLL}^\ast} = \frac{(S_R - v_{x, R}) \rho_R v_{x, R} - (S_L - v_{x, L}) \rho_L v_{x, L} - P_R + P_L}{(S_R - v_{x, R})\rho_R - (S_L-v_{x, L}) \rho_L} \tag{4}\] <p>と求まります。次に中間状態の圧力を考えましょう。\(S_\alpha \ (\alpha = L, R)\)の速度で進む波面でのジャンプ条件より</p> \[S_\alpha \mathbf{U}_\alpha^\ast - \mathbf{F}_\alpha^\ast = S_\alpha \mathbf{U}_\alpha - \mathbf{F}_\alpha \tag{5}\] <p>です。この式と(1)式の第1式(<a href="/mhd/continuity">連続の式</a>)を考えると</p> \[S_\alpha \rho_\alpha^\ast - \rho_\alpha^\ast v_{x, \alpha}^\ast = S_\alpha \rho_\alpha - \rho_\alpha v_{x, \alpha} \ \underbrace{\Longrightarrow}_{(2)} \ \rho_\alpha^\ast = \rho_\alpha \frac{S_\alpha - v_{x, \alpha}}{S_\alpha - S_M} \tag{6}\] <p>続いて(5)式と(1)式の第2式(<a href="/mhd/momentum">\(x\)方向の運動量保存式</a>)を考えると</p> \[\begin{aligned} &amp;S_\alpha \rho_\alpha^\ast v_{x, \alpha}^\ast - (\rho_\alpha^\ast v_{x, \alpha}^\ast v_{x, \alpha}^\ast + P_\alpha^\ast) = S_\alpha \rho_\alpha v_{x, \alpha} - (\rho_\alpha v_{x, \alpha} v_{x, \alpha} + P_\alpha) \\ &amp;\underbrace{\Longrightarrow}_{(2)} \ \rho_\alpha^\ast S_M (S_\alpha - S_M) - P_\alpha^\ast = \rho_\alpha v_{x, \alpha} (S_\alpha - v_{x, \alpha}) - P_\alpha \end{aligned}\] <p>ここに(6)式を用いれば</p> \[\rho_\alpha S_M (S_\alpha - v_{x, \alpha}) - P_\alpha^\ast = \rho_\alpha v_{x, \alpha} (S_\alpha - v_{x, \alpha}) - P_\alpha \ \Longrightarrow \ P_\alpha^\ast = P_\alpha + \rho_\alpha (S_\alpha - v_{x, \alpha}) (S_M - v_{x, \alpha}) \tag{7}\] <p>を得ます。実は衝撃波管の物理から、\(S_M\)を挟んで</p> \[P_L^\ast = P_R^\ast = P^\ast \tag{8}\] <p>が成り立ちます。これは\(\rho_L^\ast \neq \rho_R^\ast\)でありながら圧力は同じ値でバランスしている接触不連続面であることを意味します。<br /> 同様に(1)式の第3式(<a href="/mhd/momentum">\(y\)方向の運動量保存式</a>)より</p> \[S_\alpha \rho_\alpha^\ast v_{y, \alpha}^\ast - \rho_\alpha^\ast v_{y, \alpha}^\ast v_{x, \alpha}^\ast = S_\alpha \rho_\alpha v_{y, \alpha} - \rho_\alpha v_{y, \alpha} v_{x, \alpha} \ \underbrace{\Longrightarrow}_{(2)} \ \rho_\alpha^\ast v_{y, \alpha}^\ast (S_\alpha - S_M) = \rho_\alpha v_{y, \alpha} (S_\alpha - v_{x, \alpha})\] <p>ここに(6)式を用いることで</p> \[v_{y, \alpha}^\ast = v_{y, \alpha} \tag{9}\] <p>を得ます。同様に</p> \[v_{z, \alpha}^\ast = v_{z, \alpha} \tag{10}\] <p>も導くことができます。最後に(1)式と第5式(<a href="/mhd/energy">エネルギー保存式</a>)より</p> \[S_\alpha E_\alpha^\ast - (E_\alpha^\ast + \underbrace{P_\alpha^\ast}_{(8)}) \underbrace{v_{x, \alpha}^\ast}_{(2)} = S_\alpha E_\alpha - (E_\alpha + P_\alpha) v_{x, \alpha} \ \Longrightarrow \ E_\alpha^\ast = \frac{(S_\alpha - v_{x, \alpha}) E_\alpha - P_\alpha v_{x, \alpha} + P^\ast S_M}{S_\alpha - S_M} \tag{11}\] <p>となります。これらをまとめて</p> \[\mathbf{F}_\alpha^\ast = \left( \begin{array}{c} \rho_\alpha^\ast S_M \\ \rho_\alpha^\ast S_M S_M + P^\ast \\ \rho_\alpha^\ast v_{y, \alpha}^\ast S_M \\ \rho_\alpha^\ast v_{z, \alpha}^\ast S_M \\ (E_\alpha^\ast + P^\ast) S_M \end{array}\right) \tag{12}\] <p>とすることで、求めたかった中間状態の流束を計算することができます。途中で出てきたように、HLLC法は接触不連続面の波の速度\(S_M\)およびそれを境に物理量の変化が起こることを考慮しています。 HLLCの”C”は、HLLを改良し接触不連続面(contact discontinuity)も捉えられるようにしたことから来るものです。</p> <h2 id="数値計算に用いる"> <a href="#数値計算に用いる" class="anchor-heading" aria-labelledby="数値計算に用いる"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 数値計算に用いる </h2> <p><a href="/simulation/hll">HLL法</a>と同様に、実際の数値計算では\(S_L, S_M, S_R\)の大きさを考慮する必要があります。HLLのときと同様に考えましょう。下図は左上から順に\(S_L &gt; 0, S_L \leq 0 &lt; S_M, S_M \leq 0 &lt;S_R, S_R \leq 0\)の場合を図示したものです。</p> <p><img src="/assets/images/simulation/hllc_02.png" alt="" /></p> <p>以上より、数値計算を行う場合、その流束の選択は</p> \[\mathbf{F}_\mathrm{HLLC} = \left\{ \begin{array}{ll} \mathbf{F}_L &amp; \mathrm{if} \ S_L &gt; 0 \\ \mathbf{F}_L^\ast &amp; \mathrm{if} \ S_L \leq 0 &lt; S_M \\ \mathbf{F}_R^\ast &amp; \mathrm{if} \ S_M \leq 0 &lt; S_R \\ \mathbf{F}_R &amp; \mathrm{if} \ S_R \leq 0 \end{array}\right. \tag{13}\] <script async="" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-9131160172347693" crossorigin="anonymous"></script> <!-- for_jekyll --> <p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-9131160172347693" data-ad-slot="3528582902" data-ad-format="auto" data-full-width-responsive="true"></ins> <script> (adsbygoogle = window.adsbygoogle || []).push({}); </script></p> <h2 id="磁気流体方程式への拡張"> <a href="#磁気流体方程式への拡張" class="anchor-heading" aria-labelledby="磁気流体方程式への拡張"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 磁気流体方程式への拡張 </h2> <p>ここまでは磁場のない、流体方程式の場合のHLLCをご紹介してきました。ここからは磁場を含めた、より複雑な方程式についてのHLLC法を考えましょう。磁気流体方程式は</p> \[\frac{\partial}{\partial t} \left( \begin{array}{c} \rho \\ \rho v_x \\ \rho v_y \\ \rho v_z \\ E \\ B_x \\ B_y \\ B_z \end{array} \right) + \frac{\partial}{\partial x} \left( \begin{array}{c} \rho v_x \\ \rho v_x v_x + P_\mathrm{tot} - B_x^2 \\ \rho v_y v_x - B_y B_x\\ \rho v_z v_x - B_z B_x\\ (E + P_\mathrm{tot}) v_x - (\mathbf{B} \cdot \mathbf{v}) B_x \\ 0 \\ B_y v_x - v_y B_x \\ B_z v_x - v_z B_x \end{array}\right) = \frac{\partial \mathbf{U}}{\partial t} + \frac{\partial \mathbf{F}}{\partial x} = \mathbf{0} \tag{14}\] <p>です。それでは導出を始めましょう。<a href="/simulation/hll">HLL法</a>と同様に\(S_L, S_R\)を最も速度の大きい<a href="/mhd/magneto_acoustic">磁気音波</a>から求めます。 今は一次元系を考えているため、(14)式と\(\nabla \cdot \mathbf{B} = \frac{\partial B_x}{\partial x} = 0\)から、\(B_x\)は時間・空間に依存せず、一定・一様の値を持ちます。すなわち</p> \[B_{x, L} = B_{x, L}^\ast = B_{x, R}^\ast = B_{x, R} \tag{15}\] <p>のように考えることができます。(14)式の第二式(\(x\)方向の<a href="/mhd/momentum">運動量保存則</a>)と、\(S_\alpha \ (\alpha = L, R)\)で進行する波面のジャンプ条件(5)式より</p> \[S_\alpha \rho_\alpha^\ast v_{x, \alpha}^\ast - (\rho_\alpha^\ast v_{x, \alpha}^\ast v_{x, \alpha}^\ast + P_\mathrm{tot, \alpha}^\ast - (B_{x, \alpha}^\ast)^2) = S_\alpha \rho_\alpha v_{x, \alpha} - (\rho_\alpha v_{x, \alpha} v_{x, \alpha} + P_\mathrm{tot, \alpha} - B_{x, \alpha}^2)\] <p>(15)式から\(B_{x, \alpha}^\ast = B_{x, \alpha}\)です。従って、得られる関係式は(7)式において\(P \rightarrow P_\mathrm{tot}\)に置換したものに等しくなります。</p> \[P_{\mathrm{tot}, \alpha}^\ast = P_{\mathrm{tot}, \alpha} + \rho_\alpha (S_\alpha - v_{x, \alpha}) (S_M - v_{x, \alpha}) \tag{16}\] <p>そして\(S_M\)で進む波は接触不連続面を形成することから、全圧力は釣り合っているために</p> \[P_{\mathrm{tot}, L}^\ast = P_{\mathrm{tot}, R}^\ast = P_\mathrm{tot}^\ast \tag{17}\] <p>となります。</p> <h3 id="b_x--0の場合"> <a href="#b_x--0の場合" class="anchor-heading" aria-labelledby="b_x--0の場合"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> \(B_x = 0\)の場合 </h3> <p>まずは簡単のため\(B_x = 0\)の場合について導出しましょう。このとき、磁気流体方程式は</p> \[\frac{\partial}{\partial t} \left( \begin{array}{c} \rho \\ \rho v_x \\ \rho v_y \\ \rho v_z \\ E \\ B_x \\ B_y \\ B_z \end{array} \right) + \frac{\partial}{\partial x} \left( \begin{array}{c} \rho v_x \\ \rho v_x v_x + P_\mathrm{tot}\\ \rho v_y v_x\\ \rho v_z v_x\\ (E + P_\mathrm{tot}) v_x \\ 0 \\ B_y v_x\\ B_z v_x \end{array}\right) = \mathbf{0} \tag{18}\] <p>のようになります。\(\rho v_y, \rho v_z\)の流束は(1)式と同じ形となるため、得られる中間状態量も同じです。よって</p> \[v_{y, \alpha}^\ast = v_{y, \alpha} , \quad v_{z, \alpha}^\ast = v_{z, \alpha} \tag{19}\] <p>を得ます。(18)式の第七式に対する\(S_\alpha\)で進行する波面でのジャンプ条件より</p> \[S_\alpha B_{y, \alpha}^\ast - B_{y, \alpha}^\ast \underbrace{v_{x, \alpha}^\ast}_{(2)} = S_\alpha B_{y, \alpha} - B_{y, \alpha} v_{x, \alpha} \ \Longrightarrow \ B_{y, \alpha}^\ast = \frac{S_\alpha - v_{x, \alpha}}{S_\alpha - S_M} B_{y, \alpha} \tag{20}\] <p>同様に(18)式の第八式から</p> \[B_{z, \alpha}^\ast = \frac{S_\alpha - v_{x, \alpha}}{S_\alpha - S_M} B_{z, \alpha} \tag{21}\] <p>が求まります。最後に(18)式の第五式から、同様のジャンプ条件を求めましょう。これは実は(11)式で\(P \rightarrow P_\mathrm{tot}\)としたものに等しく</p> \[E_\alpha^\ast = \frac{(S_\alpha - v_{x, \alpha}) E_\alpha - P_{\mathrm{tot}, \alpha} v_{x, \alpha} + P_\mathrm{tot}^\ast S_M}{S_\alpha - S_M} \tag{22}\] <p>と求まります。</p> <h3 id="b_x-neq-0の場合gurskiの手法"> <a href="#b_x-neq-0の場合gurskiの手法" class="anchor-heading" aria-labelledby="b_x-neq-0の場合gurskiの手法"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> \(B_x \neq 0\)の場合、Gurskiの手法 </h3> <p>それでは\(B_x \neq 0\)の一般の場合のHLLC法を導出しましょう。先程の\(B_x =0\)の場合とは流束が異なるため、再定式化が必要となることは容易にわかります。 しかも\(S_M\)の速度で伝播する接触不連続面では、左右の速度・磁場の接戦成分(\(v_y, v_z, B_y, B_z\))は連続でなければなりません。 そのリーズナブルな求め方としては、(4)式のように<a href="/simulation/hll">HLL中間状態</a>を用いる方法があります。よって</p> \[v_{y, L}^\ast = v_{y, R}^\ast = \frac{(\rho v_y)_\mathrm{HLL}^\ast}{\rho_\mathrm{HLL}^\ast} \equiv v_y^\ast , \quad v_{z, L}^\ast = v_{z, R}^\ast = \frac{(\rho v_z)_\mathrm{HLL}^\ast}{\rho_\mathrm{HLL}^\ast} \equiv v_z^\ast \tag{23}\] \[B_{y, L}^\ast = B_{y, R}^\ast = B_{y, \mathrm{HLL}}^\ast, \quad B_{z, L}^\ast = B_{z, R}^\ast = B_{z, \mathrm{HLL}}^\ast \tag{24}\] <p>これらが求まっていれば、エネルギーを求めることができます。(14)式の第五式より</p> \[\begin{align} &amp;S_\alpha E_\alpha^\ast - \{ (E_\alpha^\ast + P_\mathrm{tot}^\ast) S_M - (\mathbf{B}_\alpha^\ast \cdot \mathbf{v}_\alpha^\ast) B_x\} = S_\alpha E_\alpha - \{ (E_\alpha + P_{\mathrm{tot}, \alpha}) v_{x, \alpha} - (\mathbf{B}_\alpha \cdot \mathbf{v}_\alpha) B_x\} \notag \\ &amp;\Longrightarrow \ E_\alpha^\ast = \frac{(S_\alpha - v_{x, \alpha}) E_\alpha - P_{\mathrm{tot}, \alpha} v_{x, \alpha} + P_\mathrm{tot}^\ast S_M + (\mathbf{B}_\alpha \cdot \mathbf{v}_\alpha - \mathbf{B}_\alpha^\ast \cdot \mathbf{v}_\alpha^\ast) B_x}{S_\alpha - S_M} \tag{25} \end{align}\] <p>これらがわかれば、あとは\(\mathbf{U}_\alpha^\ast = (\rho_\alpha^\ast, \rho_\alpha^\ast S_M, \rho_\alpha^\ast v_y^\ast, \rho_\alpha^\ast v_z^\ast, E_\alpha^\ast, B_x, B_{y, \mathrm{HLL}}^\ast, B_{z, \mathrm{HLL}}^\ast)\)として、(5)式から</p> \[\mathbf{F}_\alpha^\ast = \mathbf{F}_\alpha + S_\alpha (\mathbf{U}_\alpha^\ast - \mathbf{U}_\alpha) \tag{26}\] <p>のようにして\(\mathbf{F}_L^\ast, \mathbf{F}_R^\ast\)を求めることができます。このようにして\(B_x \neq 0\)でのHLLC流束を計算することが可能です。このように定める方法を、開発した<a href="https://epubs.siam.org/doi/10.1137/S1064827502407962">Gurski</a>の頭文字をとって、以降ではHLLC-Gと呼ぶことにします。 しかし、実はHLLC-Gには問題があります。それは\(B_x \rightarrow 0\)の極限を取ったときに、(23), (24)式が(19), (20), (21)式に一致しないことです。このことから、<a href="/mhd/alfven_wave">アルヴェーン波</a>と<a href="/mhd/mhd_shock_oblique">遅い磁気音波衝撃波</a>を正しく計算することができません(どうしても鈍った結果となります)。ただしそれ以外の、孤立した<a href="/mhd/mhd_shock_oblique">速い磁気音波衝撃波や接触不連続面</a>は正しく分解して計算することができます。</p> <h3 id="b_x-neq-0の場合liの方法"> <a href="#b_x-neq-0の場合liの方法" class="anchor-heading" aria-labelledby="b_x-neq-0の場合liの方法"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> \(B_x \neq 0\)の場合、Liの方法 </h3> <p>別の方法が<a href="https://www.sciencedirect.com/science/article/pii/S0021999104003857?via%3Dihub">Li</a>により示されています。この手法を以降ではHLLC-Lと呼ぶことにします。<a href="#b_x-neq-0の場合gurskiの手法">HLLC-G</a>では(23), (24)式のように\(v_{y, \alpha}^\ast, v_{z, \alpha}^\ast\)に<a href="/simulation/hll">HLL中間状態</a>を用いていました。これにより\(B_x \rightarrow 0\)で一致しない問題が起こっていたのです。よってこれを解消するために、(18)式の第三式(\(y\)方向の<a href="/mhd/momentum">運動量保存則</a>)から、\(S_\alpha\)で進行する波面についてジャンプ条件を導いてみましょう。</p> \[\begin{align} &amp;S_\alpha \rho_\alpha^\ast v_{y, \alpha}^\ast - (\rho_\alpha^\ast v_{y, \alpha}^\ast \underbrace{v_{x, \alpha}^\ast}_{(2)} - \overbrace{B_{y, \alpha}^\ast}^{(24)} B_x) = S_\alpha \rho_\alpha v_{y, \alpha} - (\rho_\alpha v_{y, \alpha} v_{x, \alpha} - B_{y, \alpha} B_x) \notag \\ &amp;\Longrightarrow \ \frac{\overbrace{\rho_\alpha^\ast}^{(6)} (S_\alpha - S_M)}{\rho_\alpha (S_\alpha - v_{x, \alpha})} v_{y, \alpha}^\ast = v_{y, \alpha} + \frac{B_x (B_{y, \alpha}-B_{y, \alpha}^\ast)}{\rho_\alpha (S_\alpha - v_{x, \alpha})} \notag \\ &amp;\Longrightarrow \ v_{y, \alpha}^\ast = v_{y, \alpha} + \frac{B_x (B_{y, \alpha}-B_{y, \alpha}^\ast)}{\rho_\alpha (S_\alpha - v_{x, \alpha})} \tag{27} \end{align}\] <p>同様に(18)式の第四式(\(z\)方向の<a href="/mhd/momentum">運動量保存則</a>)からは</p> \[v_{z, \alpha}^\ast = v_{z, \alpha} + \frac{B_x (B_{z, \alpha}-B_{z, \alpha}^\ast)}{\rho_\alpha (S_\alpha - v_{x, \alpha})} \tag{28}\] <p>が求まります。HLLC-Lはその求め方からわかるように、リーマンファン内で保存則を満たす手法です。さらにこの手法は\(B_x \rightarrow 0\)としたときに(27), (28)式は(19)式を再現できます。 しかし、万能というわけではありません。この手法には\(S_M\)に対する考察が含まれていないことから、接触不連続面でのジャンプ条件が保証されていません。 よってHLLC-Lでは、<a href="#b_x-neq-0の場合gurskiの手法">HLLC-G</a>ではちゃんと計算されていた接触不連続面が正しく分解できないことがあります。さらに(24)式はそのまま用いているため、\(B_y^\ast, B_z^\ast\)に関しては\(B_x \rightarrow 0\)の極限で一致しない問題が残ります。</p> <script async="" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-9131160172347693" crossorigin="anonymous"></script> <!-- for_jekyll --> <p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-9131160172347693" data-ad-slot="3528582902" data-ad-format="auto" data-full-width-responsive="true"></ins> <script> (adsbygoogle = window.adsbygoogle || []).push({}); </script></p> <h2 id="hllc流束の計算モジュール"> <a href="#hllc流束の計算モジュール" class="anchor-heading" aria-labelledby="hllc流束の計算モジュール"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> HLLC流束の計算モジュール </h2> <p>以下に<a href="#b_x-neq-0の場合gurskiの手法">HLLC-G</a>流束計算コードのJulia実装例を示します。</p> <div class="language-julia highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">using</span> <span class="n">LinearAlgebra</span>    
<span class="n">include</span><span class="x">(</span><span class="s">"../convert/convert.jl"</span><span class="x">)</span>
<span class="n">include</span><span class="x">(</span><span class="s">"../const/const.jl"</span><span class="x">)</span>
<span class="k">function</span><span class="nf"> hllcg!</span><span class="x">(</span><span class="n">F</span><span class="o">::</span><span class="kt">Array</span><span class="x">{</span><span class="kt">Float64</span><span class="x">,</span> <span class="mi">2</span><span class="x">},</span> <span class="n">Vl</span><span class="o">::</span><span class="kt">Array</span><span class="x">{</span><span class="kt">Float64</span><span class="x">,</span> <span class="mi">2</span><span class="x">},</span> <span class="n">Vr</span><span class="o">::</span><span class="kt">Array</span><span class="x">{</span><span class="kt">Float64</span><span class="x">,</span> <span class="mi">2</span><span class="x">},</span> <span class="n">nxmax</span><span class="o">::</span><span class="kt">Int64</span><span class="x">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="k">in</span> <span class="mi">1</span><span class="o">:</span><span class="n">nxmax</span><span class="o">-</span><span class="mi">1</span>
        <span class="n">rol</span> <span class="o">=</span> <span class="n">Vl</span><span class="x">[</span><span class="mi">1</span><span class="x">,</span> <span class="n">i</span><span class="x">]</span>
        <span class="n">vnl</span> <span class="o">=</span> <span class="n">Vl</span><span class="x">[</span><span class="mi">2</span><span class="x">,</span> <span class="n">i</span><span class="x">]</span>
        <span class="n">vtl</span> <span class="o">=</span> <span class="n">Vl</span><span class="x">[</span><span class="mi">3</span><span class="x">,</span> <span class="n">i</span><span class="x">]</span>
        <span class="n">vul</span> <span class="o">=</span> <span class="n">Vl</span><span class="x">[</span><span class="mi">4</span><span class="x">,</span> <span class="n">i</span><span class="x">]</span>
        <span class="n">prl</span> <span class="o">=</span> <span class="n">Vl</span><span class="x">[</span><span class="mi">5</span><span class="x">,</span> <span class="n">i</span><span class="x">]</span>
        <span class="n">bnl</span> <span class="o">=</span> <span class="n">Vl</span><span class="x">[</span><span class="mi">6</span><span class="x">,</span> <span class="n">i</span><span class="x">]</span>
        <span class="n">btl</span> <span class="o">=</span> <span class="n">Vl</span><span class="x">[</span><span class="mi">7</span><span class="x">,</span> <span class="n">i</span><span class="x">]</span>
        <span class="n">bul</span> <span class="o">=</span> <span class="n">Vl</span><span class="x">[</span><span class="mi">8</span><span class="x">,</span> <span class="n">i</span><span class="x">]</span>
        <span class="n">ror</span> <span class="o">=</span> <span class="n">Vr</span><span class="x">[</span><span class="mi">1</span><span class="x">,</span> <span class="n">i</span><span class="x">]</span>
        <span class="n">vnr</span> <span class="o">=</span> <span class="n">Vr</span><span class="x">[</span><span class="mi">2</span><span class="x">,</span> <span class="n">i</span><span class="x">]</span>
        <span class="n">vtr</span> <span class="o">=</span> <span class="n">Vr</span><span class="x">[</span><span class="mi">3</span><span class="x">,</span> <span class="n">i</span><span class="x">]</span>
        <span class="n">vur</span> <span class="o">=</span> <span class="n">Vr</span><span class="x">[</span><span class="mi">4</span><span class="x">,</span> <span class="n">i</span><span class="x">]</span>
        <span class="n">prr</span> <span class="o">=</span> <span class="n">Vr</span><span class="x">[</span><span class="mi">5</span><span class="x">,</span> <span class="n">i</span><span class="x">]</span>
        <span class="n">bnr</span> <span class="o">=</span> <span class="n">Vr</span><span class="x">[</span><span class="mi">6</span><span class="x">,</span> <span class="n">i</span><span class="x">]</span>
        <span class="n">btr</span> <span class="o">=</span> <span class="n">Vr</span><span class="x">[</span><span class="mi">7</span><span class="x">,</span> <span class="n">i</span><span class="x">]</span>
        <span class="n">bur</span> <span class="o">=</span> <span class="n">Vr</span><span class="x">[</span><span class="mi">8</span><span class="x">,</span> <span class="n">i</span><span class="x">]</span>
        <span class="c"># compute B * B of left side</span>
        <span class="n">bl2</span> <span class="o">=</span> <span class="n">dot</span><span class="x">(</span><span class="n">Vl</span><span class="x">[</span><span class="mi">6</span><span class="o">:</span><span class="mi">8</span><span class="x">,</span> <span class="n">i</span><span class="x">],</span> <span class="n">Vl</span><span class="x">[</span><span class="mi">6</span><span class="o">:</span><span class="mi">8</span><span class="x">,</span> <span class="n">i</span><span class="x">])</span>
        <span class="c"># compute v * B of left side</span>
        <span class="n">vlbl</span> <span class="o">=</span> <span class="n">dot</span><span class="x">(</span><span class="n">Vl</span><span class="x">[</span><span class="mi">2</span><span class="o">:</span><span class="mi">4</span><span class="x">,</span> <span class="n">i</span><span class="x">],</span> <span class="n">Vl</span><span class="x">[</span><span class="mi">6</span><span class="o">:</span><span class="mi">8</span><span class="x">,</span> <span class="n">i</span><span class="x">])</span>
        <span class="c"># convert Vl ---&gt; Ul</span>
        <span class="n">Ul</span> <span class="o">=</span> <span class="n">Convert</span><span class="o">.</span><span class="n">v_to_u</span><span class="x">(</span><span class="n">Vl</span><span class="x">[</span><span class="o">:</span><span class="x">,</span> <span class="n">i</span><span class="x">])</span>
        <span class="c"># convert Ul, VL ---&gt; Fl</span>
        <span class="n">Fl</span> <span class="o">=</span> <span class="n">Convert</span><span class="o">.</span><span class="n">uv_to_f</span><span class="x">(</span><span class="n">Ul</span><span class="x">,</span> <span class="n">Vl</span><span class="x">[</span><span class="o">:</span><span class="x">,</span> <span class="n">i</span><span class="x">],</span> <span class="n">bl2</span><span class="x">,</span> <span class="n">vlbl</span><span class="x">)</span>
        <span class="c"># compute B * B of right side</span>
        <span class="n">br2</span> <span class="o">=</span> <span class="n">dot</span><span class="x">(</span><span class="n">Vr</span><span class="x">[</span><span class="mi">6</span><span class="o">:</span><span class="mi">8</span><span class="x">,</span> <span class="n">i</span><span class="x">],</span> <span class="n">Vr</span><span class="x">[</span><span class="mi">6</span><span class="o">:</span><span class="mi">8</span><span class="x">,</span> <span class="n">i</span><span class="x">])</span>
        <span class="c"># compute v * B of right side</span>
        <span class="n">vrbr</span> <span class="o">=</span> <span class="n">dot</span><span class="x">(</span><span class="n">Vr</span><span class="x">[</span><span class="mi">2</span><span class="o">:</span><span class="mi">4</span><span class="x">,</span> <span class="n">i</span><span class="x">],</span> <span class="n">Vr</span><span class="x">[</span><span class="mi">6</span><span class="o">:</span><span class="mi">8</span><span class="x">,</span> <span class="n">i</span><span class="x">])</span>
        <span class="c"># convert Vr ---&gt; Ur</span>
        <span class="n">Ur</span> <span class="o">=</span> <span class="n">Convert</span><span class="o">.</span><span class="n">v_to_u</span><span class="x">(</span><span class="n">Vr</span><span class="x">[</span><span class="o">:</span><span class="x">,</span> <span class="n">i</span><span class="x">])</span>
        <span class="c"># convert Ur, Vr ---&gt; Fr</span>
        <span class="n">Fr</span> <span class="o">=</span> <span class="n">Convert</span><span class="o">.</span><span class="n">uv_to_f</span><span class="x">(</span><span class="n">Ur</span><span class="x">,</span> <span class="n">Vr</span><span class="x">[</span><span class="o">:</span><span class="x">,</span> <span class="n">i</span><span class="x">],</span> <span class="n">br2</span><span class="x">,</span> <span class="n">vrbr</span><span class="x">)</span>
        <span class="c"># compute fast-mode speed of left side</span>
        <span class="n">gmprl</span> <span class="o">=</span> <span class="n">gm</span> <span class="o">*</span> <span class="n">prl</span>
        <span class="n">vfl</span> <span class="o">=</span> <span class="n">sqrt</span><span class="x">(((</span><span class="n">bl2</span><span class="o">+</span><span class="n">gmprl</span><span class="x">)</span><span class="o">+</span><span class="n">sqrt</span><span class="x">((</span><span class="n">bl2</span><span class="o">+</span><span class="n">gmprl</span><span class="x">)</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="mi">4</span><span class="o">*</span><span class="n">gmprl</span><span class="o">*</span><span class="n">bnl</span><span class="o">^</span><span class="mi">2</span><span class="x">))</span><span class="o">/</span><span class="x">(</span><span class="mi">2</span><span class="o">*</span><span class="n">rol</span><span class="x">))</span>
        <span class="c"># compute fast-mode speed of right side</span>
        <span class="n">gmprr</span> <span class="o">=</span> <span class="n">gm</span> <span class="o">*</span> <span class="n">prr</span>
        <span class="n">vfr</span> <span class="o">=</span> <span class="n">sqrt</span><span class="x">(((</span><span class="n">br2</span><span class="o">+</span><span class="n">gmprr</span><span class="x">)</span><span class="o">+</span><span class="n">sqrt</span><span class="x">((</span><span class="n">br2</span><span class="o">+</span><span class="n">gmprr</span><span class="x">)</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="mi">4</span><span class="o">*</span><span class="n">gmprr</span><span class="o">*</span><span class="n">bnr</span><span class="o">^</span><span class="mi">2</span><span class="x">))</span><span class="o">/</span><span class="x">(</span><span class="mi">2</span><span class="o">*</span><span class="n">ror</span><span class="x">))</span>
        <span class="c"># compute sl, sr</span>
        <span class="n">sl</span> <span class="o">=</span> <span class="n">min</span><span class="x">(</span><span class="n">vnl</span><span class="x">,</span> <span class="n">vnr</span><span class="x">)</span> <span class="o">-</span> <span class="n">max</span><span class="x">(</span><span class="n">vfl</span><span class="x">,</span> <span class="n">vfr</span><span class="x">)</span>
        <span class="n">sr</span> <span class="o">=</span> <span class="n">max</span><span class="x">(</span><span class="n">vnl</span><span class="x">,</span> <span class="n">vnr</span><span class="x">)</span> <span class="o">+</span> <span class="n">max</span><span class="x">(</span><span class="n">vfl</span><span class="x">,</span> <span class="n">vfr</span><span class="x">)</span>
        <span class="c"># compute HLL state U*</span>
        <span class="n">Ui</span> <span class="o">=</span> <span class="x">(</span><span class="n">sr</span><span class="o">*</span><span class="n">Ur</span><span class="o">-</span><span class="n">sl</span><span class="o">*</span><span class="n">Ul</span><span class="o">-</span><span class="n">Fr</span><span class="o">+</span><span class="n">Fl</span><span class="x">)</span> <span class="o">/</span> <span class="x">(</span><span class="n">sr</span><span class="o">-</span><span class="n">sl</span><span class="x">)</span>
        <span class="c"># compute sm(=vn), vt, vu, bn, bt, bu of intermediate states</span>
        <span class="n">sm</span> <span class="o">=</span> <span class="n">Ui</span><span class="x">[</span><span class="mi">2</span><span class="x">]</span> <span class="o">/</span> <span class="n">Ui</span><span class="x">[</span><span class="mi">1</span><span class="x">]</span>
        <span class="n">vti</span> <span class="o">=</span> <span class="n">Ui</span><span class="x">[</span><span class="mi">3</span><span class="x">]</span> <span class="o">/</span> <span class="n">Ui</span><span class="x">[</span><span class="mi">1</span><span class="x">]</span>
        <span class="n">vui</span> <span class="o">=</span> <span class="n">Ui</span><span class="x">[</span><span class="mi">4</span><span class="x">]</span> <span class="o">/</span> <span class="n">Ui</span><span class="x">[</span><span class="mi">1</span><span class="x">]</span>
        <span class="n">bni</span> <span class="o">=</span> <span class="n">Ui</span><span class="x">[</span><span class="mi">6</span><span class="x">]</span>
        <span class="n">bti</span> <span class="o">=</span> <span class="n">Ui</span><span class="x">[</span><span class="mi">7</span><span class="x">]</span>
        <span class="n">bui</span> <span class="o">=</span> <span class="n">Ui</span><span class="x">[</span><span class="mi">8</span><span class="x">]</span>
        <span class="c"># compute ro of intermediate states</span>
        <span class="n">slvnl</span> <span class="o">=</span> <span class="n">sl</span> <span class="o">-</span> <span class="n">vnl</span>
        <span class="n">srvnr</span> <span class="o">=</span> <span class="n">sr</span> <span class="o">-</span> <span class="n">vnr</span>
        <span class="n">slsm</span> <span class="o">=</span> <span class="n">sl</span> <span class="o">-</span> <span class="n">sm</span>
        <span class="n">srsm</span> <span class="o">=</span> <span class="n">sr</span> <span class="o">-</span> <span class="n">sm</span>
        <span class="n">roil</span> <span class="o">=</span> <span class="n">rol</span> <span class="o">*</span> <span class="n">slvnl</span> <span class="o">/</span> <span class="n">slsm</span>
        <span class="n">roir</span> <span class="o">=</span> <span class="n">ror</span> <span class="o">*</span> <span class="n">srvnr</span> <span class="o">/</span> <span class="n">srsm</span>
        <span class="c"># compute ptot of left and right sides</span>
        <span class="n">ptotl</span> <span class="o">=</span> <span class="n">prl</span> <span class="o">+</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">bl2</span>
        <span class="n">ptotr</span> <span class="o">=</span> <span class="n">prr</span> <span class="o">+</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">br2</span>
        <span class="c"># compute ptot of intermediate states</span>
        <span class="n">ptoti</span> <span class="o">=</span> <span class="n">ptotl</span> <span class="o">+</span> <span class="n">rol</span> <span class="o">*</span> <span class="n">slvnl</span> <span class="o">*</span> <span class="x">(</span><span class="n">sm</span><span class="o">-</span><span class="n">vnl</span><span class="x">)</span>
        <span class="c"># compute en of left intermediate states</span>
        <span class="n">vibi</span> <span class="o">=</span> <span class="n">dot</span><span class="x">([</span><span class="n">sm</span><span class="x">,</span> <span class="n">vti</span><span class="x">,</span> <span class="n">vui</span><span class="x">],</span> <span class="x">[</span><span class="n">bni</span><span class="x">,</span> <span class="n">bti</span><span class="x">,</span> <span class="n">bui</span><span class="x">])</span>
        <span class="n">enil</span> <span class="o">=</span> <span class="x">(</span><span class="n">slvnl</span><span class="o">*</span><span class="n">Ul</span><span class="x">[</span><span class="mi">5</span><span class="x">]</span><span class="o">-</span><span class="n">ptotl</span><span class="o">*</span><span class="n">vnl</span><span class="o">+</span><span class="n">ptoti</span><span class="o">*</span><span class="n">sm</span><span class="o">+</span><span class="n">bni</span><span class="o">*</span><span class="x">(</span><span class="n">vlbl</span><span class="o">-</span><span class="n">vibi</span><span class="x">))</span> <span class="o">/</span> <span class="n">slsm</span>
        <span class="c"># compute en of right intermediate states</span>
        <span class="n">enir</span> <span class="o">=</span> <span class="x">(</span><span class="n">srvnr</span><span class="o">*</span><span class="n">Ur</span><span class="x">[</span><span class="mi">5</span><span class="x">]</span><span class="o">-</span><span class="n">ptotr</span><span class="o">*</span><span class="n">vnr</span><span class="o">+</span><span class="n">ptoti</span><span class="o">*</span><span class="n">sm</span><span class="o">+</span><span class="n">bni</span><span class="o">*</span><span class="x">(</span><span class="n">vrbr</span><span class="o">-</span><span class="n">vibi</span><span class="x">))</span> <span class="o">/</span> <span class="n">srsm</span>
        <span class="c"># choose flux</span>
        <span class="k">if</span> <span class="n">sl</span> <span class="o">&gt;</span> <span class="mf">0.0</span>
            <span class="k">for</span> <span class="n">m</span> <span class="k">in</span> <span class="mi">1</span><span class="o">:</span><span class="mi">8</span>
                <span class="n">F</span><span class="x">[</span><span class="n">m</span><span class="x">,</span> <span class="n">i</span><span class="x">]</span> <span class="o">=</span> <span class="n">Fl</span><span class="x">[</span><span class="n">m</span><span class="x">]</span>
            <span class="k">end</span>
        <span class="k">elseif</span> <span class="n">sl</span> <span class="o">&lt;=</span> <span class="mf">0.0</span> <span class="o">&lt;</span> <span class="n">sm</span>
            <span class="n">Uil</span> <span class="o">=</span> <span class="x">[</span><span class="n">roil</span><span class="x">,</span> <span class="n">roil</span><span class="o">*</span><span class="n">sm</span><span class="x">,</span> <span class="n">roil</span><span class="o">*</span><span class="n">vti</span><span class="x">,</span> <span class="n">roil</span><span class="o">*</span><span class="n">vui</span><span class="x">,</span> <span class="n">enil</span><span class="x">,</span> <span class="n">bni</span><span class="x">,</span> <span class="n">bti</span><span class="x">,</span> <span class="n">bui</span><span class="x">]</span>
            <span class="k">for</span> <span class="n">m</span> <span class="k">in</span> <span class="mi">1</span><span class="o">:</span><span class="mi">8</span>
                <span class="n">F</span><span class="x">[</span><span class="n">m</span><span class="x">,</span> <span class="n">i</span><span class="x">]</span> <span class="o">=</span> <span class="n">Fl</span><span class="x">[</span><span class="n">m</span><span class="x">]</span> <span class="o">+</span> <span class="n">sl</span> <span class="o">*</span> <span class="x">(</span><span class="n">Uil</span><span class="x">[</span><span class="n">m</span><span class="x">]</span><span class="o">-</span><span class="n">Ul</span><span class="x">[</span><span class="n">m</span><span class="x">])</span>
            <span class="k">end</span>
        <span class="k">elseif</span> <span class="n">sm</span> <span class="o">&lt;=</span> <span class="mf">0.0</span> <span class="o">&lt;</span> <span class="n">sr</span>
            <span class="n">Uir</span> <span class="o">=</span> <span class="x">[</span><span class="n">roir</span><span class="x">,</span> <span class="n">roir</span><span class="o">*</span><span class="n">sm</span><span class="x">,</span> <span class="n">roir</span><span class="o">*</span><span class="n">vti</span><span class="x">,</span> <span class="n">roir</span><span class="o">*</span><span class="n">vui</span><span class="x">,</span> <span class="n">enir</span><span class="x">,</span> <span class="n">bni</span><span class="x">,</span> <span class="n">bti</span><span class="x">,</span> <span class="n">bui</span><span class="x">]</span>
            <span class="k">for</span> <span class="n">m</span> <span class="k">in</span> <span class="mi">1</span><span class="o">:</span><span class="mi">8</span>
                <span class="n">F</span><span class="x">[</span><span class="n">m</span><span class="x">,</span> <span class="n">i</span><span class="x">]</span> <span class="o">=</span> <span class="n">Fr</span><span class="x">[</span><span class="n">m</span><span class="x">]</span> <span class="o">+</span> <span class="n">sr</span> <span class="o">*</span> <span class="x">(</span><span class="n">Uir</span><span class="x">[</span><span class="n">m</span><span class="x">]</span><span class="o">-</span><span class="n">Ur</span><span class="x">[</span><span class="n">m</span><span class="x">])</span>
            <span class="k">end</span>
        <span class="k">elseif</span> <span class="n">sr</span> <span class="o">&lt;=</span> <span class="mf">0.0</span>
            <span class="k">for</span> <span class="n">m</span> <span class="k">in</span> <span class="mi">1</span><span class="o">:</span><span class="mi">8</span>
                <span class="n">F</span><span class="x">[</span><span class="n">m</span><span class="x">,</span> <span class="n">i</span><span class="x">]</span> <span class="o">=</span> <span class="n">Fr</span><span class="x">[</span><span class="n">m</span><span class="x">]</span>
            <span class="k">end</span>                
        <span class="k">end</span>
    <span class="k">end</span>
<span class="k">end</span>
</code></pre></div></div> <p>あらかじめ保存量ベクトル\(\mathbf{U}\)や基本変数ベクトル\(\mathbf{V}\)から流束ベクトル\(\mathbf{F}\)を計算する<code class="language-plaintext highlighter-rouge">convert.jl</code>などを作成しておきます。 また<code class="language-plaintext highlighter-rouge">const.jl</code>には比熱比\(\gamma\)などが定義されています。コード途中に出てくるUl, Vl, Flは左側の物理量における保存量、基本変数、流束ベクトルを表し、 Ur, Vr, Frは右側のものを意味します。</p> <p>続いて<a href="#b_x-neq-0の場合liの方法">HLLC-L</a>流束計算コードのJulia実装例です。</p> <div class="language-julia highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">using</span> <span class="n">LinearAlgebra</span>    
<span class="n">include</span><span class="x">(</span><span class="s">"../convert/convert.jl"</span><span class="x">)</span>
<span class="n">include</span><span class="x">(</span><span class="s">"../const/const.jl"</span><span class="x">)</span>
<span class="k">function</span><span class="nf"> hllcl!</span><span class="x">(</span><span class="n">F</span><span class="o">::</span><span class="kt">Array</span><span class="x">{</span><span class="kt">Float64</span><span class="x">,</span> <span class="mi">2</span><span class="x">},</span> <span class="n">Vl</span><span class="o">::</span><span class="kt">Array</span><span class="x">{</span><span class="kt">Float64</span><span class="x">,</span> <span class="mi">2</span><span class="x">},</span> <span class="n">Vr</span><span class="o">::</span><span class="kt">Array</span><span class="x">{</span><span class="kt">Float64</span><span class="x">,</span> <span class="mi">2</span><span class="x">},</span> <span class="n">nxmax</span><span class="o">::</span><span class="kt">Int64</span><span class="x">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="k">in</span> <span class="mi">1</span><span class="o">:</span><span class="n">nxmax</span><span class="o">-</span><span class="mi">1</span>
        <span class="n">rol</span> <span class="o">=</span> <span class="n">Vl</span><span class="x">[</span><span class="mi">1</span><span class="x">,</span> <span class="n">i</span><span class="x">]</span>
        <span class="n">vnl</span> <span class="o">=</span> <span class="n">Vl</span><span class="x">[</span><span class="mi">2</span><span class="x">,</span> <span class="n">i</span><span class="x">]</span>
        <span class="n">vtl</span> <span class="o">=</span> <span class="n">Vl</span><span class="x">[</span><span class="mi">3</span><span class="x">,</span> <span class="n">i</span><span class="x">]</span>
        <span class="n">vul</span> <span class="o">=</span> <span class="n">Vl</span><span class="x">[</span><span class="mi">4</span><span class="x">,</span> <span class="n">i</span><span class="x">]</span>
        <span class="n">prl</span> <span class="o">=</span> <span class="n">Vl</span><span class="x">[</span><span class="mi">5</span><span class="x">,</span> <span class="n">i</span><span class="x">]</span>
        <span class="n">bnl</span> <span class="o">=</span> <span class="n">Vl</span><span class="x">[</span><span class="mi">6</span><span class="x">,</span> <span class="n">i</span><span class="x">]</span>
        <span class="n">btl</span> <span class="o">=</span> <span class="n">Vl</span><span class="x">[</span><span class="mi">7</span><span class="x">,</span> <span class="n">i</span><span class="x">]</span>
        <span class="n">bul</span> <span class="o">=</span> <span class="n">Vl</span><span class="x">[</span><span class="mi">8</span><span class="x">,</span> <span class="n">i</span><span class="x">]</span>
        <span class="n">ror</span> <span class="o">=</span> <span class="n">Vr</span><span class="x">[</span><span class="mi">1</span><span class="x">,</span> <span class="n">i</span><span class="x">]</span>
        <span class="n">vnr</span> <span class="o">=</span> <span class="n">Vr</span><span class="x">[</span><span class="mi">2</span><span class="x">,</span> <span class="n">i</span><span class="x">]</span>
        <span class="n">vtr</span> <span class="o">=</span> <span class="n">Vr</span><span class="x">[</span><span class="mi">3</span><span class="x">,</span> <span class="n">i</span><span class="x">]</span>
        <span class="n">vur</span> <span class="o">=</span> <span class="n">Vr</span><span class="x">[</span><span class="mi">4</span><span class="x">,</span> <span class="n">i</span><span class="x">]</span>
        <span class="n">prr</span> <span class="o">=</span> <span class="n">Vr</span><span class="x">[</span><span class="mi">5</span><span class="x">,</span> <span class="n">i</span><span class="x">]</span>
        <span class="n">bnr</span> <span class="o">=</span> <span class="n">Vr</span><span class="x">[</span><span class="mi">6</span><span class="x">,</span> <span class="n">i</span><span class="x">]</span>
        <span class="n">btr</span> <span class="o">=</span> <span class="n">Vr</span><span class="x">[</span><span class="mi">7</span><span class="x">,</span> <span class="n">i</span><span class="x">]</span>
        <span class="n">bur</span> <span class="o">=</span> <span class="n">Vr</span><span class="x">[</span><span class="mi">8</span><span class="x">,</span> <span class="n">i</span><span class="x">]</span>
        <span class="c"># compute B * B of left side</span>
        <span class="n">bl2</span> <span class="o">=</span> <span class="n">dot</span><span class="x">(</span><span class="n">Vl</span><span class="x">[</span><span class="mi">6</span><span class="o">:</span><span class="mi">8</span><span class="x">,</span> <span class="n">i</span><span class="x">],</span> <span class="n">Vl</span><span class="x">[</span><span class="mi">6</span><span class="o">:</span><span class="mi">8</span><span class="x">,</span> <span class="n">i</span><span class="x">])</span>
        <span class="c"># compute v * B of left side</span>
        <span class="n">vlbl</span> <span class="o">=</span> <span class="n">dot</span><span class="x">(</span><span class="n">Vl</span><span class="x">[</span><span class="mi">2</span><span class="o">:</span><span class="mi">4</span><span class="x">,</span> <span class="n">i</span><span class="x">],</span> <span class="n">Vl</span><span class="x">[</span><span class="mi">6</span><span class="o">:</span><span class="mi">8</span><span class="x">,</span> <span class="n">i</span><span class="x">])</span>
        <span class="c"># convert Vl ---&gt; Ul</span>
        <span class="n">Ul</span> <span class="o">=</span> <span class="n">Convert</span><span class="o">.</span><span class="n">v_to_u</span><span class="x">(</span><span class="n">Vl</span><span class="x">[</span><span class="o">:</span><span class="x">,</span> <span class="n">i</span><span class="x">])</span>
        <span class="c"># convert Ul, VL ---&gt; Fl</span>
        <span class="n">Fl</span> <span class="o">=</span> <span class="n">Convert</span><span class="o">.</span><span class="n">uv_to_f</span><span class="x">(</span><span class="n">Ul</span><span class="x">,</span> <span class="n">Vl</span><span class="x">[</span><span class="o">:</span><span class="x">,</span> <span class="n">i</span><span class="x">],</span> <span class="n">bl2</span><span class="x">,</span> <span class="n">vlbl</span><span class="x">)</span>
        <span class="c"># compute B * B of right side</span>
        <span class="n">br2</span> <span class="o">=</span> <span class="n">dot</span><span class="x">(</span><span class="n">Vr</span><span class="x">[</span><span class="mi">6</span><span class="o">:</span><span class="mi">8</span><span class="x">,</span> <span class="n">i</span><span class="x">],</span> <span class="n">Vr</span><span class="x">[</span><span class="mi">6</span><span class="o">:</span><span class="mi">8</span><span class="x">,</span> <span class="n">i</span><span class="x">])</span>
        <span class="c"># compute v * B of right side</span>
        <span class="n">vrbr</span> <span class="o">=</span> <span class="n">dot</span><span class="x">(</span><span class="n">Vr</span><span class="x">[</span><span class="mi">2</span><span class="o">:</span><span class="mi">4</span><span class="x">,</span> <span class="n">i</span><span class="x">],</span> <span class="n">Vr</span><span class="x">[</span><span class="mi">6</span><span class="o">:</span><span class="mi">8</span><span class="x">,</span> <span class="n">i</span><span class="x">])</span>
        <span class="c"># convert Vr ---&gt; Ur</span>
        <span class="n">Ur</span> <span class="o">=</span> <span class="n">Convert</span><span class="o">.</span><span class="n">v_to_u</span><span class="x">(</span><span class="n">Vr</span><span class="x">[</span><span class="o">:</span><span class="x">,</span> <span class="n">i</span><span class="x">])</span>
        <span class="c"># convert Ur, Vr ---&gt; Fr</span>
        <span class="n">Fr</span> <span class="o">=</span> <span class="n">Convert</span><span class="o">.</span><span class="n">uv_to_f</span><span class="x">(</span><span class="n">Ur</span><span class="x">,</span> <span class="n">Vr</span><span class="x">[</span><span class="o">:</span><span class="x">,</span> <span class="n">i</span><span class="x">],</span> <span class="n">br2</span><span class="x">,</span> <span class="n">vrbr</span><span class="x">)</span>
        <span class="c"># compute fast-mode speed of left side</span>
        <span class="n">gmprl</span> <span class="o">=</span> <span class="n">gm</span> <span class="o">*</span> <span class="n">prl</span>
        <span class="n">vfl</span> <span class="o">=</span> <span class="n">sqrt</span><span class="x">(((</span><span class="n">bl2</span><span class="o">+</span><span class="n">gmprl</span><span class="x">)</span><span class="o">+</span><span class="n">sqrt</span><span class="x">((</span><span class="n">bl2</span><span class="o">+</span><span class="n">gmprl</span><span class="x">)</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="mi">4</span><span class="o">*</span><span class="n">gmprl</span><span class="o">*</span><span class="n">bnl</span><span class="o">^</span><span class="mi">2</span><span class="x">))</span><span class="o">/</span><span class="x">(</span><span class="mi">2</span><span class="o">*</span><span class="n">rol</span><span class="x">))</span>
        <span class="c"># compute fast-mode speed of right side</span>
        <span class="n">gmprr</span> <span class="o">=</span> <span class="n">gm</span> <span class="o">*</span> <span class="n">prr</span>
        <span class="n">vfr</span> <span class="o">=</span> <span class="n">sqrt</span><span class="x">(((</span><span class="n">br2</span><span class="o">+</span><span class="n">gmprr</span><span class="x">)</span><span class="o">+</span><span class="n">sqrt</span><span class="x">((</span><span class="n">br2</span><span class="o">+</span><span class="n">gmprr</span><span class="x">)</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="mi">4</span><span class="o">*</span><span class="n">gmprr</span><span class="o">*</span><span class="n">bnr</span><span class="o">^</span><span class="mi">2</span><span class="x">))</span><span class="o">/</span><span class="x">(</span><span class="mi">2</span><span class="o">*</span><span class="n">ror</span><span class="x">))</span>
        <span class="c"># compute sl, sr</span>
        <span class="n">sl</span> <span class="o">=</span> <span class="n">min</span><span class="x">(</span><span class="n">vnl</span><span class="x">,</span> <span class="n">vnr</span><span class="x">)</span> <span class="o">-</span> <span class="n">max</span><span class="x">(</span><span class="n">vfl</span><span class="x">,</span> <span class="n">vfr</span><span class="x">)</span>
        <span class="n">sr</span> <span class="o">=</span> <span class="n">max</span><span class="x">(</span><span class="n">vnl</span><span class="x">,</span> <span class="n">vnr</span><span class="x">)</span> <span class="o">+</span> <span class="n">max</span><span class="x">(</span><span class="n">vfl</span><span class="x">,</span> <span class="n">vfr</span><span class="x">)</span>
        <span class="c"># compute HLL state U*</span>
        <span class="n">Ui</span> <span class="o">=</span> <span class="x">(</span><span class="n">sr</span><span class="o">*</span><span class="n">Ur</span><span class="o">-</span><span class="n">sl</span><span class="o">*</span><span class="n">Ul</span><span class="o">-</span><span class="n">Fr</span><span class="o">+</span><span class="n">Fl</span><span class="x">)</span> <span class="o">/</span> <span class="x">(</span><span class="n">sr</span><span class="o">-</span><span class="n">sl</span><span class="x">)</span>
        <span class="c"># compute sm(=vn), bn, bt, bu of intermediate states</span>
        <span class="n">sm</span> <span class="o">=</span> <span class="n">Ui</span><span class="x">[</span><span class="mi">2</span><span class="x">]</span> <span class="o">/</span> <span class="n">Ui</span><span class="x">[</span><span class="mi">1</span><span class="x">]</span>
        <span class="n">bni</span> <span class="o">=</span> <span class="n">Ui</span><span class="x">[</span><span class="mi">6</span><span class="x">]</span>
        <span class="n">bti</span> <span class="o">=</span> <span class="n">Ui</span><span class="x">[</span><span class="mi">7</span><span class="x">]</span>
        <span class="n">bui</span> <span class="o">=</span> <span class="n">Ui</span><span class="x">[</span><span class="mi">8</span><span class="x">]</span>
        <span class="c"># compute ro of intermediate states</span>
        <span class="n">slvnl</span> <span class="o">=</span> <span class="n">sl</span> <span class="o">-</span> <span class="n">vnl</span>
        <span class="n">srvnr</span> <span class="o">=</span> <span class="n">sr</span> <span class="o">-</span> <span class="n">vnr</span>
        <span class="n">slsm</span> <span class="o">=</span> <span class="n">sl</span> <span class="o">-</span> <span class="n">sm</span>
        <span class="n">srsm</span> <span class="o">=</span> <span class="n">sr</span> <span class="o">-</span> <span class="n">sm</span>
        <span class="n">roil</span> <span class="o">=</span> <span class="n">rol</span> <span class="o">*</span> <span class="n">slvnl</span> <span class="o">/</span> <span class="n">slsm</span>
        <span class="n">roir</span> <span class="o">=</span> <span class="n">ror</span> <span class="o">*</span> <span class="n">srvnr</span> <span class="o">/</span> <span class="n">srsm</span>
        <span class="c"># compute vt, vu of intermediate states</span>
        <span class="n">vtil</span> <span class="o">=</span> <span class="n">vtl</span> <span class="o">+</span> <span class="n">bni</span> <span class="o">*</span> <span class="x">(</span><span class="n">btl</span><span class="o">-</span><span class="n">bti</span><span class="x">)</span> <span class="o">/</span> <span class="x">(</span><span class="n">rol</span><span class="o">*</span><span class="n">slvnl</span><span class="x">)</span>
        <span class="n">vtir</span> <span class="o">=</span> <span class="n">vtr</span> <span class="o">+</span> <span class="n">bni</span> <span class="o">*</span> <span class="x">(</span><span class="n">btr</span><span class="o">-</span><span class="n">bti</span><span class="x">)</span> <span class="o">/</span> <span class="x">(</span><span class="n">ror</span><span class="o">*</span><span class="n">srvnr</span><span class="x">)</span>
        <span class="n">vuil</span> <span class="o">=</span> <span class="n">vul</span> <span class="o">+</span> <span class="n">bni</span> <span class="o">*</span> <span class="x">(</span><span class="n">bul</span><span class="o">-</span><span class="n">bui</span><span class="x">)</span> <span class="o">/</span> <span class="x">(</span><span class="n">rol</span><span class="o">*</span><span class="n">slvnl</span><span class="x">)</span>
        <span class="n">vuir</span> <span class="o">=</span> <span class="n">vur</span> <span class="o">+</span> <span class="n">bni</span> <span class="o">*</span> <span class="x">(</span><span class="n">bur</span><span class="o">-</span><span class="n">bui</span><span class="x">)</span> <span class="o">/</span> <span class="x">(</span><span class="n">ror</span><span class="o">*</span><span class="n">srvnr</span><span class="x">)</span>
        <span class="c"># compute ptot of left and right sides</span>
        <span class="n">ptotl</span> <span class="o">=</span> <span class="n">prl</span> <span class="o">+</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">bl2</span>
        <span class="n">ptotr</span> <span class="o">=</span> <span class="n">prr</span> <span class="o">+</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">br2</span>
        <span class="c"># compute ptot of intermediate states</span>
        <span class="n">ptoti</span> <span class="o">=</span> <span class="n">ptotl</span> <span class="o">+</span> <span class="n">rol</span> <span class="o">*</span> <span class="n">slvnl</span> <span class="o">*</span> <span class="x">(</span><span class="n">sm</span><span class="o">-</span><span class="n">vnl</span><span class="x">)</span>
        <span class="c"># compute en of left intermediate states</span>
        <span class="n">vilbil</span> <span class="o">=</span> <span class="n">dot</span><span class="x">([</span><span class="n">sm</span><span class="x">,</span> <span class="n">vtil</span><span class="x">,</span> <span class="n">vuil</span><span class="x">],</span> <span class="x">[</span><span class="n">bni</span><span class="x">,</span> <span class="n">bti</span><span class="x">,</span> <span class="n">bui</span><span class="x">])</span>
        <span class="n">enil</span> <span class="o">=</span> <span class="x">(</span><span class="n">slvnl</span><span class="o">*</span><span class="n">Ul</span><span class="x">[</span><span class="mi">5</span><span class="x">]</span><span class="o">-</span><span class="n">ptotl</span><span class="o">*</span><span class="n">vnl</span><span class="o">+</span><span class="n">ptoti</span><span class="o">*</span><span class="n">sm</span><span class="o">+</span><span class="n">bni</span><span class="o">*</span><span class="x">(</span><span class="n">vlbl</span><span class="o">-</span><span class="n">vilbil</span><span class="x">))</span> <span class="o">/</span> <span class="n">slsm</span>
        <span class="c"># compute en of right intermediate states</span>
        <span class="n">virbir</span> <span class="o">=</span> <span class="n">dot</span><span class="x">([</span><span class="n">sm</span><span class="x">,</span> <span class="n">vtir</span><span class="x">,</span> <span class="n">vuir</span><span class="x">],</span> <span class="x">[</span><span class="n">bni</span><span class="x">,</span> <span class="n">bti</span><span class="x">,</span> <span class="n">bui</span><span class="x">])</span>
        <span class="n">enir</span> <span class="o">=</span> <span class="x">(</span><span class="n">srvnr</span><span class="o">*</span><span class="n">Ur</span><span class="x">[</span><span class="mi">5</span><span class="x">]</span><span class="o">-</span><span class="n">ptotr</span><span class="o">*</span><span class="n">vnr</span><span class="o">+</span><span class="n">ptoti</span><span class="o">*</span><span class="n">sm</span><span class="o">+</span><span class="n">bni</span><span class="o">*</span><span class="x">(</span><span class="n">vrbr</span><span class="o">-</span><span class="n">virbir</span><span class="x">))</span> <span class="o">/</span> <span class="n">srsm</span>
        <span class="c"># choose flux</span>
        <span class="k">if</span> <span class="n">sl</span> <span class="o">&gt;</span> <span class="mf">0.0</span>
            <span class="k">for</span> <span class="n">m</span> <span class="k">in</span> <span class="mi">1</span><span class="o">:</span><span class="mi">8</span>
                <span class="n">F</span><span class="x">[</span><span class="n">m</span><span class="x">,</span> <span class="n">i</span><span class="x">]</span> <span class="o">=</span> <span class="n">Fl</span><span class="x">[</span><span class="n">m</span><span class="x">]</span>
            <span class="k">end</span>
        <span class="k">elseif</span> <span class="n">sl</span> <span class="o">&lt;=</span> <span class="mf">0.0</span> <span class="o">&lt;</span> <span class="n">sm</span>
            <span class="n">Uil</span> <span class="o">=</span> <span class="x">[</span><span class="n">roil</span><span class="x">,</span> <span class="n">roil</span><span class="o">*</span><span class="n">sm</span><span class="x">,</span> <span class="n">roil</span><span class="o">*</span><span class="n">vtil</span><span class="x">,</span> <span class="n">roil</span><span class="o">*</span><span class="n">vuil</span><span class="x">,</span> <span class="n">enil</span><span class="x">,</span> <span class="n">bni</span><span class="x">,</span> <span class="n">bti</span><span class="x">,</span> <span class="n">bui</span><span class="x">]</span>
            <span class="k">for</span> <span class="n">m</span> <span class="k">in</span> <span class="mi">1</span><span class="o">:</span><span class="mi">8</span>
                <span class="n">F</span><span class="x">[</span><span class="n">m</span><span class="x">,</span> <span class="n">i</span><span class="x">]</span> <span class="o">=</span> <span class="n">Fl</span><span class="x">[</span><span class="n">m</span><span class="x">]</span> <span class="o">+</span> <span class="n">sl</span> <span class="o">*</span> <span class="x">(</span><span class="n">Uil</span><span class="x">[</span><span class="n">m</span><span class="x">]</span><span class="o">-</span><span class="n">Ul</span><span class="x">[</span><span class="n">m</span><span class="x">])</span>
            <span class="k">end</span>
        <span class="k">elseif</span> <span class="n">sm</span> <span class="o">&lt;=</span> <span class="mf">0.0</span> <span class="o">&lt;</span> <span class="n">sr</span>
            <span class="n">Uir</span> <span class="o">=</span> <span class="x">[</span><span class="n">roir</span><span class="x">,</span> <span class="n">roir</span><span class="o">*</span><span class="n">sm</span><span class="x">,</span> <span class="n">roir</span><span class="o">*</span><span class="n">vtir</span><span class="x">,</span> <span class="n">roir</span><span class="o">*</span><span class="n">vuir</span><span class="x">,</span> <span class="n">enir</span><span class="x">,</span> <span class="n">bni</span><span class="x">,</span> <span class="n">bti</span><span class="x">,</span> <span class="n">bui</span><span class="x">]</span>
            <span class="k">for</span> <span class="n">m</span> <span class="k">in</span> <span class="mi">1</span><span class="o">:</span><span class="mi">8</span>
                <span class="n">F</span><span class="x">[</span><span class="n">m</span><span class="x">,</span> <span class="n">i</span><span class="x">]</span> <span class="o">=</span> <span class="n">Fr</span><span class="x">[</span><span class="n">m</span><span class="x">]</span> <span class="o">+</span> <span class="n">sr</span> <span class="o">*</span> <span class="x">(</span><span class="n">Uir</span><span class="x">[</span><span class="n">m</span><span class="x">]</span><span class="o">-</span><span class="n">Ur</span><span class="x">[</span><span class="n">m</span><span class="x">])</span>
            <span class="k">end</span>
        <span class="k">elseif</span> <span class="n">sr</span> <span class="o">&lt;=</span> <span class="mf">0.0</span>
            <span class="k">for</span> <span class="n">m</span> <span class="k">in</span> <span class="mi">1</span><span class="o">:</span><span class="mi">8</span>
                <span class="n">F</span><span class="x">[</span><span class="n">m</span><span class="x">,</span> <span class="n">i</span><span class="x">]</span> <span class="o">=</span> <span class="n">Fr</span><span class="x">[</span><span class="n">m</span><span class="x">]</span>
            <span class="k">end</span>                
        <span class="k">end</span>
    <span class="k">end</span>
<span class="k">end</span>
</code></pre></div></div> <p>以下に<a href="/simulation/hll">HLL</a>, <a href="#b_x-neq-0の場合gurskiの手法">HLLC-G</a>, <a href="#b_x-neq-0の場合liの方法">HLLC-L</a>の3手法で、実際に磁気流体衝撃波管問題を解いて得られたガス密度分布を比較した図を示します。</p> <p><img src="/assets/images/simulation/hllc_03.png" alt="" /></p> <p>わかりにくいため、下に\(0.5 \leq x \leq 0.75\)の領域部分を拡大してプロットしたものを示します。</p> <p><img src="/assets/images/simulation/hllc_04.png" alt="" /></p> <p>今回試した磁気流体衝撃波管問題では、<a href="#b_x-neq-0の場合liの方法">HLLC-L</a>が一番構造をシャープに捉えられていることがわかります。</p> <h1 id="参考文献"> <a href="#参考文献" class="anchor-heading" aria-labelledby="参考文献"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 参考文献 </h1> <ul> <li>[1] <a href="https://www.sciencedirect.com/science/article/pii/S0021999105001142?via%3Dihub">Miyoshi &amp; Kusano, 2005, “A multi-state HLL approximate Riemann solver for ideal magnetohydrodynamics”</a></li> <li>[2] <a href="https://epubs.siam.org/doi/10.1137/S1064827502407962">Gurski, 2004, “An HLLC-type Approximate Riemann Solver for Ideal Magnetohydrodynamics”</a></li> <li>[3] <a href="https://www.sciencedirect.com/science/article/pii/S0021999104003857?via%3Dihub">Li, 2005, “An HLLC Riemann solver for magnetohydrodynamics”</a></li> <li>[4] <a href="https://arxiv.org/abs/astro-ph/9404074">Ryu &amp; Jones, 1994, “Numerical Magnetohydrodynamics in Astrophysics: Algorithm and Tests for One-Dimensional Flow”</a></li> <li>[5] <a href="https://iopscience.iop.org/article/10.1086/588755">Stone et al., 2008, “Athena: A New Code for Astrophysical MHD”</a></li> <li>[6] <a href="https://qiita.com/ur_kinsk/items/1893602e2ee73060b207">Qiita記事, 磁気流体の数値計算で遊ぶ</a></li> </ul> <script async="" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-9131160172347693" crossorigin="anonymous"></script> <!-- for_jekyll --> <p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-9131160172347693" data-ad-slot="3528582902" data-ad-format="auto" data-full-width-responsive="true"></ins> <script> (adsbygoogle = window.adsbygoogle || []).push({}); </script></p> <hr> <footer> <p class="text-small text-grey-dk-100 mb-0">Copyright &copy; Sho NAKAMURA</p> <div class="d-flex mt-2"> </div> </footer> </div> </div> <div class="search-overlay"></div> </div> </body> </html>
