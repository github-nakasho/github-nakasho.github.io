I"
<details open="">
  <summary class="text-delta">
    Table of contents
  </summary>
<ol id="markdown-toc">
  <li><a href="#多数の局所解があるような連続ポテンシャルでの量子古典アニーリング" id="markdown-toc-多数の局所解があるような連続ポテンシャルでの量子古典アニーリング">多数の局所解があるような連続ポテンシャルでの量子・古典アニーリング</a>    <ol>
      <li><a href="#概要" id="markdown-toc-概要">概要</a></li>
      <li><a href="#i-研究背景-連続最適化における量子アニーリング" id="markdown-toc-i-研究背景-連続最適化における量子アニーリング">I. 研究背景: 連続最適化における量子アニーリング</a></li>
      <li><a href="#ii-問題設定" id="markdown-toc-ii-問題設定">II. 問題設定</a>        <ol>
          <li><a href="#a-連続最適化に用いるポテンシャル" id="markdown-toc-a-連続最適化に用いるポテンシャル">A. 連続最適化に用いるポテンシャル</a></li>
          <li><a href="#b-局所解の数" id="markdown-toc-b-局所解の数">B. 局所解の数</a></li>
        </ol>
      </li>
      <li><a href="#iii-量子力学的な基底状態と古典的な熱平衡状態の比較" id="markdown-toc-iii-量子力学的な基底状態と古典的な熱平衡状態の比較">III. 量子力学的な基底状態と古典的な熱平衡状態の比較</a>        <ol>
          <li><a href="#a-エネルギーによる比較" id="markdown-toc-a-エネルギーによる比較">A. エネルギーによる比較</a></li>
          <li><a href="#b-エネルギーギャップから言えること" id="markdown-toc-b-エネルギーギャップから言えること">B. エネルギーギャップから言えること</a></li>
        </ol>
      </li>
      <li><a href="#iv-線形のスケジューリングによる量子アニーリング" id="markdown-toc-iv-線形のスケジューリングによる量子アニーリング">IV. 線形のスケジューリングによる量子アニーリング</a>        <ol>
          <li><a href="#a-線形スケジュール" id="markdown-toc-a-線形スケジュール">A. 線形スケジュール</a></li>
          <li><a href="#b-アニーリングの段階" id="markdown-toc-b-アニーリングの段階">B. アニーリングの段階</a></li>
          <li><a href="#c-残差エネルギー" id="markdown-toc-c-残差エネルギー">C. 残差エネルギー</a></li>
          <li><a href="#d-波動関数時間発展と断熱への到達" id="markdown-toc-d-波動関数時間発展と断熱への到達">D. 波動関数時間発展と断熱への到達</a></li>
        </ol>
      </li>
      <li><a href="#v-非線形なスケジューリングでの量子アニーリング" id="markdown-toc-v-非線形なスケジューリングでの量子アニーリング">V. 非線形なスケジューリングでの量子アニーリング</a>        <ol>
          <li><a href="#a-非線形アニーリングスケジュール" id="markdown-toc-a-非線形アニーリングスケジュール">A. 非線形アニーリングスケジュール</a></li>
          <li><a href="#b-残差エネルギー-非線形スケジュールでの高速な減衰" id="markdown-toc-b-残差エネルギー-非線形スケジュールでの高速な減衰">B. 残差エネルギー: 非線形スケジュールでの高速な減衰</a></li>
          <li><a href="#c-量子アニーリング中に起こる持続的なトンネリング流" id="markdown-toc-c-量子アニーリング中に起こる持続的なトンネリング流">C. 量子アニーリング中に起こる持続的なトンネリング流</a></li>
        </ol>
      </li>
      <li><a href="#vi-線形スケジュールでのシミュレーテッドアニーリング" id="markdown-toc-vi-線形スケジュールでのシミュレーテッドアニーリング">VI. 線形スケジュールでのシミュレーテッド・アニーリング</a>        <ol>
          <li><a href="#a-シミュレーテッドアニーリング" id="markdown-toc-a-シミュレーテッドアニーリング">A. シミュレーテッド・アニーリング</a></li>
          <li><a href="#b-線形スケジュールとシミュレーテッドアニーリングの段階" id="markdown-toc-b-線形スケジュールとシミュレーテッドアニーリングの段階">B. 線形スケジュールとシミュレーテッド・アニーリングの段階</a></li>
          <li><a href="#c-残差エネルギー-1" id="markdown-toc-c-残差エネルギー-1">C. 残差エネルギー</a></li>
        </ol>
      </li>
      <li><a href="#vii-対数スケジュールでのシミュレーテッドアニーリング" id="markdown-toc-vii-対数スケジュールでのシミュレーテッドアニーリング">VII. 対数スケジュールでのシミュレーテッド・アニーリング</a>        <ol>
          <li><a href="#a-対数スケジュール" id="markdown-toc-a-対数スケジュール">A. 対数スケジュール</a></li>
        </ol>
      </li>
    </ol>
  </li>
</ol>

</details>

<script async="" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-9131160172347693" crossorigin="anonymous"></script>

<!-- for_jekyll -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-9131160172347693" data-ad-slot="3528582902" data-ad-format="auto" data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script></p>

<h1 id="多数の局所解があるような連続ポテンシャルでの量子古典アニーリング">多数の局所解があるような連続ポテンシャルでの量子・古典アニーリング</h1>

<h2 id="概要">概要</h2>

<p>こちらは<a href="https://arxiv.org/abs/2203.11417">Koh &amp; Nishimori, 2022, “Quantum and classical annealing in a continuous space with multiple local minima”</a>を読み、理解を深めるためのメモです。</p>

<h2 id="i-研究背景-連続最適化における量子アニーリング">I. 研究背景: 連続最適化における量子アニーリング</h2>

<p>量子アニーリング(以下QA)はバイナリ変数$x={ 0, 1 }$(もしくはスピン変数$\sigma={-1, 1}$)で表現される離散最適化問題を解くために用いられる、量子力学に基づいたメタヒューリスティックです。最近の先行研究、例えば<a href="https://journals.aps.org/prxquantum/abstract/10.1103/PRXQuantum.2.010349">Abel &amp; Spannowsky, 2021, “Quantum-Field-Theoretic Simulation Platform for Observing the Fate of the False Vacuum”</a>ではdomain-wall encodingと呼ばれる手法を応用し、近似的に(しかし正確に)QFTでの連続自由度をイジングスピンで表現しています。</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>他にもdomain-wall encodingの有用性に関しては、QAであれば例えば[Chen et al., 2021, “Performance of Domain-Wall Encoding for Quantum Annealing”](https://ieeexplore.ieee.org/document/9485068),   
そして量子回路のQAOAであれば例えば[Chancellor, 2019, “Domain wall encoding of discrete variables for quantum annealing and QAOA”](https://iopscience.iop.org/article/10.1088/2058-9565/ab33c2)などで示されています。
</code></pre></div></div>

<p>先程と同じ著者らの研究である<a href="https://arxiv.org/abs/2105.13945">Abel et al., 2021, “Quantum Optimization of Complex Systems with a Quantum Annealer”</a>では、複数の鋭い局所解が存在する複雑なエネルギーランドスケープの場合にこれを拡張し、D-WaveでのQAが、シミュレーテッド・アニーリング(以下SA)を含む古典アルゴリズムよりも優れた性能を達成することを示しました。</p>

<p>上図のように、\((\psi, \phi) = \mathbf{0}\)にある大域最適解の周囲に局所解が配置されているようなポテンシャルを用意します。これにおいて、古典(Nelder-Mead, 勾配降下, SA)とQAを比較したものが下図です(画像はどちらもAbel et al., 2021)。</p>

<p>図の左3つのパネルは古典での結果、一番右のパネルがQAの結果です。QAでは中心に位置する大域最適解に高い確率で到達できていることがわかります。ここからもわかるように、このQAの力を連続最適化にも応用できれば、数多くの社会問題を解決に導くことができると考えられます。</p>

<p>実はKoh &amp; Nishimori, 2022の研究に最も大きく関わりのある論文が存在します。それは<a href="https://journals.aps.org/prb/abstract/10.1103/PhysRevB.72.014303">Stella et al., 2005, “Optimization by quantum annealing: Lesson from simple cases”</a>という論文です。この論文ではシミュレーテッド・量子アニーリング(以下SQA)と古典SAとの性能を、様々な連続ポテンシャルで比較したというものです。Stella et al., 2005の結論としては、「量子を用いたアプローチは古典よりも速く大域最適解に収束する」というものです。調和振動子型のポテンシャルと2重井戸型ポテンシャルでその有効性が数値・解析的に求められています。しかし<a href="https://iopscience.iop.org/article/10.1088/0305-4470/24/3/008/meta">Shinomoto &amp; Kabashima, 1991, “Finite time scalling of energy in simulated annealing”</a>で導入された多数の局所解を持つポテンシャルに対しての古典的な解析においては、Stella et al., 2005は現象論的に粗視化されたモデルが採用されています。これは離散的な局所解の位置のみを考慮し、解析を容易にするために局所解間の距離を無視した連続極限を取るというものです。この解析手法には当然ながら近似が含まれており、その正当性は古典的な場合の長時間・低温極限では必ずしも明らかではありません。この考察はもちろん量子にも言えることであり、近似の適用範囲には慎重な吟味が必要となります。またこのような近似を用いると、量子力学による局所解から大域最適解(最小エネルギー)への確率の流れの理解を直感的に行うことが難しくなる、という難点も生まれます。</p>

<p>このような背景から、多くの局所解を持つShinomoto-Kabashima的な連続ポテンシャルでの最適化問題を古典SAおよびQAでの直接計算を行い、この系での収束性などの研究を行なったという論文です。</p>

<h2 id="ii-問題設定">II. 問題設定</h2>

<h3 id="a-連続最適化に用いるポテンシャル">A. 連続最適化に用いるポテンシャル</h3>

<p>古典手法とQAを用いた最適化には、以下のShinomoto-Kabashimaポテンシャルを用います。</p>

\[V_\mathrm{SK}(x) = \frac{1}{2} kx^2 + \frac{h_0}{2} \left\{ 1-\cos \left( \frac{2\pi x}{w_0}\right) \right\} \tag{1}\]

<p>第一項の調和振動子的なポテンシャルがポテンシャルの概形を表しています。そこに\(h_0, w_0\)をパラメータとして、局所解を表現するcos項を導入しています。\(h_0\)は局所解どうしのエネルギーバリアの高さ、そして\(w_0\)は局所解どうしの距離を表すパラメータです。下図は\(k=1, h_0=w_0=0.2\)の場合の\(V_\mathrm{SK}\)を示しています。</p>

<p>(1)式のポテンシャルは第1項のために、\(x\)が大きい部分では局所解の影響が小さくなります。よって局所解の総数は有限と考えて差し支えありません(重要なのは大域最適解\(x=0\)付近での挙動であり、長時間のアニーリングでは\(\vert x \vert \gg 1\)の部分の状態存在確率は限りなく小さいため、このような取り扱いをします)。このポテンシャルは数値計算実装が容易でありながらも、本質的に他のポテンシャルでの漸近的な振る舞いを表すことができます。</p>

<h3 id="b-局所解の数">B. 局所解の数</h3>

<p>ここで局所解の数\(N_\mathrm{min}\)について触れておきましょう。上図の\(h_0 = w_0 = 0.2\)の場合には、\(N_\mathrm{min} = 15\)となります。この\(N_\mathrm{min}\)の数が大きいほど最適化が難しくなるため、下図のように\(N_\mathrm{min}\)の相図から\(V_\mathrm{SK}(x)\)での最適化の難しさを予想することができます。</p>

<p>\(N_\mathrm{min} = (一定)\)の領域においては、\(h_0, w_0\)のどちらか(あるいは両方)が大きいほど最適化が難しいと言う特徴を持ちます。この位相空間全体で数値計算を行うことは現実的ではないので、今回は代表として\((h_0, w_0) = (0.2, 0.2)\)の場合に数値計算を行います(簡単すぎず、また計算時間が恐ろしくかかるような難しさではない、ちょうど良く本質を理解できるインスタンスを選んでいます)。</p>

<h2 id="iii-量子力学的な基底状態と古典的な熱平衡状態の比較">III. 量子力学的な基底状態と古典的な熱平衡状態の比較</h2>

<h3 id="a-エネルギーによる比較">A. エネルギーによる比較</h3>

<p>アニーリングに入る前に、時間に依存しないシュレディンガー方程式から言えることを考察してみましょう。この系のハミルトニアンは</p>

\[H = \frac{p^2}{2m} + V_\mathrm{SK} (x) \tag{2}\]

<p>のように記述されます。ここで\(p, m\)はそれぞれ粒子の運動量と質量です。\(p\)は、量子力学では\(\frac{\hbar} {i} \frac{\partial}{\partial x}\)のような運動量演算子、そして\(x\)は位置演算子となります。</p>

<p>古典の場合、この系は分配関数を用いた統計力学の枠組みで理解することができます。この系の分配関数は</p>

\[Z(\beta) = \frac{1}{h} \int_{-\infty}^\infty dp \int_{-\infty}^\infty dx e^{-\beta H}\]

<p>のようになります。ここで\(\beta=1/T\)は逆温度(\(k_B = 1\))、係数の\(1/h\)は不確定性関係から1つの状態が占める体積を表します。運動量の部分\(e^{- \beta p^2 / 2m}\)はガウス積分を実行できて</p>

\[Z(\beta) = C \int_{-\infty}^\infty e^{-\beta V_\mathrm{SK}(x)} dx \quad (C: 定数)\]

<p>を得ます。ここから位置\(x\)で状態を見出す確率を表す、ボルツマン分布は</p>

\[\varrho (x) = \frac{e^{-\beta V_\mathrm{SK}(x)}}{Z(\beta)} \tag{3}\]

<p>のようになります。今注目したいのは(内部)エネルギーについてなので、これを計算しましょう。このポテンシャルにおけるエネルギーは</p>

\[U(\beta) = \frac{1}{2\beta} + \langle V_\mathrm{SK} (x)\rangle_\beta \tag{4}\]

<p>のようになります。第1項は運動エネルギー\(p^2 / 2m \simeq k_B T \simeq 1/\beta\)による寄与、そして第2項はポテンシャルによる平均エネルギーで</p>

\[\langle V_\mathrm{SK} (x) \rangle_\beta = \int_{-\infty}^\infty V_\mathrm{SK}(x) \varrho (x) dx \tag{5}\]

<p>と表されます。\(\langle \cdots \rangle_\beta\)はボルツマン分布(3)式を通して\(\beta\)に依存することを表現しています。量子的な枠組みと異なり、古典的なエネルギーはそのアニーリングにおいて\(\beta\)依存性が存在します。</p>

<p>次の図はあるエネルギーにおける量子と古典での存在確率の比較です。</p>

<table>
  <tbody>
    <tr>
      <td>(a)は量子力学において、基底エネルギー\(E_0 \sim 0.6\) (青線)のときの、ある位置における存在確率密度$$</td>
      <td>\langle x</td>
      <td>E_0 \rangle</td>
      <td>^2\(を赤線で描画したものです。存在確率は局所解に局在化していないことがわかります。(b)は\)U\sim 0.6\(でのボルツマン分布\)\varrho(x)\(を緑線で示しています。振動のようなものが見えますが、大局的には量子と同じ概形をしています。このことから\)V_\mathrm{SK}(x)$$のポテンシャルにおいて、高エネルギーになれば量子と古典は等価なものになると言えるでしょう。</td>
    </tr>
  </tbody>
</table>

<p>しかし\(E_0 \sim 0.1, U\sim 0.1\)では、量子と古典では振る舞いが大きく異なります。</p>

<p>量子では大域最適解\(x=0\)に集まっているのに対し、古典はそれ以外の局所解にも存在確率が分離しています。さらに低エネルギーの0.01ではボルツマン分布には2つのspurious(擬似的？)な凖安定モードがより顕著に現れます。これら2つのモードが凖安定(長寿命)な理由としては、\(x=0\)に存在する主モードに移動する確率チャンネルが完全に0となり、取り残されてしまうためです。</p>

<p>これらから、量子の方が古典よりも最適化により向いていると見ることができます。古典力学的な描像としては、粒子の全エネルぎーがポテンシャルエネルギーより小さな領域ではペナルティを受けます。このためペナルティをなるべく避けるために局所解にとどまるような平衡状態の分布が形成されると言えるでしょう。しかし量子力学的な描像では、古典では禁止されている領域にトンネル効果を通して到達することができるため、最適解付近に収束することができると言えます。</p>

<p>次に、質量\(m\)と温度(逆温度\(\beta\))に対する量子と古典のエネルギーの変化について見てみましょう。</p>

<p>上図のパネル(a)は質量\(m\)に対する量子的な基底状態エネルギー固有値\(E_0\)のグラフを赤線で示しています。同時にInner oscillator(\(k=99.696\))とouter oscillator(\(k=1\))における零点振動エネルギー\(\frac{1}{2} \sqrt{k/m}\)も青線で表示しています。\(V_\mathrm{SK} (x)\)においてポテンシャルの概形を成している\(\frac{1}{2} k x^2\)による調和振動をouter、そして\(x=0\)の大域最適解近傍のポテンシャルを2次関数で近似したときの調和振動をinnerと記述しています。すると小質量極限ではouter, 大質量極限ではinnerで良く記述されることがわかります。小質量極限と大質量極限の中間にあたる遷移領域が量子系の重要な領域を示しています。</p>

<p>パネル(b)は逆温度\(\beta\)に対する古典的なエネルギー依存性を緑線で示したものです。このグラフでは等分配の定理から導かれる、バネ定数に依存しない内部エネルギーも青線で示しています。量子と同じく、\(\beta\)の無限小・無限大極限では調和振動子によく一致していることがわかります。一方で、\(V_\mathrm{SK}(x)\)の非自明な部分が、黄色で色付けされた超過エネルギーとして表現されています。この超過エネルギーが現れる部分が古典系での重要な領域です。</p>

<h3 id="b-エネルギーギャップから言えること">B. エネルギーギャップから言えること</h3>

<p>もう一つの大きな指標として、量子力学における系の第一励起状態とのエネルギーギャップ\(\Delta = E_1 - E_0\)があります。QAにおいて、エネルギーギャップの高速な0への収束は一次相転移を表しており、これは長いアニーリング時間を必要とします。</p>

<p>上図は\(V_\mathrm{SK}(x)\)における\(\Delta\)を\(m\)の関数として表したものです。ここでもinnerとouter oscillatorの2つの青線間での遷移が起こっていることがわかります。エネルギーギャップは2つの振動子の間で特に狭まるような挙動を示していません。そのため、QAではこの系は多項式時間で解けることが示唆されます。そのため、これは計算量の観点からは決して難しい問題とは言えませんが、この問題設定でQAと古典の比較を行います。またここでは、第一励起状態が多重縮退を伴う、\(\frac{\partial \Delta}{\partial m}\)がほぼ0となる遷移区間について言及しています。これは”flat gap”と呼ばれています。これは\(h_0 = w_0 = 0.2\)のみに限った特徴ではなく、\(h_0 - w_0\)相図上で普遍的に存在する特徴です。</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>“Flat gap”に関する詳細な議論は論文のAppendix Aでされていますが、ここでは割愛します。
</code></pre></div></div>

<h2 id="iv-線形のスケジューリングによる量子アニーリング">IV. 線形のスケジューリングによる量子アニーリング</h2>

<h3 id="a-線形スケジュール">A. 線形スケジュール</h3>

<p>ここではまず線形のQAスケジュールを用いた場合のダイナミクスを解析していきましょう。\(V_\mathrm{SK}(x)\)のポテンシャル中でのQAは、以下の時間に依存したSchrödinger方程式を解くことで行われます。</p>

\[\left( i\hbar \frac{\partial}{\partial t} + \frac{\hbar^2}{2m(t)} \frac{\partial^2}{\partial x^2} - V_\mathrm{SK} (x) \right) \psi (x, t) = 0 \tag{6}\]

<p>ここで\(\psi(x, t)\)は波動関数、そして時間に依存した粒子質量\(m(t)\)はアニーリングスケジュールを表します。本来なら、質量が0(すなわち運動エネルギーによる項が支配的である状態)からアニーリングを始め、質量を徐々に無限大に大きくしていくことで\(V_\mathrm{SK}(x)\)が支配的な状態に移していきます。\(m(t)\)が無限大まで大きくなる速度が十分に遅ければ、断熱定理から、初期に基底状態の波動関数を用意することで\(V_\mathrm{SK}(x)\)の基底状態を得ることができます。</p>

<p>ここで総アニーリング時間を$T$として、\(0 \leq t \leq T\)での時間発展を行います。以下のように、質量\(m(t)\)が時間の1次関数で与えられるとしましょう。</p>

\[m^{(1)} (t) = (m_f - m_i) \frac{t}{T} + m_i \tag{7}\]

<p>ここで\(m_i, m_f\)はそれぞれ\(t=0, t=T\)での粒子質量です。\(m_i\)と\(m_f\)を固定したとき、\(T\)はアニーリング速度を表す変数となります。当然、大きな\(T\)はゆっくりアニーリングを行うことに対応します。実は<a href="https://journals.jps.jp/doi/10.1143/JPSJ.76.104001">Morita, 2007, “Faster Annealing Schedules for Quantum Annealing”</a>で示されているように、十分大きなアニーリング時間では、アニーリング開始時と終了時におけるアニーリングスケジュールの導関数によって終状態での励起状態確率が決まります。このことからアニーリングスケジュールの陽的な形、つまり(7)式での質量変化や運動エネルギーの係数\(\Gamma(t) \equiv \hbar /2m\)の変化は特に重要ではありません。(7)式のような線形スケジューリングでは、開始・終了時の両方で有限の微分の値となります。</p>

<h3 id="b-アニーリングの段階">B. アニーリングの段階</h3>

<p>原理的には、(7)式において任意の小ささの\(m_i\)と任意の大きさの\(m_f\)を用いることができます。例えばFig. 3(a)のように非常に高いエネルギーからスタートし、Fig. 4(c)のように非常に低いエネルギーに向かってアニーリングを進めることもできます。しかし、そのように大きなエネルギー差を課してしまうと、波動関数を表現するために必要なグリッド数が巨大になり、計算時間が現実的ではなくなってしまいます。それと同時にグリッド数は終状態を十分な解像度で計算するほど十分な量が必要です。この論文では2048グリッド点を用いてQAのシミュレーションを行い、\(m_i, m_f\)はこのグリッド数でも十分計算が可能な範囲で選んでいます。</p>

<p>上表はFig. 5で縦線として描かれている粒子質量の値です。\(m_a\)と\(m_d\)の値が6桁も異なっていることがわかります。この大きな質量差を扱うために、各段階でアニーリングを実行します。表にある通り、\(m_a-m_b\)をステージ1, \(m_b-m_c\)をステージ2, \(m_c-m_d\)をステージ3と定義します。ステージ1はouter期, ステージ2はouterからinnerへの遷移期, そしてステージ3はinner期、のように考えられるとIII章の議論からわかります。ステージ1では、FIg. 3(a)とFig. 4(a)の青線で示されているように、エネルギーがとても高い状態から、\(V_\mathrm{SK}(x)\)の局所解どうしのバリア障壁の半分の高さあたりまでエネルギーを減少させています。ステージ2ではさらに大域最適解の横にある一番低いエネルギーの局所解2つと同程度までエネルギーを減少させています。最後にステージ3でエネルギーを大域最適解でのポテンシャルエネルギーまで下げていきます。</p>

<h3 id="c-残差エネルギー">C. 残差エネルギー</h3>

<p>アニーリングスケジュール(7)式に\(m_i, m_f\)を挿入します。さらに(7)式を(6)式に代入することで、QAをシミュレーションします。各時刻でのSchrödinger方程式を<a href="https://sourceforge.net/projects/wavepacket/">WavePacketライブラリ</a>を用いて解きます。時間積分はRunge-Kuttaで、\(dt=0.1\)で解いています。\(m_i\)における基底状態波動関数にはアニーリング開始時の初期波動関数を用います。</p>

<p>アニーリングの性能を評価するために、以下で定義される残差エネルギーを用います。</p>

\[R_\mathrm{q. a.} (T) 
= \langle \psi (T) |H(T) |\psi(T) \rangle - E_0 (m_f) \tag{8}\]

<p>第1項は\(t=T\)でのハミルトニアン期待値、そして第2項は\(m_f\)での基底状態エネルギーでアニーリングが到達しようとする目標エネルギーです。\(T \rightarrow \infty\)の場合、系は断熱的に時間発展し、この残差エネルギーは0となります。(8)式の\(R_\mathrm{q. a.}(T)\)が$T$に対してどれくらい速く0に収束するかを示すことで、アニーリングが目標エネルギーにどれだけ速く到達するかの指標となります。</p>

<p>次の図は(7)式の線形スケジュールでの\(R_\mathrm{q.a.}(T)\)を\(T\)の関数として図示したものです。</p>

<p>黒線は\(T^{-2}\)を表しています。\(T\)が大きな極限では、すべてのステージが\(T^{-2}\)に漸近していることが見て取れます。論文には描かれていませんが、他の\(h_0-w_0\)での同様に\(T^{-2}\)に漸近する様子が示されており、相図上で一般的に成り立つ性質と言えます。この減衰率は<a href="https://journals.jps.jp/doi/10.1143/JPSJ.76.104001">Morita, 2007, “Faster Annealing Schedules for Quantum Annealing”</a>や<a href="https://journals.jps.jp/doi/10.1143/JPSJ.74.1649">Suzuki &amp; Okada, 2005, “Residual Energies after Slow Quantum Annealing”</a>などでも示されています。</p>

<p>上図を眺めてみると、ステージ2だけ違う振る舞いをしていることがわかります。\(T\)が小さいところでは\(T^{-2}\)よりも下回るような振る舞いをしたのち、\(T^{-2}\)に漸近しています。このような振る舞いは2準位系において初期の非断熱的な遷移と、ランダウ・ツェナー理論によって説明されます。この遷移段階では励起状態への遷移も確率的に起こっています。</p>

<p>次の図はFig. 7で\(T=3250\)の矢印で示されている部分での最終的な波動関数です。</p>

<p>Fig. 4の(c)と比べると、spuriousな2つのピークが\(\pm 0.2\)に存在する局所解部分に存在していることがわかります。さらに、Fig. 6での”flat gap”領域における第一励起状態は、2つの局所最適解のうちの1つを中心とするガウシアンが2重縮退しているとわかりました。このことからFig. 8のアニーリングされた波動関数のspuriousなピークは、”flat gap”区間でのアニーリング時に発生した、第一励起状態への非断熱遷移によるものと考えるのが妥当でしょう。</p>

<p>もしアニーリング時間が十分長くないと、波動関数の一部は局所解にトラップされるというのがQAでの面白い点です。通常、このような振る舞いは古典SAでよく見られるものです。古典でのこのような現象はよく理解されていますが、QAでのこのような局所解へのトラップをランダウ・ツェナー遷移を用いて理解しようと試みられています。しかし先述の通り、この\(V_\mathrm{SK}(x)\)では”flat gap”が存在します。このギャップではランダウ・ツェナー理論の基本的な考え方の一つである回避交差(avoided crossing)が存在しないことを意味しており、この理論での解決には大きな問題として立ちはだかります。よって、今回観測された局所解へのトラッピングの基礎となるのは非断熱遷移の可能性がありますが、その詳細な物理過程はランダウ・ツェナーとは異なる可能性があります。</p>

<h3 id="d-波動関数時間発展と断熱への到達">D. 波動関数時間発展と断熱への到達</h3>

<p>ここではアニーリング中の波動関数の時間発展について言及していきます。次の図の(a)は\(T=560, t=44\)でのステージ1の確率密度分布です。</p>

<table>
  <tbody>
    <tr>
      <td>時間的な挙動をより簡潔に表現するために、その確率密度の幅$$\langle \psi (t)</td>
      <td>x^2</td>
      <td>\psi (t) \rangle\(が描かれています。そして次の図は横軸にアニーリング時間\)t/T\(、縦軸に先程の確率密度の幅\)\langle \psi (t)</td>
      <td>x^2</td>
      <td>\psi (t) \rangle$$のグラフをプロットしたものです。</td>
    </tr>
  </tbody>
</table>

<p>異なる\(T\)の3つの曲線が描かれていますが、どの\(T\)でも振動しながら幅が減衰していく様子が見て取れます。また\(T\)を大きくすると振動が抑えられてより減衰が滑らかになります。</p>

<p>ここでもう一つ、この波動関数の振る舞いを詳細に調べるために、以下の確率密度流を計算しています。</p>

\[j(x, t) 
= \frac{\hbar}{2m(t) i} \left(\psi^\ast \frac{\partial \psi}{\partial x} - \psi \frac{\partial \psi^\ast}{\partial x} \right) \tag{9}\]

<p>この確率密度流は\((x, t)\)において、確率がどちらの方向にどれくらい流れていくかを表す量です。Fig. 9(b)では、\(x&gt;0\)では正の方向に確率が流れ、\(x&lt;0\)では負の方向に確率が流れていることを表しています。つまり、この状況では、\(x=0\)の大域最適解から周囲に向かって確率密度が流れていっていることがわかります。これは最適化という文脈からすると、好ましくない振る舞いです。</p>

<table>
  <tbody>
    <tr>
      <td>ここで確率密度の幅と同じような指標として、\(x&lt;0\)において$$</td>
      <td>j(x, t)</td>
      <td>\(が最大となるような位置を\)x_0\(、そしてこのときの\)j(x_0, t)$$を振幅としてみることにしましょう。振幅という言葉を使っていますが、実際にはこれは確率密度流の向きも表す量なので、負の値も取ることができます。</td>
    </tr>
  </tbody>
</table>

<table>
  <tbody>
    <tr>
      <td>Fig. 10(b)は横軸にアニーリング時間\(t/T\)、縦軸に\(j(x_0, t)\)をプロットしたものです。これを見ると確率密度流が正負に振動し、\(x=0\)に向かって流れたり\(x=0\)から離れるように流れていく様子がわかります。これは確率密度の幅$$\langle \psi(t)</td>
      <td>x^2</td>
      <td>\psi(t) \rangle\(が振動している様子と整合性が取れています。さらに\)T\(が大きくなるほど素早く0に減衰している様子もわかります。\)j(x, t) \sim 0\(は確率密度の流入がない定常状態であることを意味しており、これはこのアニーリング過程が断熱的であることを示しています。FIg. 7で\)T = 560 \ (\log_{10} T \sim 2.75)\(におけるステージ1の挙動(赤マーカー)は\)T^{-2}\(に漸近していますが、FIg. 10(b)の緑線を見ると\)t/T = 1$$でも振動をしており、これは非断熱進化であるということがわかります。</td>
    </tr>
  </tbody>
</table>

<h2 id="v-非線形なスケジューリングでの量子アニーリング">V. 非線形なスケジューリングでの量子アニーリング</h2>

<h3 id="a-非線形アニーリングスケジュール">A. 非線形アニーリングスケジュール</h3>

<p>ここまでは線形なアニーリングスケジュールでの理解でしたが、実は非線形なスケジュールにすると残差エネルギーがより高速に収束することがMorita, 2007で報告されています。非線形なスケジューリングは以下のような一般形で書かれます。</p>

\[m^{(n)}(t) = (m_f - m_i) f_n(t/T) + m_i \tag{10}\]

<p>ここで\(n\)はスケジューリングが\(t/T\)の\(n\)次関数になっていることを表すものです。この非線形関数はどのようなものでも良い、と言うわけではありません。物理的なことを言うと、アニーリングの開始と終了はゆっくり変化させるものが、好ましいようです。Morita, 2007の先行研究から、残差エネルギーは\(T^{-2n}\)で推移することが知られていますが、ここではMorita, 2007と同じ以下のような関数形について研究を行います。</p>

\[f_1(s) = s, \quad f_2(s) = s^2(3-2s), \\f_3(s) = s^3 (10-15s+6s^2),
f_4 (s) = s^4(35-84s + 70s^2 - 20s^3) \tag{11, 12}\]

<h3 id="b-残差エネルギー-非線形スケジュールでの高速な減衰">B. 残差エネルギー: 非線形スケジュールでの高速な減衰</h3>

<p>下図は(10)式で\(n=1-3\)まで、すなわち\(f_1, f_2, f_3\)を用いた結果を、各ステージごとに図示したものです。</p>

<p>先述の通り、\(T^{-2n}\)で残差エネルギーが減衰していく様子がわかります。また上図の\(m^{(q)}(t)\)はStella et al., 2005と同じく\(f_n = (t/T)^2\)のアニーリングスケジュールで行った場合の結果です。これはアニーリング開始時はゆっくりですが、アニーリング終了時では高速なアニーリング時間発展を課すことを表しています。すると先程の\(T^{-4}\)ではなく\(T^{-2}\)に漸近した結果を得ていることがわかります。これら線形と2次式によるアニーリングスケジュールが同じ漸近的な振る舞いとなる理論的背景は、Morita, 2007に記載されています。</p>

<p>ここでもステージ2の残差エネルギーの収束は他のステージ1, 3とは少し異なっていますが、基本的にはIV-Cで説明されたものと同じです。確かに\(m^{(2)}, m^{(3)}\)は\(m^{(1)}\)よりも速く減衰しています。しかしこの図には掲載されていませんが、実は\(m^{(4)}\)も\(m^{(3)}\)とほぼ同じようなグラフとなるのです。よって、\(n=2, 3\)で見られた非線形スケジューリングによるアニーリングパフォーマンスの改善がより高次でも起こると一般化することには慎重になる必要があります。しかし、数値計算された\(T\)に関しては、非断熱遷移が\(T^{-2}\)よりも素早い収束を起こすことが確かめられました。興味深いことに、ここでは先程のStella et al., 2005のアニーリングスケジュール\(f_n = (t/T)^2\)が一番速く収束しています。これはステージ1, 3では見られない傾向です。(ステージ2だけは明確ではありませんが)全体として非線形スケジューリングは線形に比べて、一般的に改善をもたらすことが示されました。</p>

<h3 id="c-量子アニーリング中に起こる持続的なトンネリング流">C. 量子アニーリング中に起こる持続的なトンネリング流</h3>

<p>続いて、FIg. 9 (b)と同様の定義で確率密度流の最大振幅\(j(x_0, t)\)を考え、様々な非線形スケジュールの場合の確率流密度について考察しましょう。</p>

<p>上図はステージ1での\(j(x_0, t)\)を、\(T=560\)の場合に様々なスケジューリングに対して比較したものです。\(m^{(2)-(4)}, m^{(q)}\)の非線形スケジュールは常に正の値を取っていることがわかります。このことから、非線形スケジュールでは常に\(x&gt;0\)から正の方向、すなわち\(x=0\)の大域最適解に向かって確率密度が流れていることを表しています。この非断熱過程は大域最適解発見を目指す最適化としては、非常に有効であると考えられます。それに対して、灰色線で示された\(m^{(1)}\)(線形スケジュール)は常に正負に振動しており、これは最適解を目指すアニーリングとしては非効率的です。</p>

<table>
  <tbody>
    <tr>
      <td>次の図に示すのは波動関数の幅$$\sqrt{\langle \psi(t)</td>
      <td>x^2</td>
      <td>\psi (t) \rangle}\(の時間発展です。ここではステージ1で\)T=560\(とした場合に、\)m^{(3)}(t)$$の非線形スケジュールでの結果を示しています。</td>
    </tr>
  </tbody>
</table>

<table>
  <tbody>
    <tr>
      <td>緑色で示された領域は、全エネルギー$$\langle \psi(t)</td>
      <td>H(t)</td>
      <td>\psi(t) \rangle\(がポテンシャルエネルギー\)V_\mathrm{SK}(x)$$を下回るような、古典では禁止された領域です。赤線と緑領域が重なっている部分では確率密度流が古典的には禁止された領域であり、これは量子力学のトンネル効果のような性質を持っています。従って、非線形スケジュールによって駆動されるポテンシャル障壁をまたいだトンネル効果による持続的な確率密度流が、アニーリング効率を劇的に改善することがわかります。この結果は、より断熱アニーリング過程によりもたらされる確率密度流の抑制が起こる線形スケジュールとは対照的です。</td>
    </tr>
  </tbody>
</table>

<p>ステージ2ではより複雑な波動関数の概形になりますが、ステージ1と同様の考察を当てはめることができます。</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ステージ2については、この論文のAppendix Bで詳細にその物理過程が記述されていますが、ここでは割愛します。
</code></pre></div></div>

<p>またステージ3はステージ1とよく似た形になります。しかし、このステージになると、もはや確率密度流のトンネリングは顕著には発生せず、波動関数は大域最適解にすでによく局在化された形となります。</p>

<h2 id="vi-線形スケジュールでのシミュレーテッドアニーリング">VI. 線形スケジュールでのシミュレーテッド・アニーリング</h2>

<h3 id="a-シミュレーテッドアニーリング">A. シミュレーテッド・アニーリング</h3>

<p>時刻$t$における粒子の位置を\(x_t\)と書きます。すると次の時刻での粒子の新しい位置は</p>

\[x' = x_t + \Delta x \tag{13}\]

<p>のように提案されます。ここで\(\Delta x\)は、幅\(s\)の区間\([-s/2, s/2]\)からランダムに選ばれます。この\(s\)はモンテカルロステップサイズと呼ばれ、各ステップでの動きでどれくらいまでのジャンプを許すかを表します。提案された位置\(x'\)は</p>

\[P_\mathrm{accept} = \min \{ 1, e^{-\beta (t) (V_\mathrm{SK}(x') - V_\mathrm{SK}(x))} \} \tag{14}\]

<p>により許容されます。逆温度\(\beta(t)\)はアニーリングスケジュールによって与えられます。\(x_t\)を更新したのち、時刻\(t\)を時間ステップ\(dt\)だけ進め、これを繰り返します。これをメトロポリスアルゴリズムと呼びます。</p>

<p>平均を計算するために、独立にメトロポリスアルゴリズムで時間発展させた\(N\)個の粒子を用意し、それのアンサンブル平均を取ります。</p>

\[\langle V_\mathrm{SK} (x) \rangle_t = \lim_{N \rightarrow \infty} \frac{1}{N}\sum_{\nu=1}^N V_\mathrm{SK} (x_t^\nu) \tag{15}\]

<p>\(\langle V_\mathrm{SK} (x) \rangle_t\)は時刻\(t\)におけるアンサンブル平均値、\(x_t^\nu\)は\(\nu\)番目の粒子の時刻\(t\)での位置を表します。実際には\(N\)には\(10^7\)や\(10^9\)などの有限の大きな値が用いられます。よって実際にはアンサンブル平均は近侍であり、有限サイズのゆらぎによる誤差が生じます。</p>

<h3 id="b-線形スケジュールとシミュレーテッドアニーリングの段階">B. 線形スケジュールとシミュレーテッド・アニーリングの段階</h3>

<p>線形スケジュールとして、以下のようなものを考えます。</p>

\[\beta^{(1)} (t) = (\beta_f - \beta_i) \frac{t}{T} + \beta_i \tag{16}\]

<p>\(\beta_i, \beta_f\)はそれぞれ\(t=0, T\)での逆温度です。この\(\beta^{(1)}(t)\)は、QAでの\(m^{(1)}(t)\)に相当します。</p>

<p>QAの結果とSA計算を公正に比較するために、エネルギーを閾値として用います。具体的には(16)式の\(\beta_i, \beta_f\)を、先述のQAで対応するステージの初期・最終エネルギー\(U(\beta_i), U(\beta_f)\)が同じになるように選択します。これらの値は先程のTable Iにまとめられています。そしてQAと同様に、\(\beta_a-\beta_b\)をステージA, \(\beta_b - \beta_c\)をステージB, \(\beta_c - \beta_d\)をステージCとします。Fig. 5(b)には各ステージの境界となる\(U(\beta)\)を重ねていますが、こうしてみると全てのステージが重要な領域に重なっています。</p>

<h3 id="c-残差エネルギー-1">C. 残差エネルギー</h3>

<p>そしてQAのときと同様に以下の残差エネルギーを考えます。</p>

\[R_\mathrm{s. a.} (T) 
= \langle V_\mathrm{SK}(x) \rangle_{t=T} - \langle V_\mathrm{SK} (x)\rangle_{\beta_f} \tag{17}\]

<p>第1項は\(t=T\)、すなわちアニーリング終了時でのポテンシャルエネルギーの平均値です。そして第2項は(5)式で与えられる、最終温度\(\beta_f\)の平衡状態でのポテンシャルエネルギーの平均値を表します。</p>

<p>次の図は線形スケジュールを用いたときの、ステージAでの\(R_\mathrm{s. a.}(T)\)の振る舞いを示したものです。</p>

<p>3種類のモンテカルロステップサイズ\(s\)で実験したところ、ここでは\(s=1.0\)が最適とわかります。そしてこれら残差エネルギーは\(T^{-1}\)のスケーリングを持つことがわかります。ステージAではかなりの\(s\)の範囲にわたって\(T^{-1}\)のスケーリングが安定して得られていますが、ステージB, Cでは\(\frac{s}{2} &lt; w_0\)になると\(T^{-1}\)のスケーリングが得られなくなります。</p>

<p>この図では\(s=0.1\)でのステージB, ステージCのスケーリングがマゼンダ色で描かれています。これはモンテカルロステップ幅が小さいために局所解にトラップされ、大域最適解に到達するためにポテンシャル障壁を登り切るのに大きな時間がかかるためです。上図で示されているような(おそらく)対数でスケールするような振る舞いはShinomoto &amp; Kabashima, 1991でも示されています。見方を変えれば、\(\frac{s}{2} &gt; w_0\)であれば局所解に囚われることなくエネルギー障壁を飛び越えて凖大局的な探索が行えるようになり、より高速な多項式で残差エネルギーが減少すると思われるかもしれません。しかし注目すべき点として、古典SAで準大局的な探索をしても、得られるのは\(T^{-1}\)までということが挙げられます。</p>

<p>あるいはこのスケーリングはアニーリングアルゴリズムによるもので、この問題のためにアニーリングに調整を施したり、スケジューリングを変えればもっと良い結果が得られると思われるかもしれません。しかし、(16)式のスケジューリングを\(t/T\)の2次関数のものに変形したり、温度とともにステップサイズを適応的に減少させるような変形アルゴリズムを試しましたが、それでもこの論文では\(T^{-1}\)以上に高速化されることはありませんでした。</p>

<h2 id="vii-対数スケジュールでのシミュレーテッドアニーリング">VII. 対数スケジュールでのシミュレーテッド・アニーリング</h2>

<h3 id="a-対数スケジュール">A. 対数スケジュール</h3>

<p>Shinomoto &amp; Kabashima, 1991で示された結果を再考するために、同じスケジュールを用いたアニーリングを行います。逆温度を</p>

\[\beta^{(l)}(t) = \beta_i \log_{10}(t+10) \tag{18}\]

<p>のようにします。これまでは有限時間のアニーリングを考えてきましたが、時間\(t\)は\(0\rightarrow \infty\)まで考えることができます。もし粒子が局所解にのみ局在化すると仮定し、位置の離散化が無視できるような連続極限を考えると、(18)式のアニーリングスケジュールでは</p>

\[\langle V_\mathrm{SK} (x) \rangle_t \simeq (\log_{10} t)^{-1} \tag{19}\]

<p>のように減少する振る舞いをすることが、Shinomoto &amp; Kabashima, 1991で示されています。\(\langle V_\mathrm{SK} (x) \rangle_t\)は(5)式と同じ定義ですが、ここでは(18)式のように\(\beta\)が\(t\)に依存していることから、\(\langle \cdots \rangle_t\)のような添字を用いています。</p>

<script async="" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-9131160172347693" crossorigin="anonymous"></script>

<!-- for_jekyll -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-9131160172347693" data-ad-slot="3528582902" data-ad-format="auto" data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script></p>
:ET